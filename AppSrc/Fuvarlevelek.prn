Compiling Program: C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\Fuvarlevelek.src
Memory Available: 2147483647
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\dfallent.pkd)
73224>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\cCJStandardCommandBarSystem.pkg)
73224>>>// these are all the packages used in a standard MDI menubar/toolbar system
73224>>>
73224>>>Use cCJCommandBarSystem.pkg
73224>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\cCJStandardMenuItemClasses.pkg)
73224>>>>>Use Dfpanel.pkg
73224>>>>>Use cCJCommandBarSystem.pkg
73224>>>>>Use LanguageText.pkg
73224>>>>>
73224>>>>>
73224>>>>>Class cCJUndoMenuItem is a cCJMenuItem
73225>>>>>    
73225>>>>>    Procedure Construct_Object
73227>>>>>        Forward Send Construct_Object
73229>>>>>        Set psCaption   to C_$CaptionUndo
73230>>>>>        Set psToolTip to C_$ToolTipUndo
73231>>>>>        Set psDescription to C_$DescUndo
73232>>>>>        Set psImage to "ActionUndo.ico"
73233>>>>>        Set pbActiveUpdate to True
73234>>>>>        Set psCategory to C_$CategoryEdit
73235>>>>>        Set psShortcut to C_$Key_Ctrl_Z
73236>>>>>    End_Procedure
73237>>>>>
73237>>>>>    Procedure OnExecute Variant vCommandBarControl
73239>>>>>        Send Undo of (focus(Self))
73240>>>>>    End_Procedure
73241>>>>>    
73241>>>>>    Function IsEnabled Returns Boolean
73243>>>>>        Boolean bEnabled
73243>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
73244>>>>>        Function_Return bEnabled
73245>>>>>    End_Function
73246>>>>>         
73246>>>>>End_Class
73247>>>>>
73247>>>>>
73247>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
73248>>>>>    
73248>>>>>    Procedure Construct_Object
73250>>>>>        Forward Send Construct_Object
73252>>>>>        Set psCaption   to C_$CaptionDelete
73253>>>>>        Set psToolTip to C_$ToolTipDelete
73254>>>>>        Set psDescription to C_$DescDelete
73255>>>>>        Set psImage to "actionDelete.ico"
73256>>>>>        Set psShortcut to C_$Key_Delete
73257>>>>>        Set pbActiveUpdate to True
73258>>>>>        Set psCategory to C_$CategoryEdit
73259>>>>>    End_Procedure
73260>>>>>
73260>>>>>
73260>>>>>    Procedure OnExecute Variant vCommandBarControl
73262>>>>>        Send Delete of (focus(Self))
73263>>>>>    End_Procedure
73264>>>>>    
73264>>>>>    Function IsEnabled Returns Boolean
73266>>>>>        Boolean bEnabled
73266>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
73267>>>>>        Function_Return bEnabled
73268>>>>>    End_Function
73269>>>>>         
73269>>>>>End_Class
73270>>>>>
73270>>>>>
73270>>>>>Class cCJCutMenuItem is a cCJMenuItem
73271>>>>>    
73271>>>>>    Procedure Construct_Object
73273>>>>>        Forward Send Construct_Object
73275>>>>>        Set psCaption   to C_$CaptionCut
73276>>>>>        Set psToolTip to C_$TooltipCut
73277>>>>>        Set psDescription to C_$DescCut
73278>>>>>        Set psImage to "actionCut.ico"
73279>>>>>        Set psShortcut to C_$Key_Ctrl_X
73280>>>>>        Set pbActiveUpdate to True
73281>>>>>        Set psCategory to C_$CategoryEdit
73282>>>>>    End_Procedure
73283>>>>>
73283>>>>>
73283>>>>>    Procedure OnExecute Variant vCommandBarControl
73285>>>>>        Send Cut of (focus(Self))
73286>>>>>    End_Procedure
73287>>>>>    
73287>>>>>    Function IsEnabled Returns Boolean
73289>>>>>        Boolean bEnabled
73289>>>>>        Get CanCut of (Focus(Self)) to bEnabled
73290>>>>>        Function_Return bEnabled
73291>>>>>    End_Function
73292>>>>>         
73292>>>>>End_Class
73293>>>>>
73293>>>>>
73293>>>>>Class cCJCopyMenuItem is a cCJMenuItem
73294>>>>>    
73294>>>>>    Procedure Construct_Object
73296>>>>>        Forward Send Construct_Object
73298>>>>>        Set psCaption   to C_$CaptionCopy
73299>>>>>        Set psToolTip to C_$ToolTipCopy
73300>>>>>        Set psDescription to C_$DescCopy
73301>>>>>        Set psImage to "actionCopy.ico"
73302>>>>>        Set psShortcut to C_$Key_Ctrl_C
73303>>>>>        Set pbActiveUpdate to True
73304>>>>>        Set psCategory to C_$CategoryEdit
73305>>>>>    End_Procedure
73306>>>>>
73306>>>>>
73306>>>>>    Procedure OnExecute Variant vCommandBarControl
73308>>>>>        Send Copy of (focus(Self))
73309>>>>>    End_Procedure
73310>>>>>    
73310>>>>>    Function IsEnabled Returns Boolean
73312>>>>>        Boolean bEnabled
73312>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
73313>>>>>        Function_Return bEnabled
73314>>>>>    End_Function
73315>>>>>         
73315>>>>>End_Class
73316>>>>>
73316>>>>>
73316>>>>>Class cCJPasteMenuItem is a cCJMenuItem
73317>>>>>    
73317>>>>>    Procedure Construct_Object
73319>>>>>        Forward Send Construct_Object
73321>>>>>        Set psCaption   to C_$CaptionPaste
73322>>>>>        Set psToolTip to C_$ToolTipPaste
73323>>>>>        Set psDescription to C_$DescPaste
73324>>>>>        Set psImage to "actionPaste.ico"
73325>>>>>        Set pbActiveUpdate to True
73326>>>>>        Set psShortcut to C_$Key_Ctrl_V
73327>>>>>        Set psCategory to C_$CategoryEdit
73328>>>>>    End_Procedure
73329>>>>>
73329>>>>>
73329>>>>>    Procedure OnExecute Variant vCommandBarControl
73331>>>>>        Send Paste of (focus(Self))
73332>>>>>    End_Procedure
73333>>>>>    
73333>>>>>    Function IsEnabled Returns Boolean
73335>>>>>        Boolean bEnabled
73335>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
73336>>>>>        Function_Return bEnabled
73337>>>>>    End_Function
73338>>>>>         
73338>>>>>End_Class
73339>>>>>
73339>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
73340>>>>>    
73340>>>>>    Procedure Construct_Object
73342>>>>>        Forward Send Construct_Object
73344>>>>>        Set psCaption   to C_$CaptionSelectAll
73345>>>>>        Set psToolTip to C_$ToolTipSelectAll
73346>>>>>        Set psDescription to C_$DescSelectAll
73347>>>>>        Set pbActiveUpdate to True
73348>>>>>        Set psShortcut to C_$Key_Ctrl_A
73349>>>>>        Set psCategory to C_$CategoryEdit
73350>>>>>    End_Procedure
73351>>>>>
73351>>>>>
73351>>>>>    Procedure OnExecute Variant vCommandBarControl
73353>>>>>        Send Select_All of (focus(Self))
73354>>>>>    End_Procedure
73355>>>>>    
73355>>>>>    Function IsEnabled Returns Boolean
73357>>>>>        Boolean bEnabled
73357>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
73358>>>>>        Function_Return bEnabled
73359>>>>>    End_Function
73360>>>>>         
73360>>>>>End_Class
73361>>>>>
73361>>>>> 
73361>>>>>Class cCJExitMenuItem is a cCJMenuItem
73362>>>>>
73362>>>>>    Procedure Construct_Object
73364>>>>>        Forward Send Construct_Object
73366>>>>>        Set psCaption to C_$CaptionExit
73367>>>>>        Set psToolTip to C_$ToolTipExit
73368>>>>>        Set psDescription to C_$ToolTipExit
73369>>>>>        Set psShortcut to C_$Key_Alt_F4
73370>>>>>        Set psCategory to C_$CategoryFile
73371>>>>>    End_Procedure
73372>>>>>
73372>>>>>    Procedure OnExecute Variant vCommandBarControl
73374>>>>>        Send Exit_Application of Desktop
73375>>>>>    End_Procedure
73376>>>>>
73376>>>>>End_Class           
73377>>>>>
73377>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
73378>>>>>
73378>>>>>    Procedure Construct_Object
73380>>>>>        Forward Send Construct_Object
73382>>>>>        Set psCaption to C_$CaptionHelp
73383>>>>>        Set psDescription to C_$ToolTipHelp
73384>>>>>        Set psToolTip to C_$DescHelp
73385>>>>>        Set psImage to "ActionHelp.ico"
73386>>>>>        Set psShortcut to "F1"
73387>>>>>        Set psCategory to C_$CategoryHelp
73388>>>>>    End_Procedure
73389>>>>>    
73389>>>>>    Procedure OnExecute Variant vCommandBarControl
73391>>>>>        Send Help of (Focus(Self))
73392>>>>>    End_Procedure
73393>>>>>
73393>>>>>End_Class
73394>>>>>
73394>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
73395>>>>>
73395>>>>>    Procedure Construct_Object
73397>>>>>        Forward Send Construct_Object
73399>>>>>        Set psCaption to C_$CaptionAddStatusbar
73400>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
73401>>>>>        Set psDescription to  C_$DescAddStatusbar
73402>>>>>        Set psCategory to C_$CategoryWindow
73403>>>>>    End_Procedure
73404>>>>>
73404>>>>>    Procedure OnExecute Variant vCommandBarControl
73406>>>>>        Handle hoCommandBars hoClientArea
73406>>>>>        Get CommandBarSystemObject to hoCommandBars
73407>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73408>>>>>        If hoClientArea Begin
73410>>>>>            // the clientarea's parent panel has message
73410>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
73411>>>>>        End
73411>>>>>>
73411>>>>>    End_Procedure
73412>>>>>
73412>>>>>     Function IsChecked Returns Boolean
73414>>>>>        Boolean bOn
73414>>>>>        Handle hoCommandBars hoClientArea
73414>>>>>        Get CommandBarSystemObject to hoCommandBars
73415>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73416>>>>>        If hoClientArea Begin
73418>>>>>            // the clientarea's parent panel has message
73418>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
73419>>>>>        End
73419>>>>>>
73419>>>>>        Function_Return bOn
73420>>>>>     End_Function
73421>>>>>End_Class
73422>>>>>
73422>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
73423>>>>>
73423>>>>>    Procedure Construct_Object
73425>>>>>        Forward Send Construct_Object
73427>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
73428>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
73429>>>>>        Set psDescription to C_$DescAutoArrangeIcons
73430>>>>>        Set psCategory to C_$CategoryWindow
73431>>>>>    End_Procedure
73432>>>>>
73432>>>>>    Procedure OnExecute Variant vCommandBarControl
73434>>>>>        Handle hoCommandBars hoClientArea
73434>>>>>        Get CommandBarSystemObject to hoCommandBars
73435>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73436>>>>>        If hoClientArea Begin
73438>>>>>            // the clientarea's parent panel has message
73438>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
73439>>>>>        End
73439>>>>>>
73439>>>>>    End_Procedure
73440>>>>>    
73440>>>>>     Function IsChecked Returns Boolean
73442>>>>>        Boolean bOn
73442>>>>>        Handle hoCommandBars hoClientArea
73442>>>>>        Get CommandBarSystemObject to hoCommandBars
73443>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73444>>>>>        If hoClientArea Begin
73446>>>>>            // the clientarea's parent panel has message
73446>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
73447>>>>>        End
73447>>>>>>
73447>>>>>        Function_Return bOn
73448>>>>>     End_Function
73449>>>>>End_Class
73450>>>>>
73450>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
73451>>>>>
73451>>>>>    Procedure Construct_Object
73453>>>>>        Forward Send Construct_Object
73455>>>>>        Set psCaption to C_$CaptionRestoreMenus
73456>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
73457>>>>>        Set psDescription to C_$DescRestoreMenus
73458>>>>>        Set psCategory to C_$CategoryWindow
73459>>>>>    End_Procedure
73460>>>>>
73460>>>>>    Procedure OnExecute Variant vCommandBarControl
73462>>>>>        Handle hoCommandBars
73462>>>>>        Get CommandBarSystemObject to hoCommandBars
73463>>>>>        Send RestoreLayout of hoCommandBars
73464>>>>>    End_Procedure
73465>>>>>    
73465>>>>>End_Class
73466>>>>>
73466>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
73467>>>>>
73467>>>>>    Procedure Construct_Object
73469>>>>>        Forward Send Construct_Object
73471>>>>>        Set psCaption to C_$CaptionCascade
73472>>>>>        Set psToolTip to C_$ToolTipCascade
73473>>>>>        Set psDescription to  C_$DescCascade
73474>>>>>        Set psImage to "ActionCascade.ico"
73475>>>>>        Set psCategory to C_$CategoryWindow
73476>>>>>    End_Procedure
73477>>>>>    
73477>>>>>    Procedure OnExecute Variant vCommandBarControl
73479>>>>>        Handle hoCommandBars hoClientArea
73479>>>>>        Get CommandBarSystemObject to hoCommandBars
73480>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73481>>>>>        If hoClientArea Begin
73483>>>>>            Send Cascade_Windows of hoClientArea
73484>>>>>        End
73484>>>>>>
73484>>>>>    End_Procedure
73485>>>>>End_Class
73486>>>>>
73486>>>>>Class cCJTileHorizontally is a cCJMenuItem
73487>>>>>
73487>>>>>    Procedure Construct_Object
73489>>>>>        Forward Send Construct_Object
73491>>>>>        Set psCaption to C_$CaptionTileHorizontally 
73492>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
73493>>>>>        Set psDescription to  C_$DescTileHorizontally
73494>>>>>        Set psImage to "ActionTileHorizontally.ico"
73495>>>>>        Set psCategory to C_$CategoryWindow
73496>>>>>    End_Procedure
73497>>>>>
73497>>>>>    Procedure OnExecute Variant vCommandBarControl
73499>>>>>        Handle hoCommandBars hoClientArea
73499>>>>>        Get CommandBarSystemObject to hoCommandBars
73500>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73501>>>>>        If hoClientArea Begin
73503>>>>>            Send Tile_Windows_Horizontal of hoClientArea
73504>>>>>        End
73504>>>>>>
73504>>>>>    End_Procedure
73505>>>>>End_Class
73506>>>>>
73506>>>>>Class cCJTileVertically is a cCJMenuItem
73507>>>>>
73507>>>>>    Procedure Construct_Object
73509>>>>>        Forward Send Construct_Object
73511>>>>>        Set psCaption to C_$CaptionTileVertically  
73512>>>>>        Set psToolTip to C_$ToolTipTileVertically
73513>>>>>        Set psDescription to  C_$DescTileVertically
73514>>>>>        Set psImage to "ActionTileVertically.ico"
73515>>>>>        Set psCategory to C_$CategoryWindow
73516>>>>>    End_Procedure
73517>>>>>
73517>>>>>    Procedure OnExecute Variant vCommandBarControl
73519>>>>>        Handle hoCommandBars hoClientArea
73519>>>>>        Get CommandBarSystemObject to hoCommandBars
73520>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73521>>>>>        If hoClientArea Begin
73523>>>>>            Send Tile_Windows_Vertical of hoClientArea
73524>>>>>        End
73524>>>>>>
73524>>>>>    End_Procedure
73525>>>>>End_Class
73526>>>>>
73526>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
73527>>>>>
73527>>>>>    Procedure Construct_Object
73529>>>>>        Forward Send Construct_Object
73531>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
73532>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
73533>>>>>        Set psDescription to  C_$DescMinimizeWindows
73534>>>>>        Set psCategory to C_$CategoryWindow
73535>>>>>    End_Procedure
73536>>>>>
73536>>>>>    Procedure OnExecute Variant vCommandBarControl
73538>>>>>        Handle hoCommandBars hoClientArea
73538>>>>>        Get CommandBarSystemObject to hoCommandBars
73539>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73540>>>>>        If hoClientArea Begin
73542>>>>>            // the clientarea's parent panel has message
73542>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
73543>>>>>        End
73543>>>>>>
73543>>>>>    End_Procedure
73544>>>>>End_Class
73545>>>>>
73545>>>>>
73545>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
73546>>>>>
73546>>>>>    Procedure Construct_Object
73548>>>>>        Forward Send Construct_Object
73550>>>>>        Set psCaption to C_$CaptionRestoreWindows
73551>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
73552>>>>>        Set psDescription to  C_$DescRestoreWindows
73553>>>>>        Set psCategory to C_$CategoryWindow
73554>>>>>    End_Procedure
73555>>>>>
73555>>>>>    Procedure OnExecute Variant vCommandBarControl
73557>>>>>        Handle hoCommandBars hoClientArea
73557>>>>>        Get CommandBarSystemObject to hoCommandBars
73558>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73559>>>>>        If hoClientArea Begin
73561>>>>>            // the clientarea's parent panel has message
73561>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
73562>>>>>        End
73562>>>>>>
73562>>>>>    End_Procedure
73563>>>>>End_Class
73564>>>>>
73564>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
73565>>>>>
73565>>>>>    Procedure Construct_Object
73567>>>>>        Forward Send Construct_Object
73569>>>>>        Set psCaption to C_$CaptionArrangeIcons  
73570>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
73571>>>>>        Set psDescription to  C_$DescArrangeIcons
73572>>>>>        Set psCategory to C_$CategoryWindow
73573>>>>>    End_Procedure
73574>>>>>
73574>>>>>    Procedure OnExecute Variant vCommandBarControl
73576>>>>>        Handle hoCommandBars hoClientArea
73576>>>>>        Get CommandBarSystemObject to hoCommandBars
73577>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73578>>>>>        If hoClientArea Begin
73580>>>>>            Send Arrange_Icons of hoClientArea
73581>>>>>        End
73581>>>>>>
73581>>>>>    End_Procedure
73582>>>>>
73582>>>>>End_Class
73583>>>>>    
73583>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\cCJAboutMenuItem.pkg)
73583>>>>>Use cCJCommandBarSystem.pkg
73583>>>>>Use LanguageText.pkg
73583>>>>>
73583>>>>>// It is expected that if you use this class that you provide an about object that is
73583>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
73583>>>>>// because you may wish to create your own custom about package.
73583>>>>>
73583>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
73584>>>>>
73584>>>>>    Procedure Construct_Object
73586>>>>>        Forward Send Construct_Object
73588>>>>>        Set psCaption to C_$CaptionAbout
73589>>>>>        Set psDescription to C_$ToolTipAbout
73590>>>>>        Set psToolTip to C_$DescAbout
73591>>>>>        Set psImage to "ActionAbout.ico"
73592>>>>>        Set psCategory to C_$CategoryHelp
73593>>>>>    End_Procedure
73594>>>>>    
73594>>>>>    Procedure OnExecute Variant vCommandBarControl
73596>>>>>        Handle hoCommandBars hoClientArea
73596>>>>>        Get CommandBarSystemObject to hoCommandBars
73597>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
73598>>>>>        If hoClientArea Begin
73600>>>>>            Send Activate_About of hoClientArea
73601>>>>>        End
73601>>>>>>
73601>>>>>    End_Procedure
73602>>>>>
73602>>>>>End_Class
73603>>>>>
73603>>>>>
73603>>>Use cCJDeoMenuItemClasses.pkg
73603>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\cCJMDIWindowsMenuItem.pkg)
73603>>>>>Use cCJCommandBarSystem.pkg
73603>>>>>
73603>>>>>Register_Function Client_ID Returns Integer
73603>>>>>
73603>>>>>// only used by cCJMDIWIndowsMenuItem
73603>>>>>Class cCJMDIWindowItem is a cCJMenuItem
73604>>>>>
73604>>>>>    Procedure Construct_Object
73606>>>>>        Forward Send Construct_Object
73608>>>>>        Property Handle phWindow 0 // object id of view
73609>>>>>        Set pbControlFlagNoMovable to True
73610>>>>>        Set pbActiveUpdate to True
73611>>>>>    End_Procedure
73612>>>>>    
73612>>>>>    Procedure OnExecute Variant vCommandBarControl
73614>>>>>        Handle hWindow
73614>>>>>        Get phWindow to hWindow
73615>>>>>        Send Activate_View of hWindow
73616>>>>>    End_Procedure
73617>>>>>    
73617>>>>>End_Class                
73618>>>>>
73618>>>>>
73618>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
73619>>>>>    
73619>>>>>    Procedure Construct_Object
73621>>>>>        Forward Send Construct_Object
73623>>>>>        Property Handle[] phArrayOfWindows
73624>>>>>        Set peControlType to xtpControlPopup
73625>>>>>        Set psCategory to C_$CategoryWindow
73626>>>>>    End_Procedure
73627>>>>>    
73627>>>>>     // This adds MDI windows to the existing menu items.
73627>>>>>     // This removes any existing windows menus and always adds a new set to the end
73627>>>>>
73627>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
73629>>>>>        Handle  hClientArea hView
73629>>>>>        String  sLabel
73629>>>>>        Integer i iWindows
73629>>>>>        Handle[] hArrayOfWindows
73630>>>>>        Variant vItem
73630>>>>>        
73630>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
73630>>>>>        // also assume that destroying an action removes all menu instances of that action
73630>>>>>        Get phArrayOfWindows to hArrayOfWindows
73631>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
73632>>>>>        For i from 0 to (iWindows-1)
73638>>>>>>
73638>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
73639>>>>>        Loop
73640>>>>>>
73640>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
73641>>>>>
73641>>>>>        // Add all views to this menu. Create the action and add the item
73641>>>>>        Move 0 to i
73642>>>>>        Get Client_Id to hClientArea // object id of client area
73643>>>>>        If (hClientArea > 0) Begin
73645>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
73646>>>>>            While (hView <> 0)
73650>>>>>                If (Active_State(hView)) Begin
73652>>>>>                    // create the action
73652>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
73653>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
73654>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
73655>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
73656>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
73658>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
73659>>>>>                    End
73659>>>>>>
73659>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
73660>>>>>                    If (i=0) Begin
73662>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
73663>>>>>                    End
73663>>>>>>
73663>>>>>                    // Create a menu item for this action
73663>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
73664>>>>>                    Increment i
73665>>>>>                End
73665>>>>>>
73665>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
73666>>>>>            Loop
73667>>>>>>
73667>>>>>        End
73667>>>>>>
73667>>>>>
73667>>>>>        Set phArrayOfWindows to hArrayOfWindows
73668>>>>>
73668>>>>>     End_Procedure
73669>>>>>     
73669>>>>>End_Class
73670>>>>>
73670>
73670>Object oHtmlHelp is a cHtmlHelp
73672>End_Object
73673>
73673>Object oApplication is a cApplication
73675>    Set peHelpType to htHtmlHelp
73676>End_Object
73677>
73677>Object oToolTipController is a cToolTipController
73679>    Move Self to ghoToolTipController
73680>End_Object
73681>
73681>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\oEditContextMenu.pkg)
73681>>>Use cCJStandardMenuItemClasses.pkg
73681>>>
73681>>>Object oEditContextMenu is a cCJContextMenu
73683>>>    
73683>>>    Move Self to Default_Form_Floating_Menu_ID
73684>>>    
73684>>>    Object oUndoMenuItem is a cCJUndoMenuItem
73686>>>    End_Object
73687>>>    
73687>>>    Object oCutMenuItem is a cCJCutMenuItem
73689>>>        Set pbControlBeginGroup to True
73690>>>    End_Object
73691>>>    
73691>>>    Object oCopyMenuItem is a cCJCopyMenuItem
73693>>>    End_Object
73694>>>
73694>>>    Object oPasteMenuItem is a cCJPasteMenuItem
73696>>>    End_Object
73697>>>
73697>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
73699>>>    End_Object
73700>>>
73700>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
73702>>>        Set pbControlBeginGroup to True
73703>>>    End_Object
73704>>>
73704>>>End_Object
73705>>>
73705>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\oDEOEditContextMenu17.pkg)
73705>>>Use Windows.pkg
73705>>>Use cCJStandardMenuItemClasses.pkg
73705>>>Use cCJDeoMenuItemClasses.pkg
73705>>>
73705>>>
73705>>>Object oDEOEditContextMenu17 is a cCJContextMenu
73707>>>    
73707>>>    Move Self to Default_dbFloating_Menu_ID
73708>>>    
73708>>>    Object oUndoMenuItem is a cCJUndoMenuItem
73710>>>    End_Object
73711>>>    
73711>>>    Object oCutMenuItem is a cCJCutMenuItem
73713>>>        Set pbControlBeginGroup to True
73714>>>    End_Object
73715>>>    
73715>>>    Object oCopyMenuItem is a cCJCopyMenuItem
73717>>>    End_Object
73718>>>
73718>>>    Object oPasteMenuItem is a cCJPasteMenuItem
73720>>>    End_Object
73721>>>
73721>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
73723>>>    End_Object
73724>>>
73724>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
73726>>>        Set pbControlBeginGroup to True
73727>>>    End_Object
73728>>>
73728>>>    Object oPromptMenuItem is a cCJPromptMenuItem
73730>>>        Set pbControlBeginGroup to True
73731>>>    End_Object
73732>>>
73732>>>    Object oFindNextMenu is a cCJFindNextMenuItem
73734>>>        Set pbControlBeginGroup to True
73735>>>    End_Object
73736>>>
73736>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
73738>>>    End_Object
73739>>>
73739>>>    Object oClearMenuItem is a cCJClearMenuItem
73741>>>        Set pbControlBeginGroup to True
73742>>>    End_Object
73743>>>
73743>>>    Object oClearAllMenu is a cCJClearAllMenuItem
73745>>>    End_Object
73746>>>
73746>>>    Object oSaveMenu is a cCJSaveMenuItem
73748>>>    End_Object
73749>>>    
73749>>>    Object oDeleteMenu is a cCJDeleteMenuItem
73751>>>    End_Object
73752>>>
73752>>>    Object oRememberitem is a cCJRememberFieldMenuItem
73754>>>        Set pbControlBeginGroup to True
73755>>>    End_Object
73756>>>
73756>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
73758>>>    End_Object
73759>>>
73759>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
73761>>>    End_Object
73762>>>
73762>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
73764>>>    End_Object
73765>>>
73765>>>End_Object
73766>
73766>Object oMain is a Panel
73768>    Set Label To "My Project"
73769>    Set Location to 4 3
73770>    Set Size to 300 450
73771>
73771>    Object oCommandBarSystem is a cCJCommandBarSystem
73773>        Set pbTimerUpdate to True
73774>
73774>        Procedure OnCreateCommandBars
73777>            Handle hoOptions
73777>            Get OptionsObject to hoOptions
73778>            Forward Send OnCreateCommandBars
73780>        End_Procedure
73781>
73781>        Object oMenuBar is a cCJMenuBar
73783>
73783>            Object oFileMenu is a cCJMenuItem
73785>                Set peControlType to xtpControlPopup          
73786>                Set psCaption   to "&File"
73787>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
73788>                Set psCategory to "Menus"
73789>
73789>                Object oClearMenuItem is a cCJClearMenuItem
73791>                    Set pbAddToDesignerMenu to True
73792>                End_Object
73793>
73793>                Object oClearAllMenu is a cCJClearAllMenuItem
73795>                    Set pbAddToDesignerMenu to True
73796>                End_Object
73797>
73797>                Object oPromptMenuItem is a cCJPromptMenuItem
73799>                    Set pbAddToDesignerMenu to True
73800>                    Set pbControlBeginGroup to True
73801>                End_Object
73802>
73802>                Object oFindMenuItem is a cCJFindMenuItem
73804>                    Set pbAddToDesignerMenu to True
73805>                    Set pbControlBeginGroup to True
73806>                End_Object
73807>
73807>                Object oFindNextMenu is a cCJFindNextMenuItem
73809>                    Set pbAddToDesignerMenu to True
73810>                End_Object
73811>
73811>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
73813>                    Set pbAddToDesignerMenu to True
73814>                End_Object
73815>
73815>                Object oFindFirstMenu is a cCJFindFirstMenuItem
73817>                    Set pbAddToDesignerMenu to True
73818>                End_Object
73819>
73819>                Object oFindLastMenu is a cCJFindLastMenuItem
73821>                    Set pbAddToDesignerMenu to True
73822>                End_Object
73823>
73823>                Object oSaveMenuItem is a cCJSaveMenuItem
73825>                    Set pbAddToDesignerMenu to True
73826>                    Set pbControlBeginGroup to True
73827>                End_Object
73828>
73828>                Object oDeleteMenuItem is a cCJDeleteMenuItem
73830>                    Set pbAddToDesignerMenu to True
73831>                End_Object
73832>
73832>                Object oExitMenu is a cCJExitMenuItem
73834>                    Set pbControlBeginGroup to True
73835>                End_Object
73836>
73836>            End_Object
73837>
73837>            Object oViewMenu is a cCJMenuItem
73839>                Set peControlType to xtpControlPopup
73840>                Set psCaption to "&View"
73841>                Set psToolTip to "View"
73842>                Set psDescription to "Available Views"
73843>
73843>                Object oSoforEntryMenuItem is a cCJMenuItem
73845>                    Set psCaption to "SoforEntry"
73846>                    Set psTooltip to "SoforEntry"
73847>                
73847>                    Procedure OnExecute Variant vCommandBarControl
73850>                        Handle hoClient
73850>                        Get Client_Id to hoClient
73851>                        Send Activate_oSoforEntry of hoClient
73852>                    End_Procedure
73853>                End_Object
73854>
73854>                Object oGepkocsiEntryMenuItem is a cCJMenuItem
73856>                    Set psCaption to "GepkocsiEntry"
73857>                    Set psTooltip to "GepkocsiEntry"
73858>                
73858>                    Procedure OnExecute Variant vCommandBarControl
73861>                        Handle hoClient
73861>                        Get Client_Id to hoClient
73862>                        Send Activate_oGepkocsiEntry of hoClient
73863>                    End_Procedure
73864>                End_Object
73865>
73865>                Object oTermekEntryMenuItem is a cCJMenuItem
73867>                    Set psCaption to "TermekEntry"
73868>                    Set psTooltip to "TermekEntry"
73869>                
73869>                    Procedure OnExecute Variant vCommandBarControl
73872>                        Handle hoClient
73872>                        Get Client_Id to hoClient
73873>                        Send Activate_oTermekEntry of hoClient
73874>                    End_Procedure
73875>                End_Object
73876>
73876>                Object oFuvarlevelEntryMenuItem is a cCJMenuItem
73878>                    Set psCaption to "FuvarlevelEntry"
73879>                    Set psTooltip to "FuvarlevelEntry"
73880>                
73880>                    Procedure OnExecute Variant vCommandBarControl
73883>                        Handle hoClient
73883>                        Get Client_Id to hoClient
73884>                        Send Activate_oFuvarlevelEntry of hoClient
73885>                    End_Procedure
73886>                End_Object
73887>            End_Object
73888>            
73888>            Object oReportMenu is a cCJMenuItem
73890>                Set peControlType to xtpControlPopup
73891>                Set psCaption to "&Report"
73892>                Set psToolTip to "Report"
73893>                Set psDescription to "Available Reports"
73894>
73894>                Object oHaviMenuItem is a cCJMenuItem
73896>                    Set psCaption to "Havi"
73897>                    Set psTooltip to "Havi"
73898>                
73898>                    Procedure OnExecute Variant vCommandBarControl
73901>                        Handle hoClient
73901>                        Get Client_Id to hoClient
73902>                        Send Activate_oHavi of hoClient
73903>                    End_Procedure
73904>                End_Object
73905>            End_Object
73906>
73906>            Object oNavigateMenu is a cCJMenuItem
73908>                Set peControlType to xtpControlPopup      
73909>                Set psCaption to "&Navigate"    
73910>                Set psTooltip to "Navigate"    
73911>                Set psDescription to "Move to different areas of the application"
73912>
73912>                Object oNextAreaMenu is a cCJNextAreaMenu
73914>                End_Object
73915>
73915>                Object oPriorAreaMenu is a cCJPriorAreaMenu
73917>                End_Object
73918>
73918>                Object oNextViewMenu is a cCJNextViewMenu
73920>                End_Object
73921>
73921>                Object oPriorViewMenu is a cCJPriorViewMenu
73923>                End_Object
73924>
73924>                Object oPromptMenu is a cCJPromptMenuItem
73926>                    Set pbControlBeginGroup to True
73927>                End_Object
73928>
73928>                Object oZoomMenu is a cCJZoomMenuItem
73930>                End_Object
73931>
73931>            End_Object
73932>
73932>            Object oWindowMenu is a cCJMDIWindowsMenuItem
73934>                Set peControlType to xtpControlPopup
73935>                Set psCaption to "&Window"
73936>                Set psToolTip to "Window"
73937>                Set psDescription to "Display Current Views and set other display options."    
73938>
73938>                // These are the static windows items. More will be created in onInitPopup 
73938>                Object oDisplayOptionsMenu is a cCJMenuItem
73940>                    Set peControlType to xtpControlPopup          
73941>                    Set psCaption to "&Display Options"
73942>                    Set psToolTip to "Display Options"
73943>                    Set psDescription to "Set display options"
73944>
73944>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
73946>                    End_Object
73947>
73947>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
73949>                    End_Object
73950>
73950>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
73952>                        Set pbControlBeginGroup to True
73953>                    End_Object
73954>
73954>                End_Object
73955>
73955>                Object oCascadeMenu is a cCJCascadeMenuItem
73957>                    Set pbControlBeginGroup to True
73958>                End_Object
73959>
73959>                Object oHorizTile is a cCJTileHorizontally
73961>                End_Object
73962>
73962>                Object oVertTile is a cCJTileVertically
73964>                End_Object
73965>
73965>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
73967>                    Set pbControlBeginGroup to True
73968>                End_Object
73969>
73969>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
73971>                End_Object
73972>
73972>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
73974>                    Set pbControlBeginGroup to True
73975>                End_Object
73976>
73976>            End_Object
73977>
73977>            Object oHelpMenu is a cCJMenuItem
73979>                Set peControlType to xtpControlPopup    
73980>                Set psCaption to "&Help"
73981>                Set psDescription to "Access Information for learning and using this DataFlex application."
73982>                Set psToolTip to "Help"
73983>
73983>                Object oHelpMenuItem is a cCJHelpMenuItem 
73985>                End_Object
73986>
73986>                Object oAboutMenuItem is a cCJAboutMenuItem
73988>                End_Object
73989>
73989>            End_Object
73990>
73990>        End_Object
73991>
73991>        Object oFindToolBar is a cCJToolbar
73993>            Set psTitle to "Finding Toolbar"
73994>
73994>            Object oFindFirstTool is a cCJFindFirstMenuItem
73996>            End_Object
73997>
73997>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
73999>            End_Object
74000>
74000>            Object oFindMenuTool is a cCJFindMenuItem
74002>            End_Object
74003>
74003>            Object oFindNextTool is a cCJFindNextMenuItem
74005>            End_Object
74006>
74006>            Object oFindLastTool is a cCJFindLastMenuItem
74008>            End_Object
74009>
74009>            Object oPromptToolItem is a cCJPromptMenuItem
74011>                Set pbControlBeginGroup to True
74012>            End_Object
74013>
74013>        End_Object
74014>
74014>        Object oFileToolBar is a cCJToolbar
74016>            Set psTitle to "Data Entry Toolbar"
74017>
74017>            Object oClearToolItem is a cCJClearMenuItem
74019>                Set peControlStyle to xtpButtonIconAndCaption
74020>            End_Object
74021>
74021>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
74023>                Set peControlStyle to xtpButtonIconAndCaption
74024>            End_Object
74025>
74025>            Object oSaveToolItem is a cCJSaveMenuItem
74027>                Set peControlStyle to xtpButtonIconAndCaption
74028>                Set pbControlBeginGroup to True
74029>            End_Object
74030>
74030>            Object oDeleteToolItem is a cCJDeleteMenuItem
74032>                Set peControlStyle to xtpButtonIconAndCaption
74033>            End_Object
74034>
74034>        End_Object
74035>
74035>        Object oEditToolBar is a cCJToolbar
74037>            Set psTitle to "Edit Toolbar"
74038>
74038>            Object oCutToolbarItem is a cCJCutMenuItem
74040>            End_Object
74041>
74041>            Object oCopyToolbarItem is a cCJCopyMenuItem
74043>            End_Object
74044>
74044>            Object oPasteToolbarItem is a cCJPasteMenuItem
74046>            End_Object
74047>
74047>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
74049>                Set pbControlBeginGroup to True
74050>            End_Object
74051>
74051>        End_Object
74052>
74052>        Object oRememberToolbar is a cCJToolbar
74054>
74054>            Object oRememberItems is a cCJMenuItem
74056>
74056>                Set peControlType to xtpControlPopup
74057>                Set peControlStyle to xtpButtonCaption
74058>                Set psCaption to C_$Remember
74059>                
74059>                Object oMenuItem is a cCJRememberFieldMenuItem
74061>                    Set peControlStyle to xtpButtonIconAndCaption
74062>                End_Object
74063>                
74063>                Object oMenuItem is a cCJRememberLastFieldMenuItem
74065>                    Set peControlStyle to xtpButtonIconAndCaption
74066>                End_Object
74067>                
74067>                Object oMenuItem is a cCJUnRememberFieldMenuItem
74069>                    Set peControlStyle to xtpButtonIconAndCaption
74070>                End_Object
74071>                
74071>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
74073>                    Set peControlStyle to xtpButtonIconAndCaption
74074>                End_Object
74075>
74075>            End_Object
74076>            
74076>        End_Object
74077>        
74077>        Object oStatusBar is a cCJStatusBar
74079>
74079>            Object oStatusPane1 is a cCJStatusBarPane
74081>                Set piID to sbpIDIdlePane
74082>                Set pbStyleStretch to True
74083>            End_Object
74084>
74084>            Object oStatusPane2 is a cCJStatusBarPane
74086>                Set phoViewPane to Self
74087>                Set pbStyleStretch to True
74088>            End_Object
74089>
74089>        End_Object
74090>
74090>    End_Object
74091>
74091>    Object oClientArea is a ClientArea
74093>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\StdAbout.pkg)
74093>>>//************************************************************************
74093>>>// Confidential Trade Secret.
74093>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
74093>>>// as an unpublished work.  All rights reserved.
74093>>>// DataFlex is a registered trademark of Data Access Corporation.
74093>>>//
74093>>>//************************************************************************
74093>>>//************************************************************************
74093>>>//
74093>>>// $File name  : StdAbout.pkg
74093>>>// $File title : Standard about object package for VDF
74093>>>// Notice      :
74093>>>// $Author(s)  : John Tuohy
74093>>>//
74093>>>// $Rev History
74093>>>//
74093>>>// JT 06/27/97   File created
74093>>>//************************************************************************
74093>>>
74093>>>// This provides a quick and simple way to create an about package for a program.
74093>>>// You need to create a message inside you client area called Activate_About.
74093>>>// Within this message you should send the message DoAbout passing needed
74093>>>// string information.
74093>>>//
74093>>>//       Procedure Activate_About
74093>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
74093>>>//       End_Procedure
74093>>>//    where: sTitle =     Name of application. If none provided, uses caption
74093>>>//                        bar title
74093>>>//           sVersion   = Version Line. If none provided, will be blank
74093>>>//           sCopyRight = Copyright Line. If none provided, will be blank
74093>>>//           sAuthor    = Author name, blank if none provided
74093>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
74093>>>//                        is used.
74093>>>// It is expected that you will place this in your own object package. For
74093>>>// example an order about package may look like this:
74093>>>//
74093>>>//   // OrderAbout.pkg
74093>>>//   Use StdAbout.pkg
74093>>>//   Procedure Activate_About
74093>>>//      String sTitle sCopyright sVersion sAuthor
74093>>>//      Move "My Order Entry System" to sTitle
74093>>>//      Move "Version 2.1" to sVersion
74093>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
74093>>>//      Move "John Smith"  to sAuthor
74093>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
74093>>>//   end_procedure
74093>>>//   // end of file.
74093>>>
74093>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\Dfabout.pkg)
74093>>>>>//************************************************************************
74093>>>>>// Confidential Trade Secret.
74093>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
74093>>>>>// as an unpublished work.  All rights reserved.
74093>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
74093>>>>>//
74093>>>>>//************************************************************************
74093>>>>>//************************************************************************
74093>>>>>//
74093>>>>>// $File name  : DfAbout.pkg
74093>>>>>// $File title : About class support
74093>>>>>// Notice      :
74093>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
74093>>>>>//
74093>>>>>// $Rev History
74093>>>>>//
74093>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
74093>>>>>//                Windows for the size first. 
74093>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
74093>>>>>//                with anchor technique. Removed unnessary property in the
74093>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
74093>>>>>//                object To better look in Windows XP. Repositioned the close
74093>>>>>//                button in the sysinfo dialog To line up with the display area
74093>>>>>//                Replaced obsolete code and techniques. Removed dead code.
74093>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
74093>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
74093>>>>>//                the global Workspace object, if it is present
74093>>>>>// JJT 11/05/98   Added version information
74093>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
74093>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
74093>>>>>//                workspace package.
74093>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
74093>>>>>//                class can create this object.
74093>>>>>//                Cleaned up the interface (used correct classes and messages)
74093>>>>>//                Added workspace reporting support To sys-info.
74093>>>>>//                Turned off wrapping in the sys-info editor.
74093>>>>>// KR  ??/??/96   File created
74093>>>>>//************************************************************************
74093>>>>>Use LanguageText.pkg
74093>>>>>Use Windows.pkg
74093>>>>>Use DFbitmap.pkg
74093>>>>>Use GlobalFunctionsProcedures.pkg
74093>>>>>Use cTextEdit.pkg
74093>>>>>
74093>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\cli.pkg)
74093>>>>>>>//*****************************************************************************
74093>>>>>>>//*** CLI.PKG                                                               ***
74093>>>>>>>//***                                                                       ***
74093>>>>>>>//*** Author: Ben Weijers                                                   ***
74093>>>>>>>//***         Data Access Nederland                                         ***
74093>>>>>>>//***         10 September 1998                                             ***
74093>>>>>>>//***                                                                       ***
74093>>>>>>>//*** Purpose:                                                              ***
74093>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
74093>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
74093>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
74093>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
74093>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
74093>>>>>>>//***                                                                       ***
74093>>>>>>>//***   This package defines the common functionality for all CLI based     ***
74093>>>>>>>//***   drivers.                                                            ***
74093>>>>>>>//***                                                                       ***
74093>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
74093>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
74093>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
74093>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
74093>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
74093>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
74093>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
74093>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
74093>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
74093>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
74093>>>>>>>//***             mssqldrv.pkg                                              ***
74093>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
74093>>>>>>>//***             Added type mappings attributes                            ***
74093>>>>>>>//*****************************************************************************
74093>>>>>>>
74093>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
74093>>>>>>>//*** Driver attributes
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//------------------------------------------------------------
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//-------------------------------------
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//*** Replacement for logical column number that indicates all columns
74093>>>>>>>
74093>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
74093>>>>>>>
74093>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
74093>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
74093>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>// Moved to Mssqldrv.pkg
74093>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
74093>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
74093>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
74093>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
74093>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
74093>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
74093>>>>>>>
74093>>>>>>>//*** Possible SQL Column type values
74093>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
74093>>>>>>>Define SQL_CHAR           For    1
74093>>>>>>>Define SQL_NUMERIC        For    2
74093>>>>>>>Define SQL_DECIMAL        For    3
74093>>>>>>>Define SQL_INTEGER        For    4
74093>>>>>>>Define SQL_SMALLINT       For    5
74093>>>>>>>Define SQL_FLOAT          For    6
74093>>>>>>>Define SQL_REAL           For    7
74093>>>>>>>Define SQL_DOUBLE         For    8
74093>>>>>>>Define SQL_DATETIME       For    9
74093>>>>>>>Define SQL_VARCHAR        For   12
74093>>>>>>>Define SQL_TYPE_DATE      For   91
74093>>>>>>>Define SQL_TYPE_TIME      For   92
74093>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
74093>>>>>>>// Moved to mssqldrv.pkg
74093>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>Define SQL_DATE           For    9
74093>>>>>>>Define SQL_INTERVAL       For   10
74093>>>>>>>Define SQL_TIME           For   10
74093>>>>>>>Define SQL_TIMESTAMP      For   11
74093>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
74093>>>>>>>Define SQL_BINARY         For  (-2)
74093>>>>>>>Define SQL_VARBINARY      For  (-3)
74093>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
74093>>>>>>>Define SQL_BIGINT         For  (-5)
74093>>>>>>>Define SQL_TINYINT        For  (-6)
74093>>>>>>>Define SQL_BIT            For  (-7)
74093>>>>>>>Define SQL_WCHAR          For  (-8)
74093>>>>>>>Define SQL_WVARCHAR       For  (-9)
74093>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
74093>>>>>>>Define SQL_GUID           For (-11)
74093>>>>>>>
74093>>>>>>>//*** Driver level attributes
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//*** Error number constants
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//*** Call driver function identifiers
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//*** Init data source types
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//*** Dummy strings used in the commands
74093>>>>>>>    String  CLI$StrDummy 255
74093>>>>>>>    Integer CLI$IntDummy
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//*****************************************************************************
74093>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
74093>>>>>>>//***                                                                       ***
74093>>>>>>>//***   Setup a constraint for a file.                                      ***
74093>>>>>>>//*****************************************************************************
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//*****************************************************************************
74093>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
74093>>>>>>>//***                                                                       ***
74093>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
74093>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
74093>>>>>>>//*** permanently set driver level attributes change the driver             ***
74093>>>>>>>//*** configuration file.                                                   ***
74093>>>>>>>//*****************************************************************************
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>
74093>>>>>>>//*****************************************************************************
74093>>>>>>>//*** Class  : cCLIHandler                                                  ***
74093>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
74093>>>>>>>//***          call several CLI releated methods.                           ***
74093>>>>>>>//*****************************************************************************
74093>>>>>>>
74093>>>>>>>Class cCLIHandler Is An Array
74094>>>>>>>
74094>>>>>>>    Procedure Construct_Object Integer iImage
74096>>>>>>>        Forward Send Construct_object iImage
74098>>>>>>>
74098>>>>>>>        Property String  psDriverID       Public ""
74099>>>>>>>    End_Procedure // Construct_Object
74100>>>>>>>
74100>>>>>>>
74100>>>>>>>
74100>>>>>>>    //***
74100>>>>>>>    //*** Fucntion: CKRevsion
74100>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
74100>>>>>>>    //***
74100>>>>>>>
74100>>>>>>>    Function CKRevision Returns String
74102>>>>>>>        Local String  sDriverID
74102>>>>>>>        Local String  sRevision
74102>>>>>>>        Local String  sVoid
74102>>>>>>>        Local Integer iRetval
74102>>>>>>>
74102>>>>>>>        Get psDriverID To sDriverID
74103>>>>>>>        If (sDRiverID <> "") Begin
74105>>>>>>>            Move (Repeat(" ", 255)) To sRevision
74106>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
74111>>>>>>>        End
74111>>>>>>>>
74111>>>>>>>
74111>>>>>>>        Function_Return sRevision
74112>>>>>>>    End_Function // CKRevision
74113>>>>>>>
74113>>>>>>>
74113>>>>>>>
74113>>>>>>>    //***
74113>>>>>>>    //*** Function: ExtractPartFromRevision
74113>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
74113>>>>>>>    //***
74113>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
74113>>>>>>>    //***
74113>>>>>>>
74113>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
74115>>>>>>>        Local Integer iPartRev
74115>>>>>>>        Local Integer iCurrentPart
74115>>>>>>>        Local Integer iSeparatorPos
74115>>>>>>>
74115>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
74118>>>>>>>
74118>>>>>>>        Move 0 To iCurrentPart
74119>>>>>>>        Repeat
74119>>>>>>>>
74119>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
74120>>>>>>>            If (iSeparatorPos > 0) Begin
74122>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
74123>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
74124>>>>>>>                Increment iCurrentPart
74125>>>>>>>            End
74125>>>>>>>>
74125>>>>>>>            Else If (sRevision <> "") Begin
74128>>>>>>>                Move sRevision To iPartRev
74129>>>>>>>                Move "" To sRevision
74130>>>>>>>                Increment iCurrentPart
74131>>>>>>>            End
74131>>>>>>>>
74131>>>>>>>            Else ;                Move -1 To iPartRev
74133>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
74135>>>>>>>
74135>>>>>>>        Function_Return iPartRev
74136>>>>>>>    End_Function // EcxtractPartFromRevision
74137>>>>>>>
74137>>>>>>>
74137>>>>>>>
74137>>>>>>>    //***
74137>>>>>>>    //*** Function: CKMajorRevision
74137>>>>>>>    //*** Purpose : Returns the major revision of the CK
74137>>>>>>>    //***
74137>>>>>>>
74137>>>>>>>    Function CKMajorRevision Returns Integer
74139>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
74140>>>>>>>    End_Function // CKMajorRevision
74141>>>>>>>
74141>>>>>>>
74141>>>>>>>
74141>>>>>>>    //***
74141>>>>>>>    //*** Function: CKMinorRevision
74141>>>>>>>    //*** Purpose : Returns the minor revision of the CK
74141>>>>>>>    //***
74141>>>>>>>
74141>>>>>>>    Function CKMinorRevision Returns Integer
74143>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
74144>>>>>>>    End_Function // CKMinorRevision
74145>>>>>>>
74145>>>>>>>
74145>>>>>>>
74145>>>>>>>    //***
74145>>>>>>>    //*** Function: CKReleaseRevision
74145>>>>>>>    //*** Purpose : Returns the release revision of the CK
74145>>>>>>>    //***
74145>>>>>>>
74145>>>>>>>    Function CKReleaseRevision Returns Integer
74147>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
74148>>>>>>>    End_Function // CKReleaseRevision
74149>>>>>>>
74149>>>>>>>
74149>>>>>>>
74149>>>>>>>    //***
74149>>>>>>>    //*** Function: CKBuildRevision
74149>>>>>>>    //*** Purpose : Returns the major revision of the CK
74149>>>>>>>    //***
74149>>>>>>>
74149>>>>>>>    Function CKBuildRevision Returns Integer
74151>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
74152>>>>>>>    End_Function // CKBuildRevision
74153>>>>>>>
74153>>>>>>>
74153>>>>>>>
74153>>>>>>>    //***
74153>>>>>>>    //*** Function: IsMinimalRevision
74153>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
74153>>>>>>>    //***
74153>>>>>>>
74153>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
74155>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
74158>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
74161>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
74164>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
74167>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
74170>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
74174>>>>>>>            End
74174>>>>>>>>
74174>>>>>>>        End
74174>>>>>>>>
74174>>>>>>>
74174>>>>>>>        Function_Return (FALSE)
74175>>>>>>>    End_Function // IsMinimalRevision
74176>>>>>>>
74176>>>>>>>
74176>>>>>>>
74176>>>>>>>    //***
74176>>>>>>>    //*** Function: RegistrationName
74176>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
74176>>>>>>>    //***
74176>>>>>>>
74176>>>>>>>    Function RegistrationName Returns String
74178>>>>>>>        Local String  sRegistration
74178>>>>>>>        Local String  sDRiverId
74178>>>>>>>        Local String  sVoid
74178>>>>>>>        Local Integer iRetval
74178>>>>>>>
74178>>>>>>>        Get psDriverID To sDriverID
74179>>>>>>>        If (sDRiverID <> "") Begin
74181>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
74182>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
74187>>>>>>>        End
74187>>>>>>>>
74187>>>>>>>
74187>>>>>>>        Function_Return sRegistration
74188>>>>>>>    End_Function // RegistrationName
74189>>>>>>>
74189>>>>>>>
74189>>>>>>>
74189>>>>>>>    //***
74189>>>>>>>    //*** Function: SerialNumber
74189>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
74189>>>>>>>    //***
74189>>>>>>>
74189>>>>>>>    Function SerialNumber Returns Integer
74191>>>>>>>        Local String  sDRiverId
74191>>>>>>>        Local String  sVoid
74191>>>>>>>        Local Integer iRetval
74191>>>>>>>
74191>>>>>>>        Get psDriverID To sDriverID
74192>>>>>>>        If (sDRiverID <> "") Begin
74194>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
74199>>>>>>>        End
74199>>>>>>>>
74199>>>>>>>
74199>>>>>>>        Function_Return iRetval
74200>>>>>>>    End_Function // SerialNumber
74201>>>>>>>
74201>>>>>>>
74201>>>>>>>
74201>>>>>>>    //***
74201>>>>>>>    //*** Function: MaxUsers
74201>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
74201>>>>>>>    //***
74201>>>>>>>
74201>>>>>>>    Function MaxUsers Returns Integer
74203>>>>>>>        Local String  sDRiverId
74203>>>>>>>        Local String  sVoid
74203>>>>>>>        Local Integer iRetval
74203>>>>>>>
74203>>>>>>>        Get psDriverID To sDriverID
74204>>>>>>>        If (sDRiverID <> "") Begin
74206>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
74211>>>>>>>        End
74211>>>>>>>>
74211>>>>>>>
74211>>>>>>>        Function_Return iRetval
74212>>>>>>>    End_Function // MaxUsers
74213>>>>>>>
74213>>>>>>>
74213>>>>>>>
74213>>>>>>>    //***
74213>>>>>>>    //*** Procedure: DumpStatus
74213>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
74213>>>>>>>    //***
74213>>>>>>>
74213>>>>>>>    Procedure DumpStatus String sFileName
74215>>>>>>>        Local String  sVoid
74215>>>>>>>        Local String  sDriverID
74215>>>>>>>        Local Integer iVoid
74215>>>>>>>
74215>>>>>>>        Get psDriverID To sDriverID
74216>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
74223>>>>>>>    End_Procedure // DumpStatus
74224>>>>>>>
74224>>>>>>>
74224>>>>>>>
74224>>>>>>>    //***
74224>>>>>>>    //*** Procedure: ReadConfiguration
74224>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
74224>>>>>>>    //***            default value and then reread the configuration.
74224>>>>>>>    //***
74224>>>>>>>
74224>>>>>>>    Procedure ReadConfiguration
74226>>>>>>>        Local String  sVoid
74226>>>>>>>        Local String  sDriverID
74226>>>>>>>        Local Integer iVoid
74226>>>>>>>
74226>>>>>>>        Get psDriverID To sDriverID
74227>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
74234>>>>>>>    End_Procedure // ReadConfiguration
74235>>>>>>>
74235>>>>>>>
74235>>>>>>>
74235>>>>>>>    //***
74235>>>>>>>    //*** Function: TextToRIMValue
74235>>>>>>>    //*** Purpose : Convert a text to the corresponding
74235>>>>>>>    //***           Generate_Record_ID_Method attribute value
74235>>>>>>>    //***
74235>>>>>>>
74235>>>>>>>    Function TextToRIMValue String sText Returns Integer
74237>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
74240>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
74244>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
74248>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
74252>>>>>>>    End_Function // TextToRIMValue
74253>>>>>>>
74253>>>>>>>
74253>>>>>>>
74253>>>>>>>    //***
74253>>>>>>>    //*** Function: RIMValueTotext
74253>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
74253>>>>>>>    //***           corresponding text.
74253>>>>>>>    //***
74253>>>>>>>
74253>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
74255>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
74258>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
74262>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
74266>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
74270>>>>>>>    End_Function // RIMValueToText
74271>>>>>>>
74271>>>>>>>
74271>>>>>>>
74271>>>>>>>    //***
74271>>>>>>>    //*** Function: TextToROValue
74271>>>>>>>    //*** Purpose : Convert a text to the corresponding
74271>>>>>>>    //***           Generate_Record_ID_Method attribute value
74271>>>>>>>    //***
74271>>>>>>>
74271>>>>>>>    Function TextToROValue String sText Returns Integer
74273>>>>>>>        If (sText = "No") ;            Function_return RO_NO
74276>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
74280>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
74284>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
74288>>>>>>>    End_Function // TextToRIMValue
74289>>>>>>>
74289>>>>>>>
74289>>>>>>>
74289>>>>>>>    //***
74289>>>>>>>    //*** Function: ROValueTotext
74289>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
74289>>>>>>>    //***           corresponding text.
74289>>>>>>>    //***
74289>>>>>>>
74289>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
74291>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
74294>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
74298>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
74302>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
74306>>>>>>>    End_Function // RIMValueToText
74307>>>>>>>
74307>>>>>>>
74307>>>>>>>
74307>>>>>>>    //***
74307>>>>>>>    //*** Function: LastDriverError
74307>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
74307>>>>>>>    //***
74307>>>>>>>
74307>>>>>>>    Function LastDriverError Returns String
74309>>>>>>>        Local String  sDriverID
74309>>>>>>>        Local String  sLastError
74309>>>>>>>        Local String  sLastErrorLength
74309>>>>>>>        Local Integer iLastErrorLength
74309>>>>>>>        Local Integer iVoid
74309>>>>>>>
74309>>>>>>>        //*** Initialize
74309>>>>>>>        Move "" To sLastError
74310>>>>>>>
74310>>>>>>>        Get psDriverID To sDriverID
74311>>>>>>>        If (sDriverID <> "") Begin
74313>>>>>>>            //*** Get the text of the last error
74313>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
74314>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
74319>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
74320>>>>>>>
74320>>>>>>>            If (iLastErrorLength > 0) Begin
74322>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
74323>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
74328>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
74329>>>>>>>            End
74329>>>>>>>>
74329>>>>>>>        End
74329>>>>>>>>
74329>>>>>>>
74329>>>>>>>        Function_Return sLastError
74330>>>>>>>    End_Function // LastDriverError
74331>>>>>>>
74331>>>>>>>
74331>>>>>>>
74331>>>>>>>    //***
74331>>>>>>>    //*** Function: EnumerateTables
74331>>>>>>>    //*** Purpose : Enumerate the tables in a database
74331>>>>>>>    //***
74331>>>>>>>
74331>>>>>>>    Function EnumerateTables String sLogin Returns Integer
74333>>>>>>>        Local String  sDriver
74333>>>>>>>        Local String  sVoid
74333>>>>>>>        Local Integer iNumTables
74333>>>>>>>        Local Integer iVoid
74333>>>>>>>
74333>>>>>>>        Get psDriverID To sDriver
74334>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
74341>>>>>>>
74341>>>>>>>        Function_Return iNumTables
74342>>>>>>>    End_Function // EnumerateTables
74343>>>>>>>
74343>>>>>>>
74343>>>>>>>
74343>>>>>>>    //***
74343>>>>>>>    //*** Function: TableName
74343>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
74343>>>>>>>    //***
74343>>>>>>>
74343>>>>>>>    Function TableName Integer iIndex Returns String
74345>>>>>>>        Local String  sDriver
74345>>>>>>>        Local String  sTableName
74345>>>>>>>        Local String  sVoid
74345>>>>>>>        Local Integer iVoid
74345>>>>>>>
74345>>>>>>>        Get psDriverID To sDriver
74346>>>>>>>        If (sDriver <> "") Begin
74348>>>>>>>            Move (Repeat(" ", 255)) To sTableName
74349>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
74354>>>>>>>        End
74354>>>>>>>>
74354>>>>>>>
74354>>>>>>>        Function_Return sTableName
74355>>>>>>>    End_Function // TableName
74356>>>>>>>
74356>>>>>>>
74356>>>>>>>
74356>>>>>>>    //***
74356>>>>>>>    //*** Function: SchemaName
74356>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
74356>>>>>>>    //***
74356>>>>>>>
74356>>>>>>>    Function SchemaName Integer iIndex Returns String
74358>>>>>>>        Local String  sDriver
74358>>>>>>>        Local String  sSchemaName
74358>>>>>>>        Local String  sVoid
74358>>>>>>>        Local Integer iVoid
74358>>>>>>>
74358>>>>>>>        Get psDriverID To sDriver
74359>>>>>>>        If (sDriver <> "") Begin
74361>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
74362>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
74367>>>>>>>        End
74367>>>>>>>>
74367>>>>>>>
74367>>>>>>>        Function_Return sSchemaName
74368>>>>>>>    End_Function // SchemaName
74369>>>>>>>
74369>>>>>>>
74369>>>>>>>
74369>>>>>>>    //***
74369>>>>>>>    //*** Function: TableType
74369>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
74369>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
74369>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
74369>>>>>>>    //***
74369>>>>>>>
74369>>>>>>>    Function TableType Integer iIndex Returns String
74371>>>>>>>        Local String  sDriver
74371>>>>>>>        Local String  sTableType
74371>>>>>>>        Local String  sVoid
74371>>>>>>>        Local Integer iVoid
74371>>>>>>>
74371>>>>>>>        Get psDriverID To sDriver
74372>>>>>>>        If (sDriver <> "") Begin
74374>>>>>>>            Move (Repeat(" ", 25)) To sTableType
74375>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
74380>>>>>>>        End
74380>>>>>>>>
74380>>>>>>>
74380>>>>>>>        Function_Return sTableType
74381>>>>>>>    End_Function // TableType
74382>>>>>>>
74382>>>>>>>
74382>>>>>>>
74382>>>>>>>    //***
74382>>>>>>>    //*** Function: TableComment
74382>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
74382>>>>>>>    //***
74382>>>>>>>
74382>>>>>>>    Function TableComment Integer iIndex Returns String
74384>>>>>>>        Local String  sDriver
74384>>>>>>>        Local String  sTableComment
74384>>>>>>>        Local String  sVoid
74384>>>>>>>        Local Integer iVoid
74384>>>>>>>
74384>>>>>>>        Get psDriverID To sDriver
74385>>>>>>>        If (sDriver <> "") Begin
74387>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
74388>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
74393>>>>>>>        End
74393>>>>>>>>
74393>>>>>>>
74393>>>>>>>        Function_Return sTableComment
74394>>>>>>>    End_Function // TableComment
74395>>>>>>>
74395>>>>>>>
74395>>>>>>>
74395>>>>>>>    //***
74395>>>>>>>    //*** Function: EnumerateColumns
74395>>>>>>>    //*** Purpose : Enumerate the columns in a table
74395>>>>>>>    //***
74395>>>>>>>
74395>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
74397>>>>>>>        Local String  sDriver
74397>>>>>>>        Local Integer iNumColumns
74397>>>>>>>        Local Integer iVoid
74397>>>>>>>
74397>>>>>>>        Get psDriverID To sDriver
74398>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
74405>>>>>>>
74405>>>>>>>        Function_Return iNumColumns
74406>>>>>>>    End_Function // EnumerateColumns
74407>>>>>>>
74407>>>>>>>
74407>>>>>>>
74407>>>>>>>    //***
74407>>>>>>>    //*** Function: ColumnName
74407>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
74407>>>>>>>    //***
74407>>>>>>>
74407>>>>>>>    Function ColumnName Integer iIndex Returns String
74409>>>>>>>        Local String  sDriver
74409>>>>>>>        Local String  sColumnName
74409>>>>>>>        Local String  sVoid
74409>>>>>>>        Local Integer iVoid
74409>>>>>>>
74409>>>>>>>        Get psDriverID To sDriver
74410>>>>>>>        If (sDriver <> "") Begin
74412>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
74413>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
74418>>>>>>>        End
74418>>>>>>>>
74418>>>>>>>
74418>>>>>>>        Function_Return sColumnName
74419>>>>>>>    End_Function // ColumnName
74420>>>>>>>
74420>>>>>>>
74420>>>>>>>
74420>>>>>>>    //***
74420>>>>>>>    //*** Function: CLIDFDateToSQLDate
74420>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
74420>>>>>>>    //***
74420>>>>>>>
74420>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
74422>>>>>>>        Local String sSQLDate
74422>>>>>>>        Local Integer iOrgDateFmt
74422>>>>>>>        Local Integer iOrgDateSep
74422>>>>>>>
74422>>>>>>>        //*** Change date format to military, SQL dates are military dates
74422>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
74425>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
74428>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
74431>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
74434>>>>>>>
74434>>>>>>>        //*** We only need to convert if the date is 0
74434>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
74443>>>>>>>        Else ;            Move dDFDate To sSQLDate
74445>>>>>>>
74445>>>>>>>        //*** Change date format back to original
74445>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
74448>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
74451>>>>>>>
74451>>>>>>>        Function_Return sSQLDate
74452>>>>>>>    End_Function // CLIDFDateToSQLDate
74453>>>>>>>
74453>>>>>>>
74453>>>>>>>
74453>>>>>>>    //***
74453>>>>>>>    //*** Function: CLISQLDateToDFDate
74453>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
74453>>>>>>>    //***
74453>>>>>>>
74453>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
74455>>>>>>>        Local Date dDFDate
74455>>>>>>>        Local String sDummyDateValue
74455>>>>>>>        Local Integer iOrgDateFmt
74455>>>>>>>        Local Integer iOrgDateSep
74455>>>>>>>
74455>>>>>>>        //*** Change date format to military, SQL dates are military dates
74455>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
74458>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
74461>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
74464>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
74467>>>>>>>
74467>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
74467>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
74474>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
74477>>>>>>>        Else ;            Move sSQLDate To dDFDate
74479>>>>>>>
74479>>>>>>>        //*** Change date format back to original
74479>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
74482>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
74485>>>>>>>
74485>>>>>>>        Function_Return dDFDate
74486>>>>>>>    End_Function // CLISQLDateToDFDate
74487>>>>>>>
74487>>>>>>>
74487>>>>>>>
74487>>>>>>>    //***
74487>>>>>>>    //*** Function: RedirectConnection
74487>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
74487>>>>>>>    //***           will point to another database but all tables will stay
74487>>>>>>>    //***           open!
74487>>>>>>>    //***
74487>>>>>>>
74487>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
74489>>>>>>>        Local String  sDriver
74489>>>>>>>        Local String  sVoid
74489>>>>>>>        Local Integer iResult
74489>>>>>>>        Local Integer iVoid
74489>>>>>>>
74489>>>>>>>        Get psDriverID To sDriver
74490>>>>>>>        If (sDriver <> "") Begin
74492>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
74497>>>>>>>        End
74497>>>>>>>>
74497>>>>>>>        Function_Return iResult
74498>>>>>>>    End_Function // RedirectConnect
74499>>>>>>>
74499>>>>>>>
74499>>>>>>>
74499>>>>>>>    //***
74499>>>>>>>    //*** Function: CreateConnectionID
74499>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
74499>>>>>>>    //***
74499>>>>>>>
74499>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
74501>>>>>>>        Local String  sDriver
74501>>>>>>>        Local Integer iResult
74501>>>>>>>        Local Integer iOptions
74501>>>>>>>
74501>>>>>>>        Get psDriverID to sDriver
74502>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
74505>>>>>>>        Else ;            Move iOpt to iOptions
74507>>>>>>>        If (sDriver <> "") Begin
74509>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
74514>>>>>>>        End
74514>>>>>>>>
74514>>>>>>>        Function_Return iResult
74515>>>>>>>    End_Function // CreateConnectionID
74516>>>>>>>
74516>>>>>>>
74516>>>>>>>
74516>>>>>>>    //***
74516>>>>>>>    //*** Function: DeleteConnectionID
74516>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
74516>>>>>>>    //***
74516>>>>>>>
74516>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
74518>>>>>>>        Local String  sDriver
74518>>>>>>>        Local Integer iResult
74518>>>>>>>        Local String sVoid
74518>>>>>>>
74518>>>>>>>        Get psDriverID To sDriver
74519>>>>>>>        If (sDriver <> "") Begin
74521>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
74526>>>>>>>        End
74526>>>>>>>>
74526>>>>>>>        Function_Return iResult
74527>>>>>>>    End_Function // DeleteConnectionID
74528>>>>>>>
74528>>>>>>>End_Class // cCLIHandler
74529>>>>>
74529>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
74530>>>>>
74530>>>>>Register_Function phoWorkspace Returns Handle
74530>>>>>Register_Function Help_filename Returns String
74530>>>>>Register_Function GetHelpFile Returns String
74530>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
74530>>>>>
74530>>>>>//****************************************************************************
74530>>>>>// $Module type: FUNCTION
74530>>>>>// $Module name: Network_User_Name
74530>>>>>// $Author     : AK/VOO/KCR
74530>>>>>// Created     : 09-24-96 @ 19:17
74530>>>>>//
74530>>>>>// Description
74530>>>>>//    This function reads the current username Of windows and returns that
74530>>>>>//    name or an text unknown user
74530>>>>>//
74530>>>>>// $Rev History
74530>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
74530>>>>>//  07/25/2003  Replaced obsolete code
74530>>>>>//  09/24/1996  Module header created
74530>>>>>//****************************************************************************
74530>>>>>Function Network_User_Name for cDesktop Returns String
74532>>>>>    String sName
74532>>>>>    Integer iRetval iLength
74532>>>>>
74532>>>>>    Move 0 to iLength
74533>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
74534>>>>>    ZeroString iLength to sName
74535>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
74536>>>>>
74536>>>>>    If (iRetval = NO_ERROR) Begin
74538>>>>>        Function_Return (CString (sName))
74539>>>>>    End
74539>>>>>>
74539>>>>>    
74539>>>>>    Function_Return "User Unknown"
74540>>>>>End_Function
74541>>>>>
74541>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
74541>>>>>Type MEMORYSTATUS
74541>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
74541>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
74541>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
74541>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
74541>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
74541>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
74541>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
74541>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
74541>>>>>End_Type // MEMORYSTATUS
74541>>>>>
74541>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
74542>>>>>
74542>>>>>Struct tWinMemoryStatusEx
74542>>>>>    UInteger dwLength                
74542>>>>>    UInteger dwMemoryLoad          
74542>>>>>    UBigInt ullTotalPhys           
74542>>>>>    UBigInt ullAvailPhys           
74542>>>>>    UBigInt ullTotalPageFile       
74542>>>>>    UBigInt ullAvailPageFile       
74542>>>>>    UBigInt ullTotalVirtual        
74542>>>>>    UBigInt ullAvailVirtual        
74542>>>>>    UBigInt ullAvailExtendedVirtual
74542>>>>>End_Struct
74542>>>>>
74542>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
74543>>>>>
74543>>>>>Class SysinfoDisplay is a cTextEdit
74544>>>>>    Procedure Construct_Object
74546>>>>>        Forward Send Construct_Object
74548>>>>>
74548>>>>>        Set Location To 6 6
74549>>>>>        Set Size To 110 255
74550>>>>>        Set Read_Only_State To True
74551>>>>>        Set pbWrap to False
74552>>>>>    End_Procedure
74553>>>>>
74553>>>>>    //****************************************************************************
74553>>>>>    // $Module type: PROCEDURE
74553>>>>>    // $Module name: Show_Current_Directory
74553>>>>>    // $Author     : VOO
74553>>>>>    // Created     : 06-10-96 @ 15:24
74553>>>>>    //
74553>>>>>    // Description
74553>>>>>    //    This method will show the name Of the current directory in the system
74553>>>>>    //    information box
74553>>>>>    //
74553>>>>>    // $Rev History
74553>>>>>    //    06-10-96  Module header created
74553>>>>>    //****************************************************************************
74553>>>>>    Procedure Show_Current_Directory
74555>>>>>        String sDir
74555>>>>>
74555>>>>>        Get_Current_Directory To sDir
74556>>>>>
74556>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
74557>>>>>    End_Procedure
74558>>>>>
74558>>>>>    Procedure Show_Windows_Directory
74560>>>>>        String sWindir
74560>>>>>
74560>>>>>        Get_Windows_Directory To sWindir
74561>>>>>
74561>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
74562>>>>>    End_Procedure
74563>>>>>
74563>>>>>    Procedure Show_Current_User
74565>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
74566>>>>>    End_Procedure
74567>>>>>
74567>>>>>    Procedure Show_Number_Format
74569>>>>>        Integer iFormat
74569>>>>>        String sFormatText
74569>>>>>
74569>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
74572>>>>>        Move (Character (iFormat)) To sFormatText
74573>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
74574>>>>>
74574>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
74577>>>>>        Move (Character (iFormat)) to sFormatText
74578>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
74579>>>>>    End_Procedure
74580>>>>>
74580>>>>>    Procedure Show_Filelist_Name
74582>>>>>        String sFilename
74582>>>>>
74582>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
74585>>>>>
74585>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
74586>>>>>    End_Procedure
74587>>>>>
74587>>>>>    Procedure Show_Lock_Delay
74589>>>>>        Integer iLockdelay
74589>>>>>
74589>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
74592>>>>>
74592>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
74593>>>>>    End_Procedure
74594>>>>>
74594>>>>>    Procedure Show_Lock_Timeout
74596>>>>>        Integer iLockTimeout
74596>>>>>
74596>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
74599>>>>>
74599>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
74600>>>>>    End_Procedure
74601>>>>>
74601>>>>>    Procedure Show_Screen_Size
74603>>>>>        Integer iYscreensize iXscreensize
74603>>>>>
74603>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
74604>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
74605>>>>>
74605>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
74606>>>>>    End_Procedure
74607>>>>>
74607>>>>>    Procedure Show_Page_Size
74609>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
74610>>>>>    End_procedure
74611>>>>>
74611>>>>>    Procedure Show_Date
74613>>>>>        Date dToday
74613>>>>>
74613>>>>>        Sysdate dToday
74614>>>>>
74614>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
74615>>>>>    End_procedure
74616>>>>>
74616>>>>>    Procedure Show_Date_Format
74618>>>>>        Integer iDateFormat
74618>>>>>        String sDateFormat
74618>>>>>
74618>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
74621>>>>>        Case Begin
74621>>>>>            Case (iDateFormat = DF_DATE_USA)
74623>>>>>                Move C_$USA To sDateFormat
74624>>>>>                Case Break
74625>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
74628>>>>>                Move C_$European To sDateFormat
74629>>>>>                Case Break
74630>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
74633>>>>>                Move C_$Military To sDateFormat
74634>>>>>                Case Break
74635>>>>>            Case Else
74635>>>>>                Move C_$UnknownDateType To sDateFormat
74636>>>>>                Case Break
74637>>>>>        Case End
74637>>>>>
74637>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
74638>>>>>    End_Procedure
74639>>>>>
74639>>>>>    Procedure Show_Systemresources
74641>>>>>        tWinMemoryStatusEx MemoryStatusInfo
74641>>>>>        tWinMemoryStatusEx MemoryStatusInfo
74641>>>>>        Integer iRetval
74641>>>>>
74641>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
74642>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
74643>>>>>        If (iRetval = 0) Begin
74645>>>>>            Move (ShowLastError ()) to iRetval
74646>>>>>        End
74646>>>>>>
74646>>>>>
74646>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
74647>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
74648>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
74649>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
74650>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
74651>>>>>    End_Procedure
74652>>>>>
74652>>>>>    Procedure Show_Registration
74654>>>>>        String sRegName
74654>>>>>        Integer iSN iMaxUsers
74654>>>>>
74654>>>>>        Registration sRegName iSN
74655>>>>>>
74655>>>>>        
74655>>>>>        Get_Licensed_Max_Users to iMaxUsers
74656>>>>>
74656>>>>>        Send AppendTextLn ""
74657>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
74658>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
74659>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
74660>>>>>    End_Procedure
74661>>>>>
74661>>>>>    //****************************************************************************
74661>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
74661>>>>>    // To the workspace object passing the an object and message To send back
74661>>>>>    // To this object. It is expected that the workspace object will send this
74661>>>>>    // message for every line Of information it wants displayed (passing the
74661>>>>>    // information To be displayed
74661>>>>>    //****************************************************************************
74661>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
74661>>>>>
74661>>>>>    Procedure Show_ServicePack
74663>>>>>        String sKey sVersionDescription sVersion 
74663>>>>>        Handle hoRegistry
74663>>>>>        Boolean bExists bOpened
74663>>>>>        
74663>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
74664>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
74665>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
74666>>>>>
74666>>>>>        Move ("SOFTWARE\Data Access Worldwide\Visual DataFlex\" + SysConf (SYSCONF_DATAFLEX_REV)) to sKey
74667>>>>>        Get KeyExists of hoRegistry sKey to bExists
74668>>>>>        If (bExists) Begin
74670>>>>>            Get OpenKey of hoRegistry sKey to bOpened
74671>>>>>            If (bOpened) Begin
74673>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
74674>>>>>                If (bExists) Begin
74676>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
74677>>>>>                End
74677>>>>>>
74677>>>>>                
74677>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
74678>>>>>                If (bExists) Begin
74680>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
74681>>>>>                End                
74681>>>>>>
74681>>>>>                Send CloseKey of hoRegistry
74682>>>>>            End
74682>>>>>>
74682>>>>>        End
74682>>>>>>
74682>>>>>        Send Destroy of hoRegistry
74683>>>>>
74683>>>>>        If (sVersionDescription <> "") Begin
74685>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
74686>>>>>           Send AppendTextLn ""
74687>>>>>        End
74687>>>>>>
74687>>>>>    End_Procedure
74688>>>>>
74688>>>>>    Procedure Show_WorkspaceInformation
74690>>>>>        Integer hoWorkspace
74690>>>>>
74690>>>>>        If (ghoApplication <> 0) Begin
74692>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
74693>>>>>            If (hoWorkspace <> 0) Begin
74695>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
74696>>>>>            End
74696>>>>>>
74696>>>>>        End
74696>>>>>>
74696>>>>>    End_Procedure
74697>>>>>
74697>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
74699>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
74700>>>>>    End_Function
74701>>>>>
74701>>>>>    Procedure Show_Versions
74703>>>>>        Integer iVersion iRevision iBuild
74703>>>>>
74703>>>>>        Version_information iVersion iRevision iBuild
74705>>>>>
74705>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
74706>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
74707>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
74708>>>>>    End_Procedure
74709>>>>>    
74709>>>>>    Function CKRevisionNumber String sDriverID Returns String
74711>>>>>        Handle hoCLIHandler
74711>>>>>        String sCKRevision
74711>>>>>    
74711>>>>>        Get Create (RefClass(cCLIHandler)) to hoCLIHandler
74712>>>>>        Set psDriverID of hoCLIHandler to sDriverID
74713>>>>>        Move (CKRevision(hoCLIHandler)) to sCKRevision
74714>>>>>        Send Destroy of hoCLIHandler
74715>>>>>        
74715>>>>>        Function_Return sCKRevision
74716>>>>>    End_Function
74717>>>>>    
74717>>>>>    
74717>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
74719>>>>>        
74719>>>>>        If (sDriverID = "DATAFLEX") Begin
74721>>>>>            Function_Return False
74722>>>>>        End
74722>>>>>>
74722>>>>>    
74722>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
74723>>>>>    End_Function    
74724>>>>>
74724>>>>>
74724>>>>>    //***
74724>>>>>    //*** BW
74724>>>>>    //*** Procedure: Show_Drivers
74724>>>>>    //*** Purpose  : Show loaded database drivers
74724>>>>>    //***
74724>>>>>
74724>>>>>    Procedure Show_Drivers
74726>>>>>        String sCurrentDriver sRevNumber
74726>>>>>        String sLoadedDrivers
74726>>>>>        Integer iNumberOfDrivers iCount
74726>>>>>        Boolean bOK
74726>>>>>
74726>>>>>        Move "" To sLoadedDrivers
74727>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
74730>>>>>        For iCount From 1 To iNumberOfDrivers
74736>>>>>>
74736>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
74739>>>>>            If (sLoadedDrivers <> "") Begin
74741>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
74742>>>>>            End
74742>>>>>>
74742>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
74743>>>>>            If (bOK) Begin
74745>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
74746>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
74747>>>>>            End
74747>>>>>>
74747>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
74748>>>>>        Loop
74749>>>>>>
74749>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
74750>>>>>    End_Procedure
74751>>>>>
74751>>>>>    Procedure Show_HelpFile
74753>>>>>        String sHelpFile
74753>>>>>        Integer eHelpType
74753>>>>>
74753>>>>>        If (ghoApplication <> 0) Begin
74755>>>>>            Get peHelpType Of ghoApplication To eHelpType
74756>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
74758>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
74759>>>>>            End
74759>>>>>>
74759>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
74762>>>>>                Get Help_filename Of Help_object_id To sHelpFile
74763>>>>>            End
74763>>>>>>
74763>>>>>            Else Begin
74764>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
74765>>>>>            End
74765>>>>>>
74765>>>>>
74765>>>>>            Send AppendTextLn ""
74766>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
74767>>>>>        End
74767>>>>>>
74767>>>>>    End_Procedure
74768>>>>>
74768>>>>>    Procedure Show_EnterAsTab
74770>>>>>        Boolean bEnterKeyAsTabKey
74770>>>>>        String sText
74770>>>>>
74770>>>>>        If (ghoApplication <> 0) Begin
74772>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
74773>>>>>            If (bEnterKeyAsTabKey) Begin
74775>>>>>                Move "True" To sText
74776>>>>>            End
74776>>>>>>
74776>>>>>            Else Begin
74777>>>>>                Move "False" To sText
74778>>>>>            End
74778>>>>>>
74778>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
74779>>>>>        End
74779>>>>>>
74779>>>>>    End_Procedure
74780>>>>>
74780>>>>>    //****************************************************************************
74780>>>>>    // $Module type: PROCEDURE
74780>>>>>    // $Module name: Add_Focus
74780>>>>>    // $Author     : VOO
74780>>>>>    // Created     : 24-09-96 @ 19:43
74780>>>>>    //
74780>>>>>    // Description
74780>>>>>    //    During activation we will remove the old information and add the newly
74780>>>>>    //    found systeminformation
74780>>>>>    //
74780>>>>>    // $Rev History
74780>>>>>    //    24-09-96  Module header created
74780>>>>>    //****************************************************************************
74780>>>>>    Procedure Add_Focus Integer hoRoot
74782>>>>>        Forward Send Add_Focus hoRoot
74784>>>>>
74784>>>>>        Send Delete_Data
74785>>>>>
74785>>>>>        Set Changed_State To False
74786>>>>>        Set Read_Only_State To True
74787>>>>>
74787>>>>>        Send Show_ServicePack
74788>>>>>        If (ghoApplication <> 0) Begin
74790>>>>>            Send Show_WorkSpaceInformation // added To show WS info
74791>>>>>            Send Show_HelpFile
74792>>>>>            Send Show_EnterAsTab
74793>>>>>        End
74793>>>>>>
74793>>>>>        Send Show_Drivers
74794>>>>>        Send Show_Current_User
74795>>>>>        Send Show_Windows_Directory
74796>>>>>        Send Show_Current_Directory
74797>>>>>        Send Show_Filelist_Name
74798>>>>>        Send Show_Versions
74799>>>>>        Send Show_Screen_Size
74800>>>>>        Send Show_Page_Size
74801>>>>>        Send Show_Number_Format
74802>>>>>        Send Show_Date_Format
74803>>>>>        Send Show_Lock_Delay
74804>>>>>        Send Show_Lock_Timeout
74805>>>>>        Send Show_Date
74806>>>>>        Send Show_Systemresources
74807>>>>>        Send Show_Registration
74808>>>>>        Send Beginning_of_Data
74809>>>>>
74809>>>>>        Set Icon to 'default.ico'
74810>>>>>    End_Procedure
74811>>>>>End_Class
74812>>>>>
74812>>>>>//****************************************************************************
74812>>>>>// $Module type: OBJECT
74812>>>>>// $Module name: Sysinfo_Dialog
74812>>>>>// $Author     : VOO
74812>>>>>// Created     : 24-09-96 @ 18:47
74812>>>>>//
74812>>>>>// Description
74812>>>>>//    This object shows the systeminformation on the screen
74812>>>>>//
74812>>>>>// $Rev History
74812>>>>>//    24-09-96  Module header created
74812>>>>>//****************************************************************************
74812>>>>>Class SysInfoDialog Is A ModalPanel
74813>>>>>    Procedure Construct_Object
74815>>>>>        Forward Send Construct_Object
74817>>>>>
74817>>>>>        Set Label to C_$SystemInformation
74818>>>>>        Set Size to 140 267
74819>>>>>        Set piMinSize to 140 267
74820>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
74821>>>>>        Set Border_Style to Border_Thick
74822>>>>>
74822>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
74824>>>>>            Set peAnchors to anAll
74825>>>>>        End_Object
74826>>>>>
74826>>>>>        Object oCloseButton Is A Button
74828>>>>>            Set Label To C_$Close
74829>>>>>            Set Location To 120 210
74830>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
74831>>>>>            Set Default_State To True
74832>>>>>            Set peAnchors to anBottomRight
74833>>>>>        End_Object
74834>>>>>
74834>>>>>        On_Key kCancel Send Close_Panel
74835>>>>>    End_Procedure
74836>>>>>End_Class
74837>>>>>
74837>>>>>// Purpose:
74837>>>>>//
74837>>>>>// Ken Ross 12/17/96 5:16PM
74837>>>>>//
74837>>>>>Class AboutDialog Is A ModalPanel
74838>>>>>    Procedure Construct_Object
74840>>>>>        String sVdfRootDir
74840>>>>>
74840>>>>>        Forward Send Construct_Object
74842>>>>>
74842>>>>>        Set Label To C_$About
74843>>>>>        Set Size to 89 212
74844>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
74845>>>>>
74845>>>>>        Object oSysInfoDialog Is A SysInfoDialog
74847>>>>>        End_Object
74848>>>>>
74848>>>>>        Object oBox Is A Container3d
74850>>>>>            Set Border_Style To Border_StaticEdge
74851>>>>>            Set Size to 63 202
74852>>>>>            Set Location To 4 5
74853>>>>>
74853>>>>>            Object oAboutGraphic Is A BitmapContainer
74855>>>>>                Set Border_Style To Border_None
74856>>>>>                Set Bitmap_Style To Bitmap_Center
74857>>>>>                Set Size To 48 48
74858>>>>>                Set Location To 7 2
74859>>>>>            End_Object
74860>>>>>
74860>>>>>            Object oProductName Is A TextBox
74862>>>>>                Set Label To C_$ProductName
74863>>>>>                Set Size To 10 45
74864>>>>>                Set Location To 8 53
74865>>>>>            End_Object
74866>>>>>
74866>>>>>            Object oVersion Is A TextBox
74868>>>>>                Set Label To C_$Version
74869>>>>>                Set Size To 10 25
74870>>>>>                Set Location To 21 53
74871>>>>>            End_Object
74872>>>>>
74872>>>>>            Object oCopyright Is A TextBox
74874>>>>>                Set Label To C_$Copyright
74875>>>>>                Set Size To 10 31
74876>>>>>                Set Location To 34 53
74877>>>>>            End_Object
74878>>>>>
74878>>>>>            Object oAuthor Is A TextBox
74880>>>>>                Set Label To C_$Author
74881>>>>>                Set Size To 10 22
74882>>>>>                Set Location To 46 53
74883>>>>>            End_Object
74884>>>>>        End_Object
74885>>>>>
74885>>>>>        Object oOKButton Is A Button
74887>>>>>            On_Item C_$OK Send Close_Panel
74888>>>>>            Set Size To 14 50
74889>>>>>            Set Location To 71 157
74890>>>>>        End_Object
74891>>>>>
74891>>>>>        Object oSysInfoButton Is A Button
74893>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
74894>>>>>            Set Size To 14 50
74895>>>>>            Set Location To 71 101
74896>>>>>        End_Object
74897>>>>>
74897>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
74898>>>>>
74898>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
74899>>>>>    End_Procedure
74900>>>>>
74900>>>>>    Procedure Set ProductName String sProductName
74902>>>>>        Set Label Of oProductName To sProductName
74903>>>>>    End_Procedure
74904>>>>>
74904>>>>>    Procedure Set Version String sVersion
74906>>>>>        Set Label Of oVersion To sVersion
74907>>>>>    End_Procedure
74908>>>>>
74908>>>>>    Procedure Set Copyright string sCopyright
74910>>>>>        Set Label Of oCopyright To sCopyright
74911>>>>>    End_Procedure
74912>>>>>
74912>>>>>    Procedure Set Author String sAuthor
74914>>>>>        Set Label Of oAuthor To sAuthor
74915>>>>>    End_Procedure
74916>>>>>
74916>>>>>    Procedure Set Logo string sLogo
74918>>>>>        // square bitmaps Of 42x42 work best
74918>>>>>        Set Bitmap Of oAboutGraphic To sLogo
74919>>>>>    End_Procedure
74920>>>>>
74920>>>>>    Procedure Show_Sysinfo
74922>>>>>        Send Popup_Modal Of oSysinfoDialog
74923>>>>>    End_Procedure
74924>>>>>
74924>>>>>    Procedure End_Construct_Object
74926>>>>>        Handle hoVersionInfo
74926>>>>>        Boolean bIncluded
74926>>>>>        Integer iMajor iMinor iRelease iBuild
74926>>>>>        String sLabel
74926>>>>>
74926>>>>>        Get Label Of oVersion To sLabel
74927>>>>>        If (sLabel = C_$VERSION) Begin
74929>>>>>            // set it To the version info Of the program, if available
74929>>>>>            If (ghoApplication <> 0) Begin
74931>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
74932>>>>>                If (hoVersionInfo <> 0) Begin
74934>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
74935>>>>>                    If (bIncluded) Begin
74937>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
74938>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
74939>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
74940>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
74941>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
74942>>>>>                        Set Version to sLabel
74943>>>>>                    End
74943>>>>>>
74943>>>>>                End
74943>>>>>>
74943>>>>>            End
74943>>>>>>
74943>>>>>        End
74943>>>>>>
74943>>>>>
74943>>>>>        Forward Send End_Construct_Object
74945>>>>>    End_Procedure
74946>>>>>End_Class
74947>>>
74947>>>// *************************************************************************
74947>>>//  Public message. This is the default message. It is expected that you will
74947>>>//   create your own message to override this
74947>>>// *************************************************************************
74947>>>
74947>>>Procedure Activate_About
74950>>>   Send DoAbout "" "" "" "" ""
74951>>>End_Procedure
74952>>>
74952>>>// *************************************************************************
74952>>>//  Public message. It is expected that you will send this message (most
74952>>>//  likely from Activate_About. This creates an about object, activates it
74952>>>//  and destroys it when done. It is not exepected that you will augment this.
74952>>>// *************************************************************************
74952>>>
74952>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
74955>>>        integer hoObj hoMain
74955>>>
74955>>>        // create object
74955>>>        Object About is an AboutDialog
74957>>>            // if no title passed use the label of the main panel
74957>>>            // (if a main panel exists).
74957>>>            if sTitle     eq '' Begin
74959>>>                Get Main_Window of desktop to hoMain
74960>>>                if hoMain Get Label of hoMain to sTitle
74963>>>            end
74963>>>>
74963>>>            set productname to sTitle
74964>>>            set version     to sVersion
74965>>>            set copyright   to sCopyRight
74966>>>            set author      to sAuthor
74967>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
74970>>>            Move self to hoObj // object Id
74971>>>        End_Object
74972>>>        Send Popup   of hoObj    // popup the about object
74973>>>        Send Destroy of hoObj // when done, it will be destroyed
74974>>>End_procedure
74975>        Use SoforEntry.vw
Including file: SoforEntry.vw    (C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\SoforEntry.vw)
74975>>>// C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\SoforEntry.vw
74975>>>// SoforEntry
74975>>>//
74975>>>
74975>>>Use DFClient.pkg
74975>>>Use DFEntry.pkg
74975>>>
74975>>>Use cSoforDataDictionary.dd
Including file: cSoforDataDictionary.dd    (C:\Visual DataFlex Projects\Szallitmanyozas\DDSrc\cSoforDataDictionary.dd)
74975>>>>>Use DataDict.pkg
74975>>>>>
74975>>>>>Open Sofor
Including file: Sofor.fd    (C:\Visual DataFlex Projects\Szallitmanyozas\DDSrc\Sofor.fd)
74977>>>>>Open Fuvarlevel
Including file: Fuvarlevel.fd    (C:\Visual DataFlex Projects\Szallitmanyozas\DDSrc\Fuvarlevel.fd)
74979>>>>>Open system
Including file: system.fd    (C:\Visual DataFlex Projects\Szallitmanyozas\DDSrc\system.fd)
74981>>>>>
74981>>>>>Register_Object Sofor_sl
74981>>>>>
74981>>>>>Class cSoforDataDictionary is a DataDictionary
74982>>>>>    
74982>>>>>    Procedure Construct_Object
74984>>>>>        Forward Send Construct_Object
74986>>>>>        Set Main_File to Sofor.File_Number
74987>>>>>
74987>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
74988>>>>>
74988>>>>>        Set Add_Client_File to Fuvarlevel.File_Number
74989>>>>>
74989>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
74990>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
74991>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
74992>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
74993>>>>>
74993>>>>>        Set Field_Auto_Increment Field Sofor.Azonosito to File_Field system.Last_Sofor
74994>>>>>        Set Field_Label_Long Field Sofor.Azonosito to "Sofor azonostja"
74995>>>>>        Set Field_Label_Short Field Sofor.Azonosito to "Azonost"
74996>>>>>        Set Field_Prompt_Object Field Sofor.Azonosito to Sofor_sl
74997>>>>>
74997>>>>>        Set Field_Label_Long Field Sofor.Nev to "Sofor neve"
74998>>>>>        Set Field_Label_Short Field Sofor.Nev to "Nv"
74999>>>>>        Set Field_Prompt_Object Field Sofor.Nev to Sofor_sl
75000>>>>>
75000>>>>>    End_Procedure
75001>>>>>
75001>>>>>End_Class
75002>>>>>
75002>>>>>Use Sofor.sl
Including file: Sofor.sl    (C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\Sofor.sl)
75002>>>>>>>// Sofor.sl
75002>>>>>>>// Sofor Lookup List
75002>>>>>>>
75002>>>>>>>Use DFClient.pkg
75002>>>>>>>Use cDbCJGridPromptList.pkg
75002>>>>>>>Use cDbCJGridColumn.pkg
75002>>>>>>>Use Windows.pkg
75002>>>>>>>
75002>>>>>>>Use cSoforDataDictionary.dd
75002>>>>>>>
75002>>>>>>>CD_Popup_Object Sofor_sl is a dbModalPanel
75020>>>>>>>>
75020>>>>>>>    Set Location to 5 5
75021>>>>>>>    Set Size to 134 211
75022>>>>>>>    Set Label To "Sofor Lookup List"
75023>>>>>>>    Set Border_Style to Border_Thick
75024>>>>>>>    Set Minimize_Icon to False
75025>>>>>>>
75025>>>>>>>
75025>>>>>>>    Object oSofor_DD is a cSoforDataDictionary
75027>>>>>>>    End_Object 
75028>>>>>>>
75028>>>>>>>    Set Main_DD To oSofor_DD
75029>>>>>>>    Set Server  To oSofor_DD
75030>>>>>>>
75030>>>>>>>
75030>>>>>>>
75030>>>>>>>    Object oSelList is a cDbCJGridPromptList
75032>>>>>>>        Set Size to 105 201
75033>>>>>>>        Set Location to 5 5
75034>>>>>>>        Set peAnchors to anAll
75035>>>>>>>        Set psLayoutSection to "Sofor_sl_oSelList"
75036>>>>>>>        Set Ordering to 1
75037>>>>>>>        Set pbAutoServer to True
75038>>>>>>>
75038>>>>>>>        Object oSofor_Azonosito is a cDbCJGridColumn
75040>>>>>>>            Entry_Item Sofor.Azonosito
75041>>>>>>>            Set piWidth to 61
75042>>>>>>>            Set psCaption to "Azonost"
75043>>>>>>>        End_Object 
75044>>>>>>>
75044>>>>>>>        Object oSofor_Nev is a cDbCJGridColumn
75046>>>>>>>            Entry_Item Sofor.Nev
75047>>>>>>>            Set piWidth to 225
75048>>>>>>>            Set psCaption to "Nv"
75049>>>>>>>        End_Object 
75050>>>>>>>
75050>>>>>>>
75050>>>>>>>    End_Object 
75051>>>>>>>
75051>>>>>>>    Object oOk_bn is a Button
75053>>>>>>>        Set Label to "&Ok"
75054>>>>>>>        Set Location to 115 48
75055>>>>>>>        Set peAnchors to anBottomRight
75056>>>>>>>
75056>>>>>>>        Procedure OnClick
75059>>>>>>>            Send OK of oSelList
75060>>>>>>>        End_Procedure
75061>>>>>>>
75061>>>>>>>    End_Object 
75062>>>>>>>
75062>>>>>>>    Object oCancel_bn is a Button
75064>>>>>>>        Set Label to "&Cancel"
75065>>>>>>>        Set Location to 115 102
75066>>>>>>>        Set peAnchors to anBottomRight
75067>>>>>>>
75067>>>>>>>        Procedure OnClick
75070>>>>>>>            Send Cancel of oSelList
75071>>>>>>>        End_Procedure
75072>>>>>>>
75072>>>>>>>    End_Object 
75073>>>>>>>
75073>>>>>>>    Object oSearch_bn is a Button
75075>>>>>>>        Set Label to "&Search..."
75076>>>>>>>        Set Location to 115 156
75077>>>>>>>        Set peAnchors to anBottomRight
75078>>>>>>>
75078>>>>>>>        Procedure OnClick
75081>>>>>>>            Send Search of oSelList
75082>>>>>>>        End_Procedure
75083>>>>>>>
75083>>>>>>>    End_Object 
75084>>>>>>>
75084>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
75085>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
75086>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
75087>>>>>>>
75087>>>>>>>
75087>>>>>>>CD_End_Object // Sofor_sl
75089>>>>>>>>
75089>>>
75089>>>ACTIVATE_VIEW Activate_oSoforEntry FOR oSoforEntry
75099>>>>
75099>>>Object oSoforEntry is a dbView
75101>>>    Set Location to 5 5
75102>>>    Set Size to 38 268
75103>>>    Set Label To "SoforEntry"
75104>>>    Set Border_Style to Border_Thick
75105>>>
75105>>>
75105>>>    Object oSofor_DD is a cSoforDataDictionary
75107>>>    End_Object 
75108>>>
75108>>>    Set Main_DD To oSofor_DD
75109>>>    Set Server  To oSofor_DD
75110>>>
75110>>>
75110>>>
75110>>>    Object oSoforAzonosito is a dbForm
75112>>>        Entry_Item Sofor.Azonosito
75113>>>        Set Size to 13 49
75114>>>        Set Location to 5 38
75115>>>        Set peAnchors to anLeftRight
75116>>>        Set Label to "Azonosito"
75117>>>        Set Label_Justification_mode to jMode_Left
75118>>>        Set Label_Col_Offset to 33
75119>>>        Set Label_row_Offset to 0
75120>>>    End_Object 
75121>>>
75121>>>    Object oSoforNev is a dbForm
75123>>>        Entry_Item Sofor.Nev
75124>>>        Set Size to 13 225
75125>>>        Set Location to 20 38
75126>>>        Set peAnchors to anLeftRight
75127>>>        Set Label to "Nev"
75128>>>        Set Label_Justification_mode to jMode_Left
75129>>>        Set Label_Col_Offset to 33
75130>>>        Set Label_row_Offset to 0
75131>>>    End_Object 
75132>>>
75132>>>
75132>>>End_Object 
75133>        Use GepkocsiEntry.vw
Including file: GepkocsiEntry.vw    (C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\GepkocsiEntry.vw)
75133>>>// C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\GepkocsiEntry.vw
75133>>>// GepkocsiEntry
75133>>>//
75133>>>
75133>>>Use DFClient.pkg
75133>>>Use DFEntry.pkg
75133>>>
75133>>>Use cGepkocsiDataDictionary.dd
Including file: cGepkocsiDataDictionary.dd    (C:\Visual DataFlex Projects\Szallitmanyozas\DDSrc\cGepkocsiDataDictionary.dd)
75133>>>>>Use DataDict.pkg
75133>>>>>
75133>>>>>Open Gepkocsi
Including file: Gepkocsi.fd    (C:\Visual DataFlex Projects\Szallitmanyozas\DDSrc\Gepkocsi.fd)
75135>>>>>Open Fuvarlevel
75137>>>>>
75137>>>>>Register_Object Gepkocsi_sl
75137>>>>>
75137>>>>>Class cGepkocsiDataDictionary is a DataDictionary
75138>>>>>    
75138>>>>>    Procedure Construct_Object
75140>>>>>        Forward Send Construct_Object
75142>>>>>        Set Main_File to Gepkocsi.File_Number
75143>>>>>
75143>>>>>        Set Add_Client_File to Fuvarlevel.File_Number
75144>>>>>
75144>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
75145>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
75146>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
75147>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
75148>>>>>
75148>>>>>        Set Field_Mask Field Gepkocsi.Rendszam to "@@@-###"
75149>>>>>        Set Field_Label_Long Field Gepkocsi.Rendszam to "Gpjrmu rendszma"
75150>>>>>        Set Field_Label_Short Field Gepkocsi.Rendszam to "Rendszm"
75151>>>>>        Set Status_Help Field Gepkocsi.Rendszam to "Rendszm AAA-111 formban"
75152>>>>>        Set Field_Prompt_Object Field Gepkocsi.Rendszam to Gepkocsi_sl
75153>>>>>
75153>>>>>        Set Field_Label_Long Field Gepkocsi.Tipus to "Jrmu tpusa"
75154>>>>>        Set Field_Label_Short Field Gepkocsi.Tipus to "Tpus"
75155>>>>>        Set Field_Prompt_Object Field Gepkocsi.Tipus to Gepkocsi_sl
75156>>>>>
75156>>>>>    End_Procedure
75157>>>>>
75157>>>>>End_Class
75158>>>>>
75158>>>>>Use Gepkocsi.sl
Including file: Gepkocsi.sl    (C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\Gepkocsi.sl)
75158>>>>>>>// Gepkocsi.sl
75158>>>>>>>// Gepkocsi Lookup List
75158>>>>>>>
75158>>>>>>>Use DFClient.pkg
75158>>>>>>>Use cDbCJGridPromptList.pkg
75158>>>>>>>Use cDbCJGridColumn.pkg
75158>>>>>>>Use Windows.pkg
75158>>>>>>>
75158>>>>>>>Use cGepkocsiDataDictionary.dd
75158>>>>>>>
75158>>>>>>>CD_Popup_Object Gepkocsi_sl is a dbModalPanel
75176>>>>>>>>
75176>>>>>>>    Set Location to 5 5
75177>>>>>>>    Set Size to 134 213
75178>>>>>>>    Set Label To "Gepkocsi Lookup List"
75179>>>>>>>    Set Border_Style to Border_Thick
75180>>>>>>>    Set Minimize_Icon to False
75181>>>>>>>
75181>>>>>>>
75181>>>>>>>    Object oGepkocsi_DD is a cGepkocsiDataDictionary
75183>>>>>>>    End_Object 
75184>>>>>>>
75184>>>>>>>    Set Main_DD To oGepkocsi_DD
75185>>>>>>>    Set Server  To oGepkocsi_DD
75186>>>>>>>
75186>>>>>>>
75186>>>>>>>
75186>>>>>>>    Object oSelList is a cDbCJGridPromptList
75188>>>>>>>        Set Size to 105 203
75189>>>>>>>        Set Location to 5 5
75190>>>>>>>        Set peAnchors to anAll
75191>>>>>>>        Set psLayoutSection to "Gepkocsi_sl_oSelList"
75192>>>>>>>        Set Ordering to 1
75193>>>>>>>        Set pbAutoServer to True
75194>>>>>>>
75194>>>>>>>        Object oGepkocsi_Rendszam is a cDbCJGridColumn
75196>>>>>>>            Entry_Item Gepkocsi.Rendszam
75197>>>>>>>            Set piWidth to 64
75198>>>>>>>            Set psCaption to "Rendszm"
75199>>>>>>>        End_Object 
75200>>>>>>>
75200>>>>>>>        Object oGepkocsi_Tipus is a cDbCJGridColumn
75202>>>>>>>            Entry_Item Gepkocsi.Tipus
75203>>>>>>>            Set piWidth to 225
75204>>>>>>>            Set psCaption to "Tpus"
75205>>>>>>>        End_Object 
75206>>>>>>>
75206>>>>>>>
75206>>>>>>>    End_Object 
75207>>>>>>>
75207>>>>>>>    Object oOk_bn is a Button
75209>>>>>>>        Set Label to "&Ok"
75210>>>>>>>        Set Location to 115 50
75211>>>>>>>        Set peAnchors to anBottomRight
75212>>>>>>>
75212>>>>>>>        Procedure OnClick
75215>>>>>>>            Send OK of oSelList
75216>>>>>>>        End_Procedure
75217>>>>>>>
75217>>>>>>>    End_Object 
75218>>>>>>>
75218>>>>>>>    Object oCancel_bn is a Button
75220>>>>>>>        Set Label to "&Cancel"
75221>>>>>>>        Set Location to 115 104
75222>>>>>>>        Set peAnchors to anBottomRight
75223>>>>>>>
75223>>>>>>>        Procedure OnClick
75226>>>>>>>            Send Cancel of oSelList
75227>>>>>>>        End_Procedure
75228>>>>>>>
75228>>>>>>>    End_Object 
75229>>>>>>>
75229>>>>>>>    Object oSearch_bn is a Button
75231>>>>>>>        Set Label to "&Search..."
75232>>>>>>>        Set Location to 115 158
75233>>>>>>>        Set peAnchors to anBottomRight
75234>>>>>>>
75234>>>>>>>        Procedure OnClick
75237>>>>>>>            Send Search of oSelList
75238>>>>>>>        End_Procedure
75239>>>>>>>
75239>>>>>>>    End_Object 
75240>>>>>>>
75240>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
75241>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
75242>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
75243>>>>>>>
75243>>>>>>>
75243>>>>>>>CD_End_Object // Gepkocsi_sl
75245>>>>>>>>
75245>>>
75245>>>ACTIVATE_VIEW Activate_oGepkocsiEntry FOR oGepkocsiEntry
75255>>>>
75255>>>Object oGepkocsiEntry is a dbView
75257>>>    Set Location to 5 5
75258>>>    Set Size to 38 265
75259>>>    Set Label To "GepkocsiEntry"
75260>>>    Set Border_Style to Border_Thick
75261>>>
75261>>>
75261>>>    Object oGepkocsi_DD is a cGepkocsiDataDictionary
75263>>>    End_Object 
75264>>>
75264>>>    Set Main_DD To oGepkocsi_DD
75265>>>    Set Server  To oGepkocsi_DD
75266>>>
75266>>>
75266>>>
75266>>>    Object oGepkocsiRendszam is a dbForm
75268>>>        Entry_Item Gepkocsi.Rendszam
75269>>>        Set Size to 13 75
75270>>>        Set Location to 5 74
75271>>>        Set peAnchors to anLeftRight
75272>>>        Set Label to "Gpjrmu rendszma"
75273>>>        Set Label_Justification_mode to jMode_Left
75274>>>        Set Label_Col_Offset to 69
75275>>>        Set Label_row_Offset to 0
75276>>>    End_Object 
75277>>>
75277>>>    Object oGepkocsiTipus is a dbForm
75279>>>        Entry_Item Gepkocsi.Tipus
75280>>>        Set Size to 13 186
75281>>>        Set Location to 20 74
75282>>>        Set peAnchors to anLeftRight
75283>>>        Set Label to "Jrmu tpusa"
75284>>>        Set Label_Justification_mode to jMode_Left
75285>>>        Set Label_Col_Offset to 69
75286>>>        Set Label_row_Offset to 0
75287>>>    End_Object 
75288>>>
75288>>>
75288>>>End_Object 
75289>        Use TermekEntry.vw
Including file: TermekEntry.vw    (C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\TermekEntry.vw)
75289>>>// C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\TermekEntry.vw
75289>>>// TermekEntry
75289>>>//
75289>>>
75289>>>Use DFClient.pkg
75289>>>Use DFEntry.pkg
75289>>>
75289>>>Use cTermekDataDictionary.dd
Including file: cTermekDataDictionary.dd    (C:\Visual DataFlex Projects\Szallitmanyozas\DDSrc\cTermekDataDictionary.dd)
75289>>>>>Use DataDict.pkg
75289>>>>>
75289>>>>>Open Termek
Including file: Termek.fd    (C:\Visual DataFlex Projects\Szallitmanyozas\DDSrc\Termek.fd)
75291>>>>>Open Fuvarlevel
75293>>>>>Open system
75295>>>>>
75295>>>>>Register_Object Termek_sl
75295>>>>>
75295>>>>>Class cTermekDataDictionary is a DataDictionary
75296>>>>>    
75296>>>>>    Procedure Construct_Object
75298>>>>>        Forward Send Construct_Object
75300>>>>>        Set Main_File to Termek.File_Number
75301>>>>>
75301>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
75302>>>>>
75302>>>>>        Set Add_Client_File to Fuvarlevel.File_Number
75303>>>>>
75303>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
75304>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
75305>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
75306>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
75307>>>>>
75307>>>>>        Set Field_Auto_Increment Field Termek.Azonosito to File_Field system.Last_Termek
75308>>>>>        Set Field_Label_Long Field Termek.Azonosito to "Termk azonostja"
75309>>>>>        Set Field_Label_Short Field Termek.Azonosito to "Azonost"
75310>>>>>        Set Field_Prompt_Object Field Termek.Azonosito to Termek_sl
75311>>>>>
75311>>>>>        Set Field_Label_Long Field Termek.Megnevezes to "Termk megnevezse"
75312>>>>>        Set Field_Label_Short Field Termek.Megnevezes to "Megnevezs"
75313>>>>>        Set Field_Prompt_Object Field Termek.Megnevezes to Termek_sl
75314>>>>>
75314>>>>>        Set Field_Label_Long Field Termek.Egysegar to "Termk egysgra"
75315>>>>>        Set Field_Label_Short Field Termek.Egysegar to "Egysgr"
75316>>>>>
75316>>>>>    End_Procedure
75317>>>>>
75317>>>>>End_Class
75318>>>>>
75318>>>>>Use Termek.sl
Including file: Termek.sl    (C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\Termek.sl)
75318>>>>>>>// Termek.sl
75318>>>>>>>// Termek Lookup List
75318>>>>>>>
75318>>>>>>>Use DFClient.pkg
75318>>>>>>>Use cDbCJGridPromptList.pkg
75318>>>>>>>Use cDbCJGridColumn.pkg
75318>>>>>>>Use Windows.pkg
75318>>>>>>>
75318>>>>>>>Use cTermekDataDictionary.dd
75318>>>>>>>
75318>>>>>>>CD_Popup_Object Termek_sl is a dbModalPanel
75336>>>>>>>>
75336>>>>>>>    Set Location to 5 5
75337>>>>>>>    Set Size to 134 211
75338>>>>>>>    Set Label To "Termek Lookup List"
75339>>>>>>>    Set Border_Style to Border_Thick
75340>>>>>>>    Set Minimize_Icon to False
75341>>>>>>>
75341>>>>>>>
75341>>>>>>>    Object oTermek_DD is a cTermekDataDictionary
75343>>>>>>>    End_Object 
75344>>>>>>>
75344>>>>>>>    Set Main_DD To oTermek_DD
75345>>>>>>>    Set Server  To oTermek_DD
75346>>>>>>>
75346>>>>>>>
75346>>>>>>>
75346>>>>>>>    Object oSelList is a cDbCJGridPromptList
75348>>>>>>>        Set Size to 105 201
75349>>>>>>>        Set Location to 5 5
75350>>>>>>>        Set peAnchors to anAll
75351>>>>>>>        Set psLayoutSection to "Termek_sl_oSelList"
75352>>>>>>>        Set Ordering to 1
75353>>>>>>>        Set pbAutoServer to True
75354>>>>>>>
75354>>>>>>>        Object oTermek_Azonosito is a cDbCJGridColumn
75356>>>>>>>            Entry_Item Termek.Azonosito
75357>>>>>>>            Set piWidth to 61
75358>>>>>>>            Set psCaption to "Azonost"
75359>>>>>>>        End_Object 
75360>>>>>>>
75360>>>>>>>        Object oTermek_Megnevezes is a cDbCJGridColumn
75362>>>>>>>            Entry_Item Termek.Megnevezes
75363>>>>>>>            Set piWidth to 225
75364>>>>>>>            Set psCaption to "Megnevezs"
75365>>>>>>>        End_Object 
75366>>>>>>>
75366>>>>>>>
75366>>>>>>>    End_Object 
75367>>>>>>>
75367>>>>>>>    Object oOk_bn is a Button
75369>>>>>>>        Set Label to "&Ok"
75370>>>>>>>        Set Location to 115 48
75371>>>>>>>        Set peAnchors to anBottomRight
75372>>>>>>>
75372>>>>>>>        Procedure OnClick
75375>>>>>>>            Send OK of oSelList
75376>>>>>>>        End_Procedure
75377>>>>>>>
75377>>>>>>>    End_Object 
75378>>>>>>>
75378>>>>>>>    Object oCancel_bn is a Button
75380>>>>>>>        Set Label to "&Cancel"
75381>>>>>>>        Set Location to 115 102
75382>>>>>>>        Set peAnchors to anBottomRight
75383>>>>>>>
75383>>>>>>>        Procedure OnClick
75386>>>>>>>            Send Cancel of oSelList
75387>>>>>>>        End_Procedure
75388>>>>>>>
75388>>>>>>>    End_Object 
75389>>>>>>>
75389>>>>>>>    Object oSearch_bn is a Button
75391>>>>>>>        Set Label to "&Search..."
75392>>>>>>>        Set Location to 115 156
75393>>>>>>>        Set peAnchors to anBottomRight
75394>>>>>>>
75394>>>>>>>        Procedure OnClick
75397>>>>>>>            Send Search of oSelList
75398>>>>>>>        End_Procedure
75399>>>>>>>
75399>>>>>>>    End_Object 
75400>>>>>>>
75400>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
75401>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
75402>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
75403>>>>>>>
75403>>>>>>>
75403>>>>>>>CD_End_Object // Termek_sl
75405>>>>>>>>
75405>>>
75405>>>ACTIVATE_VIEW Activate_oTermekEntry FOR oTermekEntry
75415>>>>
75415>>>Object oTermekEntry is a dbView
75417>>>    Set Location to 5 5
75418>>>    Set Size to 53 267
75419>>>    Set Label To "TermekEntry"
75420>>>    Set Border_Style to Border_Thick
75421>>>
75421>>>
75421>>>    Object oTermek_DD is a cTermekDataDictionary
75423>>>    End_Object 
75424>>>
75424>>>    Set Main_DD To oTermek_DD
75425>>>    Set Server  To oTermek_DD
75426>>>
75426>>>
75426>>>
75426>>>    Object oTermekAzonosito is a dbForm
75428>>>        Entry_Item Termek.Azonosito
75429>>>        Set Size to 13 59
75430>>>        Set Location to 5 76
75431>>>        Set peAnchors to anLeftRight
75432>>>        Set Label to "Termk azonostja"
75433>>>        Set Label_Justification_mode to jMode_Left
75434>>>        Set Label_Col_Offset to 71
75435>>>        Set Label_row_Offset to 0
75436>>>    End_Object 
75437>>>
75437>>>    Object oTermekMegnevezes is a dbForm
75439>>>        Entry_Item Termek.Megnevezes
75440>>>        Set Size to 13 186
75441>>>        Set Location to 20 76
75442>>>        Set peAnchors to anLeftRight
75443>>>        Set Label to "Termk megnevezse"
75444>>>        Set Label_Justification_mode to jMode_Left
75445>>>        Set Label_Col_Offset to 71
75446>>>        Set Label_row_Offset to 0
75447>>>    End_Object 
75448>>>
75448>>>    Object oTermekEgysegar is a dbForm
75450>>>        Entry_Item Termek.Egysegar
75451>>>        Set Size to 13 58
75452>>>        Set Location to 35 76
75453>>>        Set peAnchors to anLeftRight
75454>>>        Set Label to "Termk egysgra"
75455>>>        Set Label_Justification_mode to jMode_Left
75456>>>        Set Label_Col_Offset to 71
75457>>>        Set Label_row_Offset to 0
75458>>>    End_Object 
75459>>>
75459>>>
75459>>>End_Object 
75460>        Use FuvarlevelEntry.vw
Including file: FuvarlevelEntry.vw    (C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\FuvarlevelEntry.vw)
75460>>>// C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\FuvarlevelEntry.vw
75460>>>// FuvarlevelEntry
75460>>>//
75460>>>
75460>>>Use DFClient.pkg
75460>>>Use DFEntry.pkg
75460>>>
75460>>>Use cTermekDataDictionary.dd
75460>>>Use cSoforDataDictionary.dd
75460>>>Use cGepkocsiDataDictionary.dd
75460>>>Use cFuvarlevelDataDictionary.dd
Including file: cFuvarlevelDataDictionary.dd    (C:\Visual DataFlex Projects\Szallitmanyozas\DDSrc\cFuvarlevelDataDictionary.dd)
75460>>>>>Use DataDict.pkg
75460>>>>>
75460>>>>>Open Fuvarlevel
75462>>>>>Open Gepkocsi
75464>>>>>Open Sofor
75466>>>>>Open Termek
75468>>>>>Open system
75470>>>>>
75470>>>>>Register_Object Sofor_sl
75470>>>>>Register_Object Termek_sl
75470>>>>>Register_Object Gepkocsi_sl
75470>>>>>
75470>>>>>Class cFuvarlevelDataDictionary is a DataDictionary
75471>>>>>    
75471>>>>>    Procedure Construct_Object
75473>>>>>        Forward Send Construct_Object
75475>>>>>        Set Main_File to Fuvarlevel.File_Number
75476>>>>>
75476>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
75477>>>>>        Set Add_Server_File to Sofor.File_Number
75478>>>>>        Set Add_Server_File to Termek.File_Number
75479>>>>>        Set Add_Server_File to Gepkocsi.File_Number
75480>>>>>
75480>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
75481>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
75482>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
75483>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
75484>>>>>
75484>>>>>        Set Field_Label_Long Field Fuvarlevel.Fuvarszam to "Fuvarlevl szma"
75485>>>>>        Set Field_Label_Short Field Fuvarlevel.Fuvarszam to "Fuvarszm"
75486>>>>>        Set Field_Auto_Increment Field Fuvarlevel.Fuvarszam to File_Field system.Last_Fuvarszam
75487>>>>>        Set Field_Option Field Fuvarlevel.Fuvarszam DD_NOENTER to True
75488>>>>>
75488>>>>>        Set Field_Label_Long Field Fuvarlevel.Termek to "Termk azonostja"
75489>>>>>        Set Field_Label_Short Field Fuvarlevel.Termek to "Termk"
75490>>>>>        Set Field_Prompt_Object Field Fuvarlevel.Termek to Termek_sl
75491>>>>>        Set Field_Option Field Fuvarlevel.Termek DD_FORCEPUT to True
75492>>>>>
75492>>>>>        Set Field_Label_Long Field Fuvarlevel.Gepkocsi to "Gpkocsi rendszma"
75493>>>>>        Set Field_Label_Short Field Fuvarlevel.Gepkocsi to "Rendszm"
75494>>>>>        Set Field_Prompt_Object Field Fuvarlevel.Gepkocsi to Gepkocsi_sl
75495>>>>>        Set Field_Option Field Fuvarlevel.Gepkocsi DD_FORCEPUT to True
75496>>>>>
75496>>>>>        Set Field_Label_Long Field Fuvarlevel.Sofor to "Sofor azonostja"
75497>>>>>        Set Field_Label_Short Field Fuvarlevel.Sofor to "Sofor"
75498>>>>>        Set Field_Prompt_Object Field Fuvarlevel.Sofor to Sofor_sl
75499>>>>>        Set Field_Option Field Fuvarlevel.Sofor DD_FORCEPUT to True
75500>>>>>
75500>>>>>        Set Field_Label_Long Field Fuvarlevel.Datum to "Fuvar dtuma"
75501>>>>>        Set Field_Label_Short Field Fuvarlevel.Datum to "Dtum"
75502>>>>>        Set Field_Value_Range Field Fuvarlevel.Datum to 01/01/2013 12/31/2014
75503>>>>>        Set Field_Mask_Type Field Fuvarlevel.Datum to Mask_Date_Window
75504>>>>>
75504>>>>>        Set Field_Label_Long Field Fuvarlevel.Tav to "Fuvar sorn megtett tvolsg"
75505>>>>>        Set Field_Label_Short Field Fuvarlevel.Tav to "Tv"
75506>>>>>        Set Field_Option Field Fuvarlevel.Tav DD_REQUIRED to True
75507>>>>>
75507>>>>>        Set Field_Label_Long Field Fuvarlevel.Munkaido to "Fuvarral eltlttt ido"
75508>>>>>        Set Field_Label_Short Field Fuvarlevel.Munkaido to "Munkaido"
75509>>>>>        Set Field_Option Field Fuvarlevel.Munkaido DD_REQUIRED to True
75510>>>>>
75510>>>>>        Set Field_Label_Long Field Fuvarlevel.UAMennyiseg to "Fuvar sorn elfogyasztott uzemanyagmennyiseg"
75511>>>>>        Set Field_Label_Short Field Fuvarlevel.UAMennyiseg to "zemanyagmennyisg"
75512>>>>>        Set Field_Option Field Fuvarlevel.UAMennyiseg DD_REQUIRED to True
75513>>>>>
75513>>>>>        Set Field_Label_Long Field Fuvarlevel.UAEgysegar to "Fuvar sorn elhasznlt zemanyag aktulis ra"
75514>>>>>        Set Field_Label_Short Field Fuvarlevel.UAEgysegar to "zemanyagr"
75515>>>>>        Set Field_Option Field Fuvarlevel.UAEgysegar DD_REQUIRED to True
75516>>>>>
75516>>>>>    End_Procedure
75517>>>>>
75517>>>>>End_Class
75518>>>>>
75518>>>>>Use Gepkocsi.sl
75518>>>>>Use Termek.sl
75518>>>>>Use Sofor.sl
75518>>>>>
75518>>>
75518>>>ACTIVATE_VIEW Activate_oFuvarlevelEntry FOR oFuvarlevelEntry
75528>>>>
75528>>>Object oFuvarlevelEntry is a dbView
75530>>>    Set Location to 5 5
75531>>>    Set Size to 143 234
75532>>>    Set Label To "FuvarlevelEntry"
75533>>>    Set Border_Style to Border_Thick
75534>>>
75534>>>
75534>>>    Object oTermek_DD is a cTermekDataDictionary
75536>>>    End_Object 
75537>>>
75537>>>    Object oSofor_DD is a cSoforDataDictionary
75539>>>    End_Object 
75540>>>
75540>>>    Object oGepkocsi_DD is a cGepkocsiDataDictionary
75542>>>    End_Object 
75543>>>
75543>>>    Object oFuvarlevel_DD is a cFuvarlevelDataDictionary
75545>>>        Set DDO_Server To oSofor_DD
75546>>>        Set DDO_Server To oTermek_DD
75547>>>        Set DDO_Server To oGepkocsi_DD
75548>>>    End_Object 
75549>>>
75549>>>    Set Main_DD To oFuvarlevel_DD
75550>>>    Set Server  To oFuvarlevel_DD
75551>>>
75551>>>
75551>>>
75551>>>    Object oFuvarlevelFuvarszam is a dbForm
75553>>>        Entry_Item Fuvarlevel.Fuvarszam
75554>>>        Set Size to 13 42
75555>>>        Set Location to 5 163
75556>>>        Set peAnchors to anLeftRight
75557>>>        Set Label to "Fuvarlevl szma"
75558>>>        Set Label_Justification_mode to jMode_Left
75559>>>        Set Label_Col_Offset to 158
75560>>>        Set Label_row_Offset to 0
75561>>>    End_Object 
75562>>>
75562>>>    Object oTermekAzonosito is a dbForm
75564>>>        Entry_Item Termek.Azonosito
75565>>>        Set Size to 13 42
75566>>>        Set Location to 20 163
75567>>>        Set peAnchors to anLeftRight
75568>>>        Set Label to "Termk azonostja"
75569>>>        Set Label_Justification_mode to jMode_Left
75570>>>        Set Label_Col_Offset to 158
75571>>>        Set Label_row_Offset to 0
75572>>>    End_Object 
75573>>>
75573>>>    Object oGepkocsiRendszam is a dbForm
75575>>>        Entry_Item Gepkocsi.Rendszam
75576>>>        Set Size to 13 42
75577>>>        Set Location to 35 163
75578>>>        Set peAnchors to anLeftRight
75579>>>        Set Label to "Gpkocsi rendszma"
75580>>>        Set Label_Justification_mode to jMode_Left
75581>>>        Set Label_Col_Offset to 158
75582>>>        Set Label_row_Offset to 0
75583>>>    End_Object 
75584>>>
75584>>>    Object oSoforAzonosito is a dbForm
75586>>>        Entry_Item Sofor.Azonosito
75587>>>        Set Size to 13 34
75588>>>        Set Location to 50 163
75589>>>        Set peAnchors to anLeftRight
75590>>>        Set Label to "Sofor azonostja"
75591>>>        Set Label_Justification_mode to jMode_Left
75592>>>        Set Label_Col_Offset to 158
75593>>>        Set Label_row_Offset to 0
75594>>>    End_Object 
75595>>>
75595>>>    Object oFuvarlevelDatum is a dbForm
75597>>>        Entry_Item Fuvarlevel.Datum
75598>>>        Set Size to 13 66
75599>>>        Set Location to 65 163
75600>>>        Set peAnchors to anLeftRight
75601>>>        Set Label to "Fuvar dtuma"
75602>>>        Set Label_Justification_mode to jMode_Left
75603>>>        Set Label_Col_Offset to 158
75604>>>        Set Label_row_Offset to 0
75605>>>    End_Object 
75606>>>
75606>>>    Object oFuvarlevelTav is a dbForm
75608>>>        Entry_Item Fuvarlevel.Tav
75609>>>        Set Size to 13 34
75610>>>        Set Location to 80 163
75611>>>        Set peAnchors to anLeftRight
75612>>>        Set Label to "Fuvar sorn megtett tvolsg"
75613>>>        Set Label_Justification_mode to jMode_Left
75614>>>        Set Label_Col_Offset to 158
75615>>>        Set Label_row_Offset to 0
75616>>>    End_Object 
75617>>>
75617>>>    Object oFuvarlevelMunkaido is a dbForm
75619>>>        Entry_Item Fuvarlevel.Munkaido
75620>>>        Set Size to 13 34
75621>>>        Set Location to 95 163
75622>>>        Set peAnchors to anLeftRight
75623>>>        Set Label to "Fuvarral eltlttt ido"
75624>>>        Set Label_Justification_mode to jMode_Left
75625>>>        Set Label_Col_Offset to 158
75626>>>        Set Label_row_Offset to 0
75627>>>    End_Object 
75628>>>
75628>>>    Object oFuvarlevelUAMennyiseg is a dbForm
75630>>>        Entry_Item Fuvarlevel.UAMennyiseg
75631>>>        Set Size to 13 34
75632>>>        Set Location to 110 163
75633>>>        Set peAnchors to anLeftRight
75634>>>        Set Label to "Fuvar sorn elfogyasztott uzemanyagmennyiseg"
75635>>>        Set Label_Justification_mode to jMode_Left
75636>>>        Set Label_Col_Offset to 158
75637>>>        Set Label_row_Offset to 0
75638>>>    End_Object 
75639>>>
75639>>>    Object oFuvarlevelUAEgysegar is a dbForm
75641>>>        Entry_Item Fuvarlevel.UAEgysegar
75642>>>        Set Size to 13 34
75643>>>        Set Location to 125 163
75644>>>        Set peAnchors to anLeftRight
75645>>>        Set Label to "Fuvar sorn elhasznlt zemanyag aktulis ra"
75646>>>        Set Label_Justification_mode to jMode_Left
75647>>>        Set Label_Col_Offset to 158
75648>>>        Set Label_row_Offset to 0
75649>>>    End_Object 
75650>>>
75650>>>
75650>>>End_Object 
75651>        Use Havi.rv
Including file: Havi.rv    (C:\Visual DataFlex Projects\Szallitmanyozas\AppSrc\Havi.rv)
75651>>>// Havi.rv
75651>>>// Havi
75651>>>Register_Object oReport
75651>>>
75651>>>Use DFRptVw.pkg
75651>>>Use cWinReport2.pkg
Including file: cWinReport2.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\cWinReport2.pkg)
75651>>>>>// cWinReport2.pkg
75651>>>>>
75651>>>>>// defines support for new Winprint2 cWinReport2 class
75651>>>>>
75651>>>>>
75651>>>>>Use DFRpt.pkg              // BasicReport RO Class for VDF
75651>>>>>Use WinPrint2.pkg          // WinPrint2 engine
Including file: Winprint2.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\Winprint2.pkg)
75651>>>>>>>// WinPrint2.pkg
75651>>>>>>>//
75651>>>>>>>Use windows.pkg
75651>>>>>>>Use LanguageText.pkg
75651>>>>>>>Use DLL.pkg
75651>>>>>>>Use WinPrint2_Api.pkg
Including file: WinPrint2_API.pkg    (C:\Program Files (x86)\Visual DataFlex 17.1\Pkg\WinPrint2_API.pkg)
75651>>>>>>>>>//WinPrint2_API.pkg
75651>>>>>>>>>
75651>>>>>>>>>Use DLL.pkg
75651>>>>>>>>>
75651>>>>>>>>>External_Function WP_IsPrinterValid "IsPrinterValid" WinPrint.dll ;Returns Boolean // True if the the current printer is a valid one. False, otherwise.
75652>>>>>>>>>
75652>>>>>>>>>External_Function WP_ArePrintersInstalled "ArePrintersInstalled" WinPrint.dll ; // determines whether at least one printer is installedReturns Boolean // True, if a printer is installed, False if it is not.
75653>>>>>>>>>
75653>>>>>>>>>External_Function WP_ExecutePrinterSetupDialog "ExecutePrinterSetupDialog" WinPrint.dll ; // displays the "printer setup" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
75654>>>>>>>>>
75654>>>>>>>>>External_Function WP_ExecutePrintDialog "ExecutePrintDialog" WinPrint.dll ; // displays the "Print" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
75655>>>>>>>>>
75655>>>>>>>>>External_Function WP_GetCurrentDevice "GetCurrentDevice" WinPrint.dll ; // retrieves the name of the current printer device    Address aDevice ; // address of the string (255 chars) that will hold the device name upon returnReturns Boolean // True, if success; False if error occurred
75656>>>>>>>>>
75656>>>>>>>>>External_Function WP_GetPrintDialogFlags "GetPrintDialogFlags" WinPrint.dll ; // retrieves the current print optionsReturns UInteger // array of flags representing print-related options that are currently set
75657>>>>>>>>>
75657>>>>>>>>>External_Function WP_GetUserDefinedPapersize "GetUserDefinedPapersize" WinPrint.dll ;  // gets the size of user-defined paperReturns UInteger // // hi-word=length; lo-word=width
75658>>>>>>>>>
75658>>>>>>>>>External_Function WP_IsPrintDialogFlagSet "IsPrintDialogFlagSet" WinPrint.dll ; // determines whether a specific print-flag is set    UInteger iFlag ; // the printer flagReturns Boolean // True, if the flag is set; False, if it isn't
75659>>>>>>>>>
75659>>>>>>>>>External_Function WP_SelectPrinter "SelectPrinter" WinPrint.dll ; // selects a printer programatically    String sDevice; // the name of the printerReturns Boolean // True, if success; False, if error (such as an invalid printer name)
75660>>>>>>>>>
75660>>>>>>>>>External_Function WP_SetFirstPagePaperSource "SetFirstPagePaperSource"  WinPrint.dll ;        Integer iBin ; // the bim constantReturns Boolean // True if success, false if error
75661>>>>>>>>>
75661>>>>>>>>>External_Function WP_SetNumberOfPrintCopies "SetNumberOfPrintCopies" WinPrint.dll ; // sets the number of copies to print    UInteger iNumCopies; // number of copies to makeReturns Boolean // Always True
75662>>>>>>>>>
75662>>>>>>>>>External_Function WP_SetSpecificPrintDialogFlag "SetSpecificPrintDialogFlag" WinPrint.dll; // Sets/unsets one printer flag    UInteger fFlag; // printer flagReturns Boolean // True, if success; False if error occurred
75663>>>>>>>>>
75663>>>>>>>>>External_Function WP_SetPrintDialogFlags "SetPrintDialogFlags" WinPrint.dll; // Sets/unsets all printer flags in one call    UInteger fFlags; // printer flagsReturns Boolean // True, if success; False if error occurred
75664>>>>>>>>>
75664>>>>>>>>>External_Function WP_SetUserDefinedPapersize "SetUserDefinedPapersize" WinPrint.dll ;  // sets the size of user-defined paper    UInteger iPaperSize ; // hi-word=length; lo-word=widthReturns Boolean; // True, if success; False if error occurred
75665>>>>>>>>>External_Function WP_SetFontStyle "SetFontStyle" WinPrint.dll ; // sets multiple font attributes    Integer iStyles ; // series of flagsReturns Boolean // always True
75666>>>>>>>>>
75666>>>>>>>>>External_Function WP_SetFontBold "SetFontBold" WinPrint.dll ; // toggles the bold attribute of the current font    Boolean bBold ; // True to switch bold attribute on; False to switch it offReturns Boolean // always True
75667>>>>>>>>>
75667>>>>>>>>>External_Function WP_SetFontItalic "SetFontItalic" WinPrint.dll ; // toggles the italic attribute of the current font    Boolean bItalic ; // True to switch italic attribute on; False to switch it offReturns Boolean  // always True
75668>>>>>>>>>
75668>>>>>>>>>External_Function WP_SetFontUnderline "SetFontUnderline" WinPrint.dll ; // toggles the underline attribute of the current font    Boolean bUnderline ; // True to switch underline attribute on; False to switch it offReturns Boolean  // always True
75669>>>>>>>>>
75669>>>>>>>>>External_Function WP_SetFontStrikeout "SetFontStrikeout" WinPrint.dll ; // toggles the strikeout attribute of the current font    Boolean bStrikeout ; // True to switch strikeout attribute on; False to switch it offReturns Boolean  // always True
75670>>>>>>>>>
75670>>>>>>>>>External_Function WP_SetFontColor "SetFontColor" WinPrint.dll ; // sets the color of the current font    Integer iColor ; // color of the fontReturns Boolean  // always True
75671>>>>>>>>>
75671>>>>>>>>>External_Function WP_SetFontHeight "SetFontHeight" WinPrint.dll ; // sets the height of the font    UInteger iHeight ; // height of the font in points (multiplied by 100. Eg 12.5 point should be sent as 1250)Returns Boolean  // always True
75672>>>>>>>>>
75672>>>>>>>>>External_Function WP_SetFontName "SetFontName" WinPrint.dll ; // Sets the name of the font to use    String sFontName ; // name of the font to useReturns Boolean  // always True
75673>>>>>>>>>
75673>>>>>>>>>External_Function WP_DrawBitmap "DrawBitmap" WinPrint.dll ; // Draws a bitmap (BMP, JPG)    String  sBitmap;                 // Name of the bitmap    Integer iLeft;                   // distance from left edge to draw bitmap    Integer iTop;                    // distance from top edge to draw bitmap    Integer iWidth;                  // width of the bitmap    Integer iHeight;                 // height of the bitmap    Boolean bUpdateCurrentPosition;  // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
75674>>>>>>>>>
75674>>>>>>>>>External_Function WP_DrawEllipse "DrawEllipse" WinPrint.dll ; // draws an elipse within a bounding rectangle    Integer iLeft;                   // distance from left edge to draw the ellipse    Integer iTop;                    // distance from top edge to draw the ellipse    Integer iWidth;                  // width of the bounding rectangle    Integer iHeight;                 // height of the bounding rectangle    Integer iBorderColor;            // color of the ellipse's edge    Integer iFillColor;              // internal color of the ellipse    Boolean  bFill;                  // should the ellipse be filled? (False=transparent)    UInteger iThickness;             // thickness of the elipse    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the ellipse be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
75675>>>>>>>>>
75675>>>>>>>>>External_Function WP_DrawLine "DrawLine" WinPrint.dll ; // draws a line from the current position    Integer iLeft;                   // distance from left edge to draw the line    Integer iTop;                    // distance from top edge to draw the line    Integer iLength;                 // length of the line    Boolean  bHorizontal;            // draw horizontal? (False=vertical)    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
75676>>>>>>>>>
75676>>>>>>>>>External_Function WP_DrawRectangle "DrawRectangle" WinPrint.dll ; // draws a rectangle    Integer iLeft;                   // distance from left edge to draw the rectangle    Integer iTop;                    // distance from top edge to draw the rectangle    Integer iWidth;                  // width of the rectangle    Integer iHeight;                 // height of the rectangle    Integer iBorderColor;            // color of the rectangle's border    Integer iFillColor;              // internal color of the rectangle    Boolean  bFill;                  // should the rectangle be filled? (False=transparent)    UInteger iThickness;             // thickness of the rectangle's border    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the rectangle be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
75677>>>>>>>>>
75677>>>>>>>>>External_Function WP_DrawXYLine "DrawXYLine" WinPrint.dll ; // draws a line between two points    Integer iLeftStart;              // distance from left edge to draw from    Integer iTopStart;               // distance from top edge to draw from    Integer iLeftEnd;                // distance from left edge to draw to    Integer iTopEnd;                 // distance from top edge to draw to    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the line be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
75678>>>>>>>>>
75678>>>>>>>>>External_Function WP_SetAbsoluteMargins "SetAbsoluteMargins" WinPrint.dll ; // modifies the top/bottom non-printable margin    UInteger iTop;      // the top margin offset    UInteger iBottom;   // the bottom margin offset    Boolean  bAllPages; // should all pages be affected? True=AllPages; False=first page onlyReturns Boolean // always True
75679>>>>>>>>>
75679>>>>>>>>>External_Function WP_SetMargins "SetMargins" WinPrint.dll ; // Sets the user-margins    UInteger iLeft;   // the left margin    UInteger iTop;    // the top margin    UInteger iRight;  // the right margin    UInteger iBottom; // the bottom marginReturns Boolean // always True
75680>>>>>>>>>
75680>>>>>>>>>External_Function WP_CreateDiagram "CreateDiagram" WinPrint.dll ; // Creates a new diagram    UInteger eType;       // type of diagram (Bar, Line, Pie)    UInteger eEffect;     // how it is drawn (2d or 3d, etc)    UInteger iWidth;      // width of the diagram    UInteger iHeight;     // height of the diagram    Boolean  bDrawXyAxis; // draw the xy-axis (for bar charts only)?Returns Handle // unique id for the diagram used in other diagram funtions
75681>>>>>>>>>
75681>>>>>>>>>External_Function WP_AddDiagramEntry "AddDiagramEntry" WinPrint.dll ; // Adds an item into a diagram    Handle   hDiagram;          // diagram handle returned by CreateDiagram()    String   sValueDescription; // description of the item    String   sValue;            // value of the item    Integer iBorderColor;       // color of the item's border    Integer iFillColor;         // color of the item's interior    Boolean  bFilled;           // should the item be drawn filled (with iFillColor), or transparent?    UInteger iNumDecimals;      // Number of decimals in the sValue argument    UInteger eValueOrPercent;   // How the value should be displayed (as value or percentage, etc)    Boolean  bExploded;         // should the value be "pulled out" (pie charts only)Returns Boolean // True, if success; False, if error
75682>>>>>>>>>
75682>>>>>>>>>External_Function WP_DrawDiagram "DrawDiagram" WinPrint.dll ; // draws a diagram    Handle   hDiagram;               // diagram handle returned by CreateDiagram()    UInteger iLeft;                  // x-coordinate to draw the diagram    UInteger iTop;                   // y-coordinate to draw the diagram    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if success; False, if error
75683>>>>>>>>>
75683>>>>>>>>>External_Function WP_LockDiagram "LockDiagram" WinPrint.dll ; // Locks a diagram so that no more entries can be added    Handle hDiagram; // diagram handle returned by CreateDiagram()Returns Boolean // True, if success; False, if error
75684>>>>>>>>>
75684>>>>>>>>>External_Function WP_SetDiagramCaption "SetDiagramCaption" WinPrint.dll ; // Sets the caption of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sCaption; // the diagram's captionReturns Boolean // True, if success; False, if error
75685>>>>>>>>>
75685>>>>>>>>>External_Function WP_SetDiagramXText "SetDiagramXText" WinPrint.dll ; // Sets the horizontal label of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sText;    // the diagram's horizonal labelReturns Boolean // True, if success; False, if error
75686>>>>>>>>>
75686>>>>>>>>>External_Function WP_SetDiagramYText "SetDiagramYText" WinPrint.dll ; // Sets the vertical label of a diagram    Handle  hDiagram;      // diagram handle returned by CreateDiagram()    String  sText;         // the diagram's vertical label    Boolean bVerticalText; // should the text be drawn vertically (False=horizontally)Returns Boolean // True, if success; False, if error
75687>>>>>>>>>
75687>>>>>>>>>External_Function WP_BeginHeader "BeginHeader" WinPrint.dll ; // creates a new header    UInteger iHeaderType; // the type of header    UInteger iSubHeaderNum; // for subheaders, then number (1-0)Returns Boolean // always True
75688>>>>>>>>>
75688>>>>>>>>>External_Function WP_EndHeader "EndHeader" WinPrint.dll ; // declares the end of the current headerReturns Boolean // always True
75689>>>>>>>>>
75689>>>>>>>>>External_Function WP_SetExtraLineCheck "SetExtraLineCheck" WinPrint.dll ; // forces a soft page break if header plus number of lines don't fit on page    UInteger iNumLines; // number of lines in addition to header required before forcing a soft page-breakReturns Boolean; // always True
75690>>>>>>>>>External_Function WP_SetHeaderFrame "SetHeaderFrame" WinPrint.dll ; // sets the style, color and frame of a header    UInteger eFrame;     // style of frame (margin-to-margin, etc)    Integer iColor;      // color of the frame's edge    UInteger iThickness; // thickness of the frame    Integer iFillCol;    // the internal color of the frame (only used if bBilled=True)    Boolean  bFilled;    // True, if the frame should be filled with the iFillColor (False=Transparent)Returns Boolean // Always True
75691>>>>>>>>>
75691>>>>>>>>>External_Function WP_SetHeaderMargin "SetHeaderMargin" WinPrint.dll ; // Sets a margin of space on the inside and outside of the current header    UInteger eType;      // Specifies which margin areas is being set.    Integer  iSize;      // Size of the margin setting in the current report metricsReturns Boolean  // False if document is not started
75692>>>>>>>>>
75692>>>>>>>>>External_Function WP_SetHeaderPlacement "SetHeaderPlacement" WinPrint.dll ; // placement (left, center or right) of the header    UInteger ePlacement; // placed left, center or rightReturns Boolean //always True
75693>>>>>>>>>
75693>>>>>>>>>External_Function WP_SetHeaderWrap "SetHeaderWrap" WinPrint.dll ; // determines whether the current header is drawn on soft page-breaks    Boolean bWrap; // True, to wrap onto following pages; False, for current page onlyReturns Boolean // always True
75694>>>>>>>>>
75694>>>>>>>>>External_Function WP_WriteHeader "WriteHeader" WinPrint.dll ; // writes a header to the current page    UInteger eHeaderType;   // type of header    UInteger iSubHeaderNum; // for subheaders, the number (1-9)Returns Boolean // True, if success; False, if error
75695>>>>>>>>>
75695>>>>>>>>>External_Function WP_RGBToDFPrintColor "RGBToDFPrintColor" WinPrint.dll ; // converts R, G, and B values into a composite color that WinPrint expects    UInteger iRed;   // red component (1-255)    UInteger iGreen; // green component (1-255)    UInteger iBlue;  // blue component (1-255)Returns Integer // composite color
75696>>>>>>>>>
75696>>>>>>>>>External_Function WP_GetMetrics "GetMetrics" WinPrint.dll ; // gets the current unit of measurementReturns UInteger // unit of measurement (Inch or CM)
75697>>>>>>>>>
75697>>>>>>>>>External_Function WP_SetMetrics "SetMetrics" WinPrint.dll ; // sets the unit of measurement   UInteger eMetrics; // Inch or CMReturns Boolean // always True
75698>>>>>>>>>
75698>>>>>>>>>External_Function WP_ClearDocument "ClearDocument" WinPrint.dll ; // clears the resources of the document from memoryReturns Boolean // always True
75699>>>>>>>>>
75699>>>>>>>>>External_Function WP_NewDocument "NewDocument" WinPrint.dll ; // starts a new document, but preserves the printer settings   Boolean bAutoPreview ; // Should the Previewer be displayed immediatelyReturns Boolean // True, if success; False, if an error occurred
75700>>>>>>>>>
75700>>>>>>>>>External_Function WP_EndDocument "EndDocument" WinPrint.dll ; // Indicates that the document is finishedReturns Boolean // always True
75701>>>>>>>>>
75701>>>>>>>>>External_Function WP_ClearPrinter "ClearPrinter" WinPrint.dll ; // clears all printer and document resourcesReturns Boolean // True, if success; False, if an error occurred
75702>>>>>>>>>
75702>>>>>>>>>External_Function WP_ConfirmLines "ConfirmLines" WinPrint.dll ; // ensures that a specified number of lines will fit on the page; if not, a soft page-break is performed automatically    UInteger iNumLines; // number of lines that must fit on the pageReturns Boolean // True, if success; False, if an error occurred
75703>>>>>>>>>
75703>>>>>>>>>External_Function WP_CreatePage "CreatePage" WinPrint.dll ; // creates a new page of specified columns   UInteger iNumColumns; // number of columns (zero= no columns)Returns UInteger; // page number that was created
75704>>>>>>>>>External_Function WP_PreviewDocument "PreviewDocument" WinPrint.dll ; // previews the current document    Boolean bPrintDialog; // Determines whether the Print Dialog (range, etc) is displayed when the "print" button is clicked in the preview window.    Boolean bPrintSetup;  // Determines whether the Print Setup button is enabled (allows to change orientation, etc)    Boolean bPrint;       // Determines whether the Print button is enabledReturns Handle // non-zero = hViewerProcess; zero= error
75705>>>>>>>>>
75705>>>>>>>>>External_Function WP_ClosePreview "ClosePreview" WinPrint.dll ; // closes the preview windowReturns Boolean // True, if closed; False, if an error occurred (such as it not being already open)
75706>>>>>>>>>
75706>>>>>>>>>External_Function WP_PrintDocument "PrintDocument" WinPrint.dll ; // prints the current document    Handle hWndParent; // window handle of object to use for any modal outputReturns Boolean // True, if success; False, if an error occurred
75707>>>>>>>>>
75707>>>>>>>>>External_Function WP_SetAlign "SetAlign" WinPrint.dll ; // align future text    UInteger eAlign; // left, center or rightReturns Boolean // always True
75708>>>>>>>>>
75708>>>>>>>>>External_Function WP_WriteText "WriteText" WinPrint.dll ; // write text to the current position or column    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iColumnNum;        // number of the column to write to (zero=no column, use current position)    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
75709>>>>>>>>>
75709>>>>>>>>>External_Function WP_WriteTextAtPosition "WriteTextAtPosition" WinPrint.dll ; // writes text to a specific position    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iPosition;         // horizontal position to write the text    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
75710>>>>>>>>>
75710>>>>>>>>>External_Function WP_SetProgressCaption "SetProgressCaption" WinPrint.dll ;    String sProgressCaption ;Returns Boolean
75711>>>>>>>>>
75711>>>>>>>>>External_Function WP_SetReportTitle     "SetReportTitle"     WinPrint.dll ;    String sCaption ;Returns Boolean
75712>>>>>>>>>
75712>>>>>>>>>External_Function WP_ViewerWantsToClose "ViewerWantsToClose" WinPrint.dll ;Returns Integer
75713>>>>>>>>>
75713>>>>>>>>>External_Function WP_DisplayMessageBox  "DisplayMessageBox"  WinPrint.dll ;    String sCaption String sText ;Returns Integer
75714>>>>>>>>>
75714>>>>>>>>>External_Function WP_GetViewerWindow "GetViewerWindow" Winprint.dll ;Returns Handle
75715>>>>>>>>>
75715>>>>>>>>>External_Function WP_GetDocumentStatus "GetDocumentStatus" Winprint.dll ;Returns Integer // returns dsNotStarted, dsStarted, or dsFinished
75716>>>>>>>>>
75716>>>>>>>Use WinPrint_Constants.pkg
75716>>>>>>>Use Rgb.pkg
75716>>>>>>>Use GlobalFunctionsProcedures.pkg
75716>>>>>>>
75716>>>>>>>DEFINE INFINITE for -1
75716>>>>>>>DEFINE WAIT_TIMEOUT for |CI$00000102
75716>>>>>>>
75716>>>>>>>
75716>>>>>>>DEFINE QS_KEY            for |CI$0001
75716>>>>>>>DEFINE QS_MOUSEMOVE      for |CI$0002
75716>>>>>>>DEFINE QS_MOUSEBUTTON    for |CI$0004
75716>>>>>>>DEFINE QS_POSTMESSAGE    for |CI$0008
75716>>>>>>>DEFINE QS_TIMER          for |CI$0010
75716>>>>>>>DEFINE QS_PAINT          for |CI$0020
75716>>>>>>>DEFINE QS_SENDMESSAGE    for |CI$0040
75716>>>>>>>DEFINE QS_HOTKEY         for |CI$0080
75716>>>>>>>DEFINE QS_ALLPOSTMESSAGE for |CI$0100
75716>>>>>>>DEFINE QS_MOUSE          for (QS_MOUSEMOVE ior QS_MOUSEBUTTON)
75716>>>>>>>DEFINE QS_INPUT          for (QS_MOUSE ior QS_KEY)
75716>>>>>>>DEFINE QS_ALLEVENTS      for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY)
75716>>>>>>>DEFINE QS_ALLINPUT       for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY ior QS_SENDMESSAGE)
75716>>>>>>>
75716>>>>>>>External_Function WaitForSingleObject "WaitForSingleObject" Kernel32.dll Handle hHandle Dword dwMilliseconds Returns DWord
75717>>>>>>>External_Function GetCurrentProcessId "GetCurrentProcessId" Kernel32.dll Returns DWord
75718>>>>>>>External_Function GetCurrentProcess "GetCurrentProcess" Kernel32.dll Returns DWord
75719>>>>>>>
75719>>>>>>>External_Function MsgWaitForMultipleObjects "MsgWaitForMultipleObjects" User32.dll ;    DWORD nCount;             // number of handles in the object handle array    Address pHandles;     // pointer to the object-handle array    Boolean fWaitAll;     // wait for all or wait for one    DWORD dwMilliseconds; // time-out interval in milliseconds    DWORD dwWakeMask;     // type of input events to wait forReturns Dword
75720>>>>>>>
75720>>>>>>>Use GlobalFunctionsProcedures.pkg
75720>>>>>>>
75720>>>>>>>Class cWinPrint2 is a cObject // JJT: Will we need a windows handle for this like old one
75721>>>>>>>    Procedure Construct_Object
75723>>>>>>>        forward send construct_object
75725>>>>>>>
75725>>>>>>>        //*** internal properties
75725>>>>>>>        Property Integer DFCurrent_Color       0
75726>>>>>>>        Property String  DFCurrent_OutPut      "WinPrint"
75727>>>>>>>        Property Integer DFCurrent_Diagram     0
75728>>>>>>>        Property Integer DFCurrent_HeaderType  0
75729>>>>>>>        Property Integer DFCurrent_HeaderNr    0
75730>>>>>>>        Property Number  DFCurrent_FontSize    10
75731>>>>>>>        Property String  DFCurrent_Font        "Arial"
75732>>>>>>>
75732>>>>>>>        //*** Default values for margins 2.53 CM = 1 inch
75732>>>>>>>        Property Number  DFLeft_Margin    2.53
75733>>>>>>>        Property Number  DFTop_Margin     2.53
75734>>>>>>>        Property Number  DFright_Margin   2.53
75735>>>>>>>        Property Number  DFBottom_Margin  2.53
75736>>>>>>>
75736>>>>>>>        // If WP1 this defaults to false. In 2, it is true which means that the print job
75736>>>>>>>        // dialog appears when you hitprint in previewer.
75736>>>>>>>        Property Integer PrintDlgInPreview   1
75737>>>>>>>         // This does nothing in Wp2 (because you can't to this anyway)
75737>>>>>>>        Property Integer EnablePrintSetupFromPreview  True
75738>>>>>>>        Property Integer EnablePrintFromPreview  1
75739>>>>>>>
75739>>>>>>>        // is the GUI Suspended. This is privately maintained and is used
75739>>>>>>>        // to figure out if a preview panel is up or not
75739>>>>>>>        Property Integer pbIsSuspended False
75740>>>>>>>
75740>>>>>>>        Object oDFColorArray is an Array
75742>>>>>>>           //Moved into array
75742>>>>>>>           Set Value  0  To RGB_WHITE
75743>>>>>>>           Set Value  1  To RGB_RED
75744>>>>>>>           Set Value  2  To RGB_BLUE
75745>>>>>>>           Set Value  3  To RGB_GREEN
75746>>>>>>>           Set Value  4  To RGB_YELLOW
75747>>>>>>>           Set Value  5  To RGB_GREY
75748>>>>>>>           Set Value  6  To RGB_CYAN
75749>>>>>>>           Set Value  7  To RGB_MAGENTA
75750>>>>>>>           Set Value  8  To RGB_DRED
75751>>>>>>>           Set Value  9  To RGB_DBLUE
75752>>>>>>>           Set Value  10 To RGB_DGREEN
75753>>>>>>>           Set Value  11 To RGB_DYELLOW
75754>>>>>>>           Set Value  12 To RGB_DGREY
75755>>>>>>>           Set Value  13 To RGB_DCYAN
75756>>>>>>>           Set Value  14 To RGB_DMAGENTA
75757>>>>>>>           Set Value  15 To RGB_BLACK
75758>>>>>>>        End_Object
75759>>>>>>>
75759>>>>>>>        Object oDiagramArray is an Array
75761>>>>>>>        End_Object
75762>>>>>>>
75762>>>>>>>    End_Procedure
75763>>>>>>>
75763>>>>>>>    Function ViewerWantsToClose returns Boolean
75765>>>>>>>        Function_return (WP_ViewerWantsToClose())
75766>>>>>>>    end_Function
75767>>>>>>>
75767>>>>>>>    Function IsViewerActive returns boolean
75769>>>>>>>        Function_Return (WP_GetViewerWindow()<>0)
75770>>>>>>>    end_function
75771>>>>>>>
75771>>>>>>>    Function IsPrinterValid Returns Boolean
75773>>>>>>>        Function_Return (WP_IsPrinterValid()<>0)
75774>>>>>>>    End_Function
75775>>>>>>>
75775>>>>>>>    Function ArePrintersInstalled returns boolean
75777>>>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
75778>>>>>>>    End_Function
75779>>>>>>>
75779>>>>>>>
75779>>>>>>>    // returns docucument state: dsNotStarted, dsStarted, dsFinished
75779>>>>>>>    Function DocumentStatus returns Integer
75781>>>>>>>        Function_Return (WP_GetDocumentStatus())
75782>>>>>>>    end_function
75783>>>>>>>
75783>>>>>>>    // Might still be called from report class. Leave dummy stub
75783>>>>>>>    Procedure DFZeroCounters
75785>>>>>>>    End_Procedure
75786>>>>>>>
75786>>>>>>>    //***
75786>>>>>>>    Function DFNewPage Integer Columns Returns Integer
75788>>>>>>>        Integer iPageNum
75788>>>>>>>        // This returns a page number used in report object....(this may change)
75788>>>>>>>        Move (WP_CreatePage(Columns)) To iPageNum
75789>>>>>>>        If (iPageNum=0) Begin
75791>>>>>>>            Error DFERR_WINPRINT DFPrintError900
75792>>>>>>>>
75792>>>>>>>        End
75792>>>>>>>>
75792>>>>>>>        Function_Return iPageNum
75793>>>>>>>    End_Function
75794>>>>>>>
75794>>>>>>>    //***Return handle to use for winprint dialog. If main_window
75794>>>>>>>    //   exists, use it. Else, get object's handle
75794>>>>>>>    Function Report_Window_Handle returns handle
75796>>>>>>>        Handle hWnd
75796>>>>>>>        Handle hoObj
75796>>>>>>>        Get Focus of desktop to hoObj // start with the focus
75797>>>>>>>        Move (gOwnerWindowHandle(hoObj)) to hWnd // global function finds the right handle for us
75798>>>>>>>        function_return hWnd
75799>>>>>>>    End_Function
75800>>>>>>>
75800>>>>>>>
75800>>>>>>>    //***
75800>>>>>>>    Function DFPrintDialog Returns Boolean
75802>>>>>>>        Handle hwnd
75802>>>>>>>        Boolean bOk
75802>>>>>>>
75802>>>>>>>        Get Report_Window_Handle to hWnd
75803>>>>>>>        Move (WP_ExecutePrintDialog(hwnd)) To bOk
75804>>>>>>>
75804>>>>>>>        Function_Return bOk
75805>>>>>>>    End_Function
75806>>>>>>>
75806>>>>>>>
75806>>>>>>>    //*** You can only invoke the print setup if the report is cleared. If you try to to do this in
75806>>>>>>>    //    the wrong state you will get an error.
75806>>>>>>>    Function DFPrintSetupDialog Returns Boolean
75808>>>>>>>        Handle hwnd
75808>>>>>>>        Boolean bOk
75808>>>>>>>        Integer iStatus
75808>>>>>>>        Get ArePrintersInstalled to bOk
75809>>>>>>>        If not bOk Begin
75811>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
75812>>>>>>>>
75812>>>>>>>        End
75812>>>>>>>>
75812>>>>>>>        Else Begin
75813>>>>>>>            Get DocumentStatus to iStatus
75814>>>>>>>            
75814>>>>>>>            If (iStatus=dsNotStarted) Begin
75816>>>>>>>                Get Report_Window_Handle to hWnd
75817>>>>>>>                Move (WP_ExecutePrinterSetupDialog(hwnd)) to bOk
75818>>>>>>>                
75818>>>>>>>                // test that the selected printer is valid....
75818>>>>>>>                If bOK Begin
75820>>>>>>>                    Get IsPrinterValid to bOk // if printer not valid, it's not ok
75821>>>>>>>                    If not bOk Begin
75823>>>>>>>                        Error DFERR_WINPRINT DFPrintError936  // could not select a valid printer
75824>>>>>>>>
75824>>>>>>>                    End
75824>>>>>>>>
75824>>>>>>>                End
75824>>>>>>>>
75824>>>>>>>            End
75824>>>>>>>>
75824>>>>>>>            Else Begin
75825>>>>>>>               Error DFERR_WINPRINT DFPrintError966      // cannot change printer when report is active
75826>>>>>>>>
75826>>>>>>>            End
75826>>>>>>>>
75826>>>>>>>        End
75826>>>>>>>>
75826>>>>>>>        Function_Return bOk
75827>>>>>>>    End_Function
75828>>>>>>>
75828>>>>>>>
75828>>>>>>>    //*** Provided for backwards compatibility. DFPrintSetupDialog is more flexible because it returns a
75828>>>>>>>    //    false if cancel was selected.
75828>>>>>>>    Procedure DFPrintSetup
75830>>>>>>>        Boolean bOk
75830>>>>>>>        Get DFPrintSetupDialog to bOk
75831>>>>>>>    End_Procedure
75832>>>>>>>
75832>>>>>>>    //*** This invokes the print job dialog, prints the report, then clears the report document.
75832>>>>>>>    //    This should be called after the report is complete.
75832>>>>>>>    Procedure DFPrint
75834>>>>>>>        Integer bOk
75834>>>>>>>        Get DFPrintDialog To bOk
75835>>>>>>>        If bOk Begin
75837>>>>>>>            Send DFPrintDoc
75838>>>>>>>            Send DFClearDoc
75839>>>>>>>        End
75839>>>>>>>>
75839>>>>>>>    End_Procedure
75840>>>>>>>
75840>>>>>>>    Procedure DFSuspendGui boolean bSuspend
75842>>>>>>>        If (bSuspend<>pbIsSuspended(self)) begin
75844>>>>>>>            Send SuspendGui of Desktop bSuspend
75845>>>>>>>            Set pbIsSuspended to bSuspend
75846>>>>>>>        end
75846>>>>>>>>
75846>>>>>>>    end_procedure
75847>>>>>>>
75847>>>>>>>    // this is protected so that the queue is only pumped if the
75847>>>>>>>    // gui is suspended.
75847>>>>>>>    Procedure PumpMsgQueue
75849>>>>>>>        If (pbIsSuspended(self)) begin
75851>>>>>>>            Send PumpMsgQueue of desktop // permit painting
75852>>>>>>>        end
75852>>>>>>>>
75852>>>>>>>    end_procedure
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>    //*** This does a modeless preview. This is what you'd want during
75853>>>>>>>    //    report generation and it may be what you want for report viewing.
75853>>>>>>>    Procedure DFPreviewNoWait
75855>>>>>>>        Boolean bOk
75855>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
75855>>>>>>>        integer iStatus
75855>>>>>>>        Get PrintDlgInPreview to bPrntDlg
75856>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
75857>>>>>>>        Get EnablePrintFromPreview to bPrint
75858>>>>>>>        Get DocumentStatus to iStatus
75859>>>>>>>        If (iStatus=dsStarted) begin
75861>>>>>>>            Send DfSuspendGui True
75862>>>>>>>        end
75862>>>>>>>>
75862>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To bOk
75863>>>>>>>        If not bOk Begin
75865>>>>>>>            Error DFERR_WINPRINT DFPrintError901
75866>>>>>>>>
75866>>>>>>>            Send DfSuspendGui False
75867>>>>>>>        End
75867>>>>>>>>
75867>>>>>>>    End_Procedure
75868>>>>>>>
75868>>>>>>>
75868>>>>>>>    //*** This does a modal preview. You might want this for report
75868>>>>>>>    //    viewing as the program knows when the viewer is closed
75868>>>>>>>    // Note that this is a private message and it was never intended that this
75868>>>>>>>    // should be used. We expect winprint reports to use modeless viewers.
75868>>>>>>>    Procedure DFPreviewWait
75870>>>>>>>        Handle hViewerProcess
75870>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
75870>>>>>>>        Integer iRetVal
75870>>>>>>>        Integer hwMain hMain
75870>>>>>>>
75870>>>>>>>        Get PrintDlgInPreview to bPrntDlg
75871>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
75872>>>>>>>        Get EnablePrintFromPreview to bPrint
75873>>>>>>>
75873>>>>>>>        Send DfSuspendGui True
75874>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To hViewerProcess
75875>>>>>>>
75875>>>>>>>        If (hViewerProcess = 0) Begin
75877>>>>>>>            Error DFERR_WINPRINT DFPrintError901
75878>>>>>>>>
75878>>>>>>>        End
75878>>>>>>>>
75878>>>>>>>        Else Begin
75879>>>>>>>            // We need to wait for either the Viewer to close, or a WM_PAINT message in the thread's queue...
75879>>>>>>>            Repeat
75879>>>>>>>>
75879>>>>>>>               Move (MsgWaitForMultipleObjects(1, AddressOf(hViewerProcess), False, INFINITE, QS_PAINT)) To iRetVal
75880>>>>>>>               Send PumpMsgQueue // permit painting
75881>>>>>>>            Until (iRetVal = 0) // 0 means that the viewer process terminated
75883>>>>>>>        end
75883>>>>>>>>
75883>>>>>>>        Send DfSuspendGui False
75884>>>>>>>
75884>>>>>>>       // Do what we can to force VDF application to the top.
75884>>>>>>>       // As 12.0 dfSuspendGUI actually properly disables the underlying windows. When the viewer
75884>>>>>>>       // is closed it cannot give the focus back to this so it goes elsewhere. This will force it
75884>>>>>>>       // back. 
75884>>>>>>>
75884>>>>>>>       Get main_window of desktop to hMain
75885>>>>>>>       If hMain Begin
75887>>>>>>>          Get window_handle of hMain to hwMain
75888>>>>>>>          If hwMain Begin
75890>>>>>>>              If (GetForegroundWindow()<>hwMain) Begin
75892>>>>>>>                  Move (SetForegroundWindow(hwMain)) to hwMain
75893>>>>>>>              End
75893>>>>>>>>
75893>>>>>>>          End
75893>>>>>>>>
75893>>>>>>>       End
75893>>>>>>>>
75893>>>>>>>
75893>>>>>>>    End_Procedure
75894>>>>>>>
75894>>>>>>>    Procedure DfPreview
75896>>>>>>>        send DfPreviewNoWait
75897>>>>>>>    end_procedure
75898>>>>>>>
75898>>>>>>>
75898>>>>>>>    //***
75898>>>>>>>    Procedure DFPrintDoc
75900>>>>>>>        Handle hwnd
75900>>>>>>>        Boolean bOk
75900>>>>>>>        Get Report_Window_Handle to hWnd
75901>>>>>>>        Move (WP_PrintDocument(hwnd)) To bOk
75902>>>>>>>
75902>>>>>>>        If not bOk Begin
75904>>>>>>>            Error DFERR_WINPRINT DFPrintError902
75905>>>>>>>>
75905>>>>>>>        End
75905>>>>>>>>
75905>>>>>>>    End_Procedure
75906>>>>>>>
75906>>>>>>>
75906>>>>>>>    //***
75906>>>>>>>    Procedure DFClearDoc
75908>>>>>>>        Boolean bOk
75908>>>>>>>        Get ArePrintersInstalled to bOk
75909>>>>>>>        If bOk begin
75911>>>>>>>            Move (WP_ClearDocument()) To bOk
75912>>>>>>>            Send DFSuspendGUI False
75913>>>>>>>            If not bOk Begin
75915>>>>>>>               Error DFERR_WINPRINT DFPrintError903 // error number right?
75916>>>>>>>>
75916>>>>>>>            End
75916>>>>>>>>
75916>>>>>>>        End
75916>>>>>>>>
75916>>>>>>>    End_Procedure
75917>>>>>>>
75917>>>>>>>    Procedure DFNewDoc Boolean bAutoPreview
75919>>>>>>>        Boolean bOk
75919>>>>>>>        // this is the most likely place we will encounter when we start a report. Check for
75919>>>>>>>        // printers and return an explicit error to make it easy to identify the error
75919>>>>>>>        Get ArePrintersInstalled to bOk
75920>>>>>>>        If not bOk begin
75922>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
75923>>>>>>>>
75923>>>>>>>        end
75923>>>>>>>>
75923>>>>>>>        else begin
75924>>>>>>>            Send DfClearDoc //JJT - a new doc should always start with a clear
75925>>>>>>>            If bAutoPreview Send DFSuspendGUI True
75928>>>>>>>            Move (WP_NewDocument(bAutoPreview)) To bOk
75929>>>>>>>
75929>>>>>>>            If not bOk Begin
75931>>>>>>>               Error DFERR_WINPRINT DFPrintError902  // could not print document
75932>>>>>>>>
75932>>>>>>>               Send DFSuspendGUI False
75933>>>>>>>            End
75933>>>>>>>>
75933>>>>>>>        end
75933>>>>>>>>
75933>>>>>>>    End_Procedure
75934>>>>>>>
75934>>>>>>>    //***
75934>>>>>>>    Procedure DFSetFont String sFontName
75936>>>>>>>        boolean bOk
75936>>>>>>>        Move (WP_SetFontName(sFontName)) To bOk
75937>>>>>>>
75937>>>>>>>        If not bOK Begin
75939>>>>>>>            Error DFERR_WINPRINT DFPrintError904
75940>>>>>>>>
75940>>>>>>>        End
75940>>>>>>>>
75940>>>>>>>    End_Procedure
75941>>>>>>>
75941>>>>>>>
75941>>>>>>>    //***
75941>>>>>>>    Procedure DFSetFontSize Integer iHeight Integer iWidth
75943>>>>>>>        boolean bOk
75943>>>>>>>        // note that width is ignored in new implementation
75943>>>>>>>        Move (WP_SetFontHeight(iHeight)) To bOk
75944>>>>>>>
75944>>>>>>>        If not bOK Begin
75946>>>>>>>            Error DFERR_WINPRINT  DFPrintError905
75947>>>>>>>>
75947>>>>>>>        End
75947>>>>>>>>
75947>>>>>>>    End_Procedure
75948>>>>>>>
75948>>>>>>>
75948>>>>>>>    //***
75948>>>>>>>    Procedure DFSetFontStyle DWORD dwStyle
75950>>>>>>>        boolean bOk
75950>>>>>>>        Move (WP_SetFontStyle(dwStyle)) To bOk
75951>>>>>>>
75951>>>>>>>        If not bOK Begin
75953>>>>>>>            Error DFERR_WINPRINT DFPrintError906
75954>>>>>>>>
75954>>>>>>>        End
75954>>>>>>>>
75954>>>>>>>    End_Procedure
75955>>>>>>>
75955>>>>>>>
75955>>>>>>>    //***
75955>>>>>>>    Procedure DFSetUnderline boolean bUnderline
75957>>>>>>>        boolean bOk
75957>>>>>>>
75957>>>>>>>        Move (WP_SetFontUnderline(bUnderline)) To bOk
75958>>>>>>>
75958>>>>>>>        If not bOK Begin
75960>>>>>>>            Error DFERR_WINPRINT DFPrintError907
75961>>>>>>>>
75961>>>>>>>        End
75961>>>>>>>>
75961>>>>>>>    End_Procedure
75962>>>>>>>
75962>>>>>>>
75962>>>>>>>    //***
75962>>>>>>>    Procedure DFSetBold Boolean bBold
75964>>>>>>>        Boolean bOk
75964>>>>>>>
75964>>>>>>>        Move (WP_SetFontBold(bBold)) To bOk
75965>>>>>>>
75965>>>>>>>        If not bOK Begin
75967>>>>>>>            Error DFERR_WINPRINT DFPrintError908
75968>>>>>>>>
75968>>>>>>>        End
75968>>>>>>>>
75968>>>>>>>    End_Procedure
75969>>>>>>>
75969>>>>>>>
75969>>>>>>>    //***
75969>>>>>>>    Procedure DFSetItalic Boolean bItalic
75971>>>>>>>        Boolean bOk
75971>>>>>>>
75971>>>>>>>        Move (WP_SetFontItalic(bItalic)) To bOk
75972>>>>>>>
75972>>>>>>>        If not bOK Begin
75974>>>>>>>            Error DFERR_WINPRINT DFPrintError909
75975>>>>>>>>
75975>>>>>>>        End
75975>>>>>>>>
75975>>>>>>>    End_Procedure
75976>>>>>>>
75976>>>>>>>
75976>>>>>>>    //***
75976>>>>>>>    Procedure DFSetStrikeout Boolean bStrikeout
75978>>>>>>>        Boolean bOk
75978>>>>>>>
75978>>>>>>>        Move (WP_SetFontStrikeout(bStrikeout)) To bOk
75979>>>>>>>
75979>>>>>>>        If not bOK Begin
75981>>>>>>>            Error DFERR_WINPRINT DFPrintError910
75982>>>>>>>>
75982>>>>>>>        End
75982>>>>>>>>
75982>>>>>>>    End_Procedure
75983>>>>>>>
75983>>>>>>>
75983>>>>>>>    //***
75983>>>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
75985>>>>>>>        Boolean bOk
75985>>>>>>>        integer iLeft iRight iTop iBottom
75985>>>>>>>
75985>>>>>>>        Move (nLeft   * 100) to iLeft
75986>>>>>>>        Move (nRight  * 100) to iRight
75987>>>>>>>        Move (nTop    * 100) to iTop
75988>>>>>>>        Move (nBottom * 100) to iBottom
75989>>>>>>>
75989>>>>>>>        Move (WP_SetMargins(iLeft,iTop,iRight,iBottom)) To bOk
75990>>>>>>>
75990>>>>>>>        If bOk Begin
75992>>>>>>>            Set DFLeft_Margin   To nLeft
75993>>>>>>>            Set DFTop_Margin    To nTop
75994>>>>>>>            Set DFRight_Margin  To nRight
75995>>>>>>>            Set DFBottom_Margin To nBottom
75996>>>>>>>        End
75996>>>>>>>>
75996>>>>>>>        Else Begin
75997>>>>>>>            Error DFERR_WINPRINT DFPrintError911
75998>>>>>>>>
75998>>>>>>>        End
75998>>>>>>>>
75998>>>>>>>    End_Procedure
75999>>>>>>>
75999>>>>>>>
75999>>>>>>>    //***
75999>>>>>>>    Procedure DFSetLeftMargin Number nLeft
76001>>>>>>>        number  nTop nRight nBottom
76001>>>>>>>        Get DFTop_Margin    To nTop
76002>>>>>>>        Get DFRight_Margin  To nRight
76003>>>>>>>        Get DFBottom_Margin To nBottom
76004>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
76005>>>>>>>    End_Procedure
76006>>>>>>>
76006>>>>>>>
76006>>>>>>>    //***
76006>>>>>>>    Procedure DFSetRightMargin Number nRight
76008>>>>>>>        number  nLeft nTop nBottom
76008>>>>>>>        Get DFLeft_Margin   To nLeft
76009>>>>>>>        Get DFTop_Margin    To nTop
76010>>>>>>>        Get DFBottom_Margin To nBottom
76011>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
76012>>>>>>>    End_Procedure
76013>>>>>>>
76013>>>>>>>
76013>>>>>>>    //***
76013>>>>>>>    Procedure DFSetTopMargin Number nTop
76015>>>>>>>        number  nLeft nRight nBottom
76015>>>>>>>        Get DFLeft_Margin   To nLeft
76016>>>>>>>        Get DFRight_Margin  To nRight
76017>>>>>>>        Get DFBottom_Margin To nBottom
76018>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
76019>>>>>>>    End_Procedure
76020>>>>>>>
76020>>>>>>>
76020>>>>>>>    //***
76020>>>>>>>    Procedure DFSetBottomMargin Number nBottom
76022>>>>>>>        number  nLeft nTop nRight
76022>>>>>>>        Get DFLeft_Margin   To nLeft
76023>>>>>>>        Get DFTop_Margin    To nTop
76024>>>>>>>        Get DFRight_Margin  To nRight
76025>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
76026>>>>>>>    End_Procedure
76027>>>>>>>
76027>>>>>>>
76027>>>>>>>    //***
76027>>>>>>>    Procedure DFWriteText String sText Integer iStyle Integer iColumn Integer iDecimal Boolean bNewLineAfterPrint
76029>>>>>>>        Boolean bOk
76029>>>>>>>
76029>>>>>>>        Send DFSetFontStyle iStyle
76030>>>>>>>        Get ToAnsi sText To sText
76031>>>>>>>        Move (WP_WriteText(sText,bNewLineAfterPrint,iColumn,iDecimal,0)) To bOk
76032>>>>>>>        If not bOk Begin
76034>>>>>>>            Error DFERR_WINPRINT DFPrintError918
76035>>>>>>>>
76035>>>>>>>        End
76035>>>>>>>>
76035>>>>>>>        Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
76036>>>>>>>    End_Procedure
76037>>>>>>>
76037>>>>>>>    //***
76037>>>>>>>    Procedure DFWrite String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
76039>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
76041>>>>>>>            Move (Rtrim(sText)) to sText
76042>>>>>>>        end
76042>>>>>>>>
76042>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal False
76043>>>>>>>    End_Procedure
76044>>>>>>>
76044>>>>>>>    //***
76044>>>>>>>    Procedure DFWriteLn String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
76046>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
76048>>>>>>>            Move (Rtrim(sText)) to sText
76049>>>>>>>        end
76049>>>>>>>>
76049>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal True
76050>>>>>>>    End_Procedure
76051>>>>>>>
76051>>>>>>>
76051>>>>>>>    //***
76051>>>>>>>    Procedure DFWriteTextAtPosition String sText integer iStyle Number nPosition Integer iDecimal ;                                    Number nMaxLength Boolean bNewLineAfterPrint
76053>>>>>>>        Boolean bOk
76053>>>>>>>        Integer iPosition iMaxLength
76053>>>>>>>        Send DFSetFontStyle iStyle
76054>>>>>>>        Get ToAnsi sText To sText
76055>>>>>>>        Move (nPosition * 100) to iPosition
76056>>>>>>>        Move (nMaxLength * 100) to iMaxLength
76057>>>>>>>        Move (WP_WriteTextAtPosition(sText,bNewLineAfterPrint,iPosition,iDecimal,iMaxLength)) To bOk
76058>>>>>>>        If not bOk Begin
76060>>>>>>>            Error DFERR_WINPRINT DFPrintError922
76061>>>>>>>>
76061>>>>>>>        End
76061>>>>>>>>
76061>>>>>>>         Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
76062>>>>>>>    End_Procedure
76063>>>>>>>
76063>>>>>>>    //***
76063>>>>>>>    Procedure DFWritePos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
76065>>>>>>>        Number nMax
76065>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
76067>>>>>>>            Move (Rtrim(sText)) to sText
76068>>>>>>>        end
76068>>>>>>>>
76068>>>>>>>
76068>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
76071>>>>>>>        Else ;            Move nMaxLength to nMax
76073>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax False
76074>>>>>>>    End_Procedure
76075>>>>>>>
76075>>>>>>>    //***
76075>>>>>>>    Procedure DFWriteLnPos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
76077>>>>>>>        Number nMax
76077>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
76079>>>>>>>            Move (Rtrim(sText)) to sText
76080>>>>>>>        end
76080>>>>>>>>
76080>>>>>>>
76080>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
76083>>>>>>>        Else ;            Move nMaxLength to nMax
76085>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax True
76086>>>>>>>    End_Procedure
76087>>>>>>>
76087>>>>>>>    Procedure DFSetMetrics String sMetrics
76089>>>>>>>        integer eMetrics
76089>>>>>>>        // for backwards compatibility support both string names and integer enumerations
76089>>>>>>>        // it is better to use the enumeration value
76089>>>>>>>        If (sMetrics="INCH" or sMetrics="CM") Begin
76091>>>>>>>            Set DFCurrent_Metrics to sMetrics
76092>>>>>>>        end
76092>>>>>>>>
76092>>>>>>>        else Begin
76093>>>>>>>            Move sMetrics to eMetrics
76094>>>>>>>            Move (WP_SetMetrics(eMetrics)) To eMetrics
76095>>>>>>>        End
76095>>>>>>>>
76095>>>>>>>    End_Procedure
76096>>>>>>>
76096>>>>>>>    Function DFGetMetrics Returns Integer
76098>>>>>>>        Integer eMetrics
76098>>>>>>>        Move (WP_GetMetrics()) To eMetrics
76099>>>>>>>        Function_return eMetrics
76100>>>>>>>    End_Function
76101>>>>>>>
76101>>>>>>>
76101>>>>>>>    //**** Properties Maintained for compatibility with old Winprint (obsolete)
76101>>>>>>>    Function DFCurrent_Metrics returns string
76103>>>>>>>        Integer eMetrics
76103>>>>>>>        Get DFGetMetrics to eMetrics
76104>>>>>>>        Function_return (if(eMetrics=WPM_INCH,"INCH","CM"))
76105>>>>>>>    end_function
76106>>>>>>>
76106>>>>>>>    Procedure Set DFCurrent_Metrics string sCMorINCH
76108>>>>>>>        Send DFSetMetrics (if(sCMorINCH="INCH", WPM_INCH, WPM_CM))
76109>>>>>>>    End_Procedure
76110>>>>>>>
76110>>>>>>>
76110>>>>>>>
76110>>>>>>>
76110>>>>>>>
76110>>>>>>>    //***
76110>>>>>>>    Procedure DFBeginHeaderType Integer iHeaderNr Integer eHeaderType
76112>>>>>>>        Boolean bOk
76112>>>>>>>
76112>>>>>>>        If (eHeaderType=DFSubHeader or eHeaderType=DFSubTotal) Begin
76114>>>>>>>            //*** Do nothing for the moment
76114>>>>>>>        End
76114>>>>>>>>
76114>>>>>>>        Else ;            Move 0 to iHeaderNr // If the user made a mistake
76116>>>>>>>
76116>>>>>>>        Set DFCurrent_HeaderType To eHeaderType
76117>>>>>>>        Set DFCurrent_HeaderNr   To iHeaderNr
76118>>>>>>>
76118>>>>>>>        Move (WP_BeginHeader(eHeaderType, iHeaderNr)) To bOk
76119>>>>>>>
76119>>>>>>>        If not bOk Begin
76121>>>>>>>            Error DFERR_WINPRINT DFPrintError925
76122>>>>>>>>
76122>>>>>>>        End
76122>>>>>>>>
76122>>>>>>>    End_Procedure
76123>>>>>>>
76123>>>>>>>
76123>>>>>>>    //***
76123>>>>>>>    Procedure DFEndHeaderType
76125>>>>>>>        Boolean bOk
76125>>>>>>>
76125>>>>>>>        Move (WP_EndHeader()) To bOk
76126>>>>>>>
76126>>>>>>>        if not bOk begin
76128>>>>>>>            Error DFERR_WINPRINT DFPrintError926
76129>>>>>>>>
76129>>>>>>>        End
76129>>>>>>>>
76129>>>>>>>    End_Procedure
76130>>>>>>>
76130>>>>>>>
76130>>>>>>>    //***
76130>>>>>>>    Procedure DFWriteHeaderType Integer iHeaderNr Integer eHeaderType
76132>>>>>>>        Boolean bOk
76132>>>>>>>        Move (WP_WriteHeader(eHeaderType, iHeaderNr)) To bOk
76133>>>>>>>        if not bOk begin
76135>>>>>>>            Error DFERR_WINPRINT DFPrintError927
76136>>>>>>>>
76136>>>>>>>        End
76136>>>>>>>>
76136>>>>>>>    End_Procedure
76137>>>>>>>
76137>>>>>>>
76137>>>>>>>    //***
76137>>>>>>>    Procedure DFHeaderPosition Integer ePlace
76139>>>>>>>        Boolean bOk
76139>>>>>>>
76139>>>>>>>         Move (WP_SetHeaderPlacement(ePlace)) To bOk
76140>>>>>>>
76140>>>>>>>         if not bOk begin
76142>>>>>>>            Error DFERR_WINPRINT DFPrintError929
76143>>>>>>>>
76143>>>>>>>        End
76143>>>>>>>>
76143>>>>>>>    End_Procedure
76144>>>>>>>
76144>>>>>>>
76144>>>>>>>    //***
76144>>>>>>>    Procedure DFHeaderFrameType Integer eFrame integer iColor Number nWeight;                                Integer iFillColor Boolean bFillFrame
76146>>>>>>>        Integer iWeight
76146>>>>>>>        Boolean bOk
76146>>>>>>>
76146>>>>>>>        move (nWeight*100) To iWeight
76147>>>>>>>
76147>>>>>>>        Move (WP_SetHeaderFrame(eFrame,iColor,iWeight,iFillColor,bFillFrame)) To bOk
76148>>>>>>>
76148>>>>>>>         if not bOk begin
76150>>>>>>>            Error DFERR_WINPRINT DFPrintError930
76151>>>>>>>>
76151>>>>>>>        End
76151>>>>>>>>
76151>>>>>>>    End_Procedure
76152>>>>>>>
76152>>>>>>>  Procedure DFHeaderMargin Integer eType Number nSize
76154>>>>>>>        Boolean bOk
76154>>>>>>>        Integer iSize
76154>>>>>>>
76154>>>>>>>        move (nSize * 100) to iSize
76155>>>>>>>
76155>>>>>>>        move (WP_SetHeaderMargin(eType, iSize)) To bOk
76156>>>>>>>
76156>>>>>>>        if not bOk begin
76158>>>>>>>            Error DFERR_WINPRINT DFPrintError930
76159>>>>>>>>
76159>>>>>>>        end
76159>>>>>>>>
76159>>>>>>>    End_Procedure
76160>>>>>>>
76160>>>>>>>
76160>>>>>>>    //***
76160>>>>>>>    Procedure DFHeaderWrap Integer eOnOff
76162>>>>>>>         Boolean bOk
76162>>>>>>>
76162>>>>>>>         Move (WP_SetHeaderWrap(eOnOff)) To bOk
76163>>>>>>>
76163>>>>>>>         if not bOk begin
76165>>>>>>>            Error DFERR_WINPRINT DFPrintError931
76166>>>>>>>>
76166>>>>>>>        End
76166>>>>>>>>
76166>>>>>>>    End_Procedure
76167>>>>>>>
76167>>>>>>>    //***
76167>>>>>>>    Procedure DFWriteBMP String sFileName Number nStartX Number nStartY Number nHeight Number nWidth Boolean bUCp
76169>>>>>>>        Boolean bOk
76169>>>>>>>        Integer iStartX iStartY iHeight iWidth
76169>>>>>>>
76169>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX to iStartX
76172>>>>>>>        else ;            move (nStartX*100) To iStartX
76174>>>>>>>
76174>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY to iStartY
76177>>>>>>>        else ;            move (nStartY*100) To iStartY
76179>>>>>>>
76179>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
76182>>>>>>>        else ;            move (nWidth*100) To iWidth
76184>>>>>>>
76184>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
76187>>>>>>>        else ;            move (nHeight*100) To iHeight
76189>>>>>>>
76189>>>>>>>        Get_File_Path sFileName To sFileName
76190>>>>>>>        Move (WP_DrawBitmap(sFileName,iStartX,iStartY,iWidth,iHeight,bUCp)) to bOk
76191>>>>>>>
76191>>>>>>>        If not bOk Begin
76193>>>>>>>            Error DFERR_WINPRINT DFPrintError932
76194>>>>>>>>
76194>>>>>>>        End
76194>>>>>>>>
76194>>>>>>>    End_Procedure
76195>>>>>>>
76195>>>>>>>
76195>>>>>>>    //***
76195>>>>>>>    Procedure DFHeaderLineCheck Integer iLines
76197>>>>>>>        Boolean bOk
76197>>>>>>>
76197>>>>>>>         Move (WP_SetExtraLineCheck(iLines)) To bOk
76198>>>>>>>
76198>>>>>>>        If not bOk begin
76200>>>>>>>            Error DFERR_WINPRINT DFPrintError934
76201>>>>>>>>
76201>>>>>>>        End
76201>>>>>>>>
76201>>>>>>>    End_Procedure
76202>>>>>>>
76202>>>>>>>
76202>>>>>>>    //***
76202>>>>>>>    Procedure DFPrintFlags Integer Flags
76204>>>>>>>        Boolean bOk
76204>>>>>>>
76204>>>>>>>         Move (WP_SetPrintDialogFlags(Flags)) To bOk
76205>>>>>>>
76205>>>>>>>        If not bOk begin
76207>>>>>>>            Error DFERR_WINPRINT DFPrintError935
76208>>>>>>>>
76208>>>>>>>        End
76208>>>>>>>>
76208>>>>>>>    End_Procedure
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>    //*** obsolete and maintained for winprint-I backwards compatibility (maybe should be removed)
76209>>>>>>>    //
76209>>>>>>>    Procedure DFSelectPrinter String sDriver String sDevice String sPort Boolean bUpdate
76211>>>>>>>        Send DFSetDevice sDevice
76212>>>>>>>    End_Procedure
76213>>>>>>>
76213>>>>>>>    //*** Preferred usage for WinprintII
76213>>>>>>>    Procedure DFSetDevice String sDevice
76215>>>>>>>        Boolean bOk
76215>>>>>>>
76215>>>>>>>        Move (WP_SelectPrinter(sDevice)) To bOk
76216>>>>>>>
76216>>>>>>>        If not bOk Begin
76218>>>>>>>            Error DFERR_WINPRINT DFPrintError936
76219>>>>>>>>
76219>>>>>>>        End
76219>>>>>>>>
76219>>>>>>>    End_Procedure
76220>>>>>>>
76220>>>>>>>    Procedure DFPrinterBinFirstPage Integer eBin
76222>>>>>>>        Boolean bOk
76222>>>>>>>
76222>>>>>>>         Move (WP_SetFirstPagePaperSource(eBin)) To bOk
76223>>>>>>>
76223>>>>>>>        If not bOk Begin
76225>>>>>>>            Error DFERR_WINPRINT DFPrintError937
76226>>>>>>>>
76226>>>>>>>        End
76226>>>>>>>>
76226>>>>>>>    End_Procedure
76227>>>>>>>
76227>>>>>>>
76227>>>>>>>    //***
76227>>>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
76229>>>>>>>        Integer iColor
76229>>>>>>>
76229>>>>>>>         Move (WP_RGBToDFPrintColor(iRed,iGreen,iBlue)) To iColor
76230>>>>>>>
76230>>>>>>>        If (iColor=0) Begin
76232>>>>>>>            Error DFERR_WINPRINT DFPrintError938
76233>>>>>>>>
76233>>>>>>>        End
76233>>>>>>>>
76233>>>>>>>        Function_Return iColor
76234>>>>>>>    End_Function
76235>>>>>>>
76235>>>>>>>
76235>>>>>>>    //***
76235>>>>>>>    Procedure DFSetDFColor Dword dwColor
76237>>>>>>>        Integer bOk
76237>>>>>>>
76237>>>>>>>         Move (WP_SetFontColor(dwColor)) To bOk
76238>>>>>>>
76238>>>>>>>        If not bOk Begin
76240>>>>>>>            Error DFERR_WINPRINT DFPrintError939
76241>>>>>>>>
76241>>>>>>>        End
76241>>>>>>>>
76241>>>>>>>    End_Procedure
76242>>>>>>>
76242>>>>>>>
76242>>>>>>>    //***
76242>>>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
76244>>>>>>>        Boolean bOk
76244>>>>>>>        Integer iTop iBottom
76244>>>>>>>
76244>>>>>>>        move (nTop*100)    To iTop
76245>>>>>>>        move (nBottom*100) To iBottom
76246>>>>>>>
76246>>>>>>>        Move (WP_SetAbsoluteMargins(iTop,iBottom,bAllPages)) To bOk
76247>>>>>>>
76247>>>>>>>        If Not bOk Begin
76249>>>>>>>            Error DFERR_WINPRINT DFPrintError940
76250>>>>>>>>
76250>>>>>>>        End
76250>>>>>>>>
76250>>>>>>>    End_Procedure
76251>>>>>>>
76251>>>>>>>
76251>>>>>>>    //***
76251>>>>>>>    Procedure DFSetJMode Integer eAlign
76253>>>>>>>        Boolean bOk
76253>>>>>>>
76253>>>>>>>        Move (WP_SetAlign(eAlign)) To bOk
76254>>>>>>>
76254>>>>>>>        If Not bOk Begin
76256>>>>>>>            Error DFERR_WINPRINT DFPrintError941
76257>>>>>>>>
76257>>>>>>>        End
76257>>>>>>>>
76257>>>>>>>    End_Procedure
76258>>>>>>>
76258>>>>>>>
76258>>>>>>>    //***
76258>>>>>>>    Procedure DFWriteEllip Number nStartX Number nStartY Number nHeight Number nWidth ;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
76260>>>>>>>
76260>>>>>>>        Boolean bOk
76260>>>>>>>        Integer iWeight
76260>>>>>>>        Integer iStartX iStartY iHeight iWidth
76260>>>>>>>
76260>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
76263>>>>>>>        else ;            move (nStartX*100) To iStartX
76265>>>>>>>
76265>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
76268>>>>>>>        else ;            move (nStartY*100) To iStartY
76270>>>>>>>
76270>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
76273>>>>>>>        else ;            move (nWidth*100) To iWidth
76275>>>>>>>
76275>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
76278>>>>>>>        else ;            move (nHeight*100) To iHeight
76280>>>>>>>
76280>>>>>>>        move (nWeight*100) To iWeight
76281>>>>>>>
76281>>>>>>>
76281>>>>>>>        Move (WP_DrawEllipse(iStartX,iStartY,iWidth,iHeight,;                        dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
76282>>>>>>>
76282>>>>>>>        If Not bOk Begin
76284>>>>>>>            Error DFERR_WINPRINT DFPrintError942
76285>>>>>>>>
76285>>>>>>>        End
76285>>>>>>>>
76285>>>>>>>    End_Procedure
76286>>>>>>>
76286>>>>>>>
76286>>>>>>>
76286>>>>>>>
76286>>>>>>>    //***
76286>>>>>>>    Procedure DFWriteRect Number nStartX Number nStartY Number nHeight Number nWidth;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
76288>>>>>>>
76288>>>>>>>        Boolean bOk
76288>>>>>>>        Integer iWeight
76288>>>>>>>        Integer iStartX iStartY iHeight iWidth
76288>>>>>>>
76288>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
76291>>>>>>>        else ;            move (nStartX*100) To iStartX
76293>>>>>>>
76293>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
76296>>>>>>>        else ;            move (nStartY*100) To iStartY
76298>>>>>>>
76298>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
76301>>>>>>>        else ;            move (nWidth*100) To iWidth
76303>>>>>>>
76303>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
76306>>>>>>>        else ;            move (nHeight*100) To iHeight
76308>>>>>>>
76308>>>>>>>        move (nWeight*100) To iWeight
76309>>>>>>>
76309>>>>>>>        Move (WP_DrawRectangle(iStartX,iStartY,iWidth,iHeight,;                            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
76310>>>>>>>
76310>>>>>>>        If Not bOk Begin
76312>>>>>>>            Error DFERR_WINPRINT DFPrintError944
76313>>>>>>>>
76313>>>>>>>        End
76313>>>>>>>>
76313>>>>>>>    End_Procedure
76314>>>>>>>
76314>>>>>>>
76314>>>>>>>
76314>>>>>>>
76314>>>>>>>    //***
76314>>>>>>>    Procedure DFLineCheck Integer iLines
76316>>>>>>>        Boolean bOk
76316>>>>>>>
76316>>>>>>>        Move (WP_ConfirmLines(iLines)) To bOk
76317>>>>>>>
76317>>>>>>>        If Not bOk Begin
76319>>>>>>>            Error DFERR_WINPRINT DFPrintError946
76320>>>>>>>>
76320>>>>>>>        End
76320>>>>>>>>
76320>>>>>>>    End_Procedure
76321>>>>>>>
76321>>>>>>>
76321>>>>>>>    //***
76321>>>>>>>    Procedure DFCreateDiagram Integer eType Integer eFx Number nHeight Number nWidth Integer bXyAxis
76323>>>>>>>        Handle hDiagram
76323>>>>>>>        Integer iWidth iHeight
76323>>>>>>>
76323>>>>>>>        move (nHeight*100) To iHeight
76324>>>>>>>        move (nWidth*100)  To iWidth
76325>>>>>>>
76325>>>>>>>        Set DFCurrent_Color To 0
76326>>>>>>>
76326>>>>>>>        Move (WP_CreateDiagram(eType,eFx,iWidth,iHeight,bXyAxis)) To hDiagram
76327>>>>>>>
76327>>>>>>>        If (hDiagram) Begin
76329>>>>>>>            Error DFERR_WINPRINT DFPrintError947
76330>>>>>>>>
76330>>>>>>>        End
76330>>>>>>>>
76330>>>>>>>        Else Begin
76331>>>>>>>            Set DFCurrent_Diagram To hDiagram
76332>>>>>>>        end
76332>>>>>>>>
76332>>>>>>>    End_Procedure
76333>>>>>>>
76333>>>>>>>
76333>>>>>>>    //***
76333>>>>>>>    Procedure DFDiagram_Item handle hDiagram String sLabel Number nValue;                             Dword dwBColor Dword dwFColor Integer eFill;                             Integer iDec Integer eValueOrPercent Integer eExt
76335>>>>>>>
76335>>>>>>>        Boolean bOk
76335>>>>>>>        Integer iCurrColor iValue
76335>>>>>>>
76335>>>>>>>        If (dwFColor = -1) Begin
76337>>>>>>>            Get DFCurrent_Color To iCurrColor
76338>>>>>>>            Increment iCurrColor
76339>>>>>>>            If (iCurrColor>15) Move 1 To iCurrColor
76342>>>>>>>            Set DFCurrent_Color To iCurrColor
76343>>>>>>>            Get DFGetColor iCurrColor To dwFColor
76344>>>>>>>        End
76344>>>>>>>>
76344>>>>>>>
76344>>>>>>>        Move (nValue *100) to iValue
76345>>>>>>>
76345>>>>>>>        Get ToAnsi sLabel To sLabel
76346>>>>>>>
76346>>>>>>>        Move (WP_AddDiagramEntry(hDiagram,sLabel,iValue,dwBColor,dwFColor,eFill,iDec,eValueorPercent,eExt)) To bOk
76347>>>>>>>
76347>>>>>>>        If not bOk Begin
76349>>>>>>>            Error DFERR_WINPRINT DFPrintError948
76350>>>>>>>>
76350>>>>>>>        End
76350>>>>>>>>
76350>>>>>>>    End_Procedure
76351>>>>>>>
76351>>>>>>>
76351>>>>>>>    //***
76351>>>>>>>    Procedure DFLockDiagram Handle hDiagram
76353>>>>>>>        Boolean bOk
76353>>>>>>>
76353>>>>>>>        Move (WP_LockDiagram(hDiagram)) To bOk
76354>>>>>>>
76354>>>>>>>        If not bOk Begin
76356>>>>>>>            Error DFERR_WINPRINT DFPrintError949
76357>>>>>>>>
76357>>>>>>>        End
76357>>>>>>>>
76357>>>>>>>    End_Procedure
76358>>>>>>>
76358>>>>>>>
76358>>>>>>>
76358>>>>>>>    //***
76358>>>>>>>    Procedure DFDrawDiagram Handle hDiagram Number nYPos Number nXPos Boolean bUCp
76360>>>>>>>        Boolean bOk
76360>>>>>>>        Integer iXPos
76360>>>>>>>        Integer iYPos
76360>>>>>>>
76360>>>>>>>        move (nXPos*100) To iXPos
76361>>>>>>>        move (nYPos*100) To iYPos
76362>>>>>>>
76362>>>>>>>        If nYPos Eq -999 Move -999 To iYPos
76365>>>>>>>
76365>>>>>>>        Move (WP_DrawDiagram(hDiagram,iXPos,iYPos,bUCp)) To bOk
76366>>>>>>>
76366>>>>>>>        If not bOk Begin
76368>>>>>>>            Error DFERR_WINPRINT DFPrintError950
76369>>>>>>>>
76369>>>>>>>        End
76369>>>>>>>>
76369>>>>>>>    End_Procedure
76370>>>>>>>
76370>>>>>>>
76370>>>>>>>
76370>>>>>>>    //***
76370>>>>>>>    Procedure DFDiagramLabel handle hDiagram String sLabel
76372>>>>>>>        Boolean bOk
76372>>>>>>>        Integer iLabelLen
76372>>>>>>>
76372>>>>>>>        Get ToAnsi sLabel To sLabel
76373>>>>>>>
76373>>>>>>>        Move (WP_SetDiagramCaption(hDiagram,sLabel)) To bOk
76374>>>>>>>
76374>>>>>>>        if not bOk Begin
76376>>>>>>>            Error DFERR_WINPRINT DFPrintError952
76377>>>>>>>>
76377>>>>>>>        End
76377>>>>>>>>
76377>>>>>>>    End_Procedure
76378>>>>>>>
76378>>>>>>>
76378>>>>>>>    //***
76378>>>>>>>    Procedure DFDiagramXLabel handle hDiagram String sLabel
76380>>>>>>>        Boolean bOk
76380>>>>>>>        Get ToAnsi sLabel To sLabel
76381>>>>>>>
76381>>>>>>>        Move (WP_SetDiagramXText(hDiagram,sLabel)) To bOk
76382>>>>>>>
76382>>>>>>>        if not bOk Begin
76384>>>>>>>            Error DFERR_WINPRINT DFPrintError953
76385>>>>>>>>
76385>>>>>>>        End
76385>>>>>>>>
76385>>>>>>>    End_Procedure
76386>>>>>>>
76386>>>>>>>
76386>>>>>>>    //***
76386>>>>>>>    Procedure DFDiagramYLabel handle hDiagram String sLabel Boolean bVertical
76388>>>>>>>        Boolean bOk
76388>>>>>>>        Get ToAnsi sLabel To sLabel
76389>>>>>>>
76389>>>>>>>        Move (WP_SetDiagramYText(hDiagram,sLabel,bVertical)) To bOk
76390>>>>>>>
76390>>>>>>>        if not bOk Begin
76392>>>>>>>            Error DFERR_WINPRINT DFPrintError954
76393>>>>>>>>
76393>>>>>>>        End
76393>>>>>>>>
76393>>>>>>>    End_Procedure
76394>>>>>>>
76394>>>>>>>
76394>>>>>>>    //***
76394>>>>>>>    Procedure DFWriteXYLine Number nStartX Number nStartY Number nStopX Number nStopY;              Dword dwColor Number nWeight Boolean bWrap Boolean bUCp
76396>>>>>>>
76396>>>>>>>        Boolean bOk
76396>>>>>>>        Integer iStartX iStartY iStopX iStopY
76396>>>>>>>        Integer iWeight
76396>>>>>>>
76396>>>>>>>        move (nStartX*100)  To iStartX
76397>>>>>>>        move (nStartY*100)  To iStartY
76398>>>>>>>        move (nStopX*100)   To iStopX
76399>>>>>>>        move (nStopY*100)   To iStopY
76400>>>>>>>
76400>>>>>>>        move (nWeight*100) To iWeight
76401>>>>>>>
76401>>>>>>>        If (nStopY  = -998) Move -998 To iStopY
76404>>>>>>>        If (nStopX  = -998) Move -998 To iStopX
76407>>>>>>>
76407>>>>>>>        If (nStartY  = -999) Move -999 To iStartY
76410>>>>>>>        If (nStartX  = -999) Move -999 To iStartX
76413>>>>>>>
76413>>>>>>>        Move (WP_DrawXYLine(iStartX,iStartY,iStopX,iStopY,dwColor,iWeight,bUCp,bWrap)) To bOk
76414>>>>>>>
76414>>>>>>>        if not bOk Begin
76416>>>>>>>            Error DFERR_WINPRINT DFPrintError955
76417>>>>>>>>
76417>>>>>>>        End
76417>>>>>>>>
76417>>>>>>>    End_Procedure
76418>>>>>>>
76418>>>>>>>
76418>>>>>>>    //***
76418>>>>>>>    Procedure DFWriteLine Number nStartX Number nStartY Number nLength;                          Boolean bHorizontal Dword dwColor Number nWeight Boolean bUCp
76420>>>>>>>
76420>>>>>>>        Boolean bOk
76420>>>>>>>        Integer iStartX iStartY iLength
76420>>>>>>>        Integer iWeight
76420>>>>>>>
76420>>>>>>>        move (nStartX*100)  To iStartX
76421>>>>>>>        move (nStartY*100)  To iStartY
76422>>>>>>>        move (nLength*100)  To iLength
76423>>>>>>>        move (nWeight*100)  To iWeight
76424>>>>>>>
76424>>>>>>>        If (nStartY = -999) Move -999 To iStartY
76427>>>>>>>        If (nStartX = -999) Move -999 To iStartX
76430>>>>>>>        If (nLength = -998) Move -998 To iLength
76433>>>>>>>
76433>>>>>>>        Move (WP_DrawLine(iSTartX,iStartY,iLength,bHorizontal,dwColor,iWeight,bUCp)) To bOk
76434>>>>>>>
76434>>>>>>>        if not bOk Begin
76436>>>>>>>            Error DFERR_WINPRINT DFPrintError956
76437>>>>>>>>
76437>>>>>>>        End
76437>>>>>>>>
76437>>>>>>>    End_Procedure
76438>>>>>>>
76438>>>>>>>
76438>>>>>>>    //***
76438>>>>>>>    Procedure DFClearPrinter
76440>>>>>>>        Boolean bOk
76440>>>>>>>
76440>>>>>>>        Move (WP_ClearPrinter()) To bOk
76441>>>>>>>
76441>>>>>>>        If not bOk Begin
76443>>>>>>>            Error DFERR_WINPRINT DFPrintError957
76444>>>>>>>>
76444>>>>>>>        End
76444>>>>>>>>
76444>>>>>>>    End_Procedure
76445>>>>>>>
76445>>>>>>>
76445>>>>>>>
76445>>>>>>>    //***
76445>>>>>>>     Function DFGetCurrentDevice Returns String
76447>>>>>>>        Boolean bOk
76447>>>>>>>        String  sDFStr
76447>>>>>>>        Address pDFStr
76447>>>>>>>
76447>>>>>>>        Move (Repeat( Character(0), 255 )) to sDFStr
76448>>>>>>>        GetAddress of sDFStr to pDFStr
76449>>>>>>>
76449>>>>>>>        Move (WP_GetCurrentDevice(pDFStr)) To bOk
76450>>>>>>>
76450>>>>>>>        If not bOk Begin
76452>>>>>>>            Error DFERR_WINPRINT DFPrintError959
76453>>>>>>>>
76453>>>>>>>        End
76453>>>>>>>>
76453>>>>>>>
76453>>>>>>>        Move (CString(sDFStr)) To sDFStr
76454>>>>>>>        Function_Return sDFStr
76455>>>>>>>     End_Function
76456>>>>>>>
76456>>>>>>>
76456>>>>>>>    // Note: DfGetCurrentPort and DFGetCurrentDriver do not exist in winprint2. Trying to
76456>>>>>>>    //       use these will result in a runtime error (which is good - don't use them)
76456>>>>>>>
76456>>>>>>>
76456>>>>>>>    //***
76456>>>>>>>     Function DFGetPrintDialogFlags Returns Dword
76458>>>>>>>        Dword dwRetVal
76458>>>>>>>
76458>>>>>>>        Move (WP_GetPrintDialogFlags()) To dwRetVal
76459>>>>>>>
76459>>>>>>>        Function_Return dwRetVal
76460>>>>>>>     End_Function
76461>>>>>>>
76461>>>>>>>
76461>>>>>>>    //***
76461>>>>>>>    //*** Returns PRN_TRUE=  if the flag is set     (1)
76461>>>>>>>    //*** Returns PRN_FALSE= If the flag not is set (0)
76461>>>>>>>    //***
76461>>>>>>>     Function DFCheckPrintDialogFlag Dword dwPDFlag Returns Boolean
76463>>>>>>>        Boolean bIsSet
76463>>>>>>>
76463>>>>>>>        Move (WP_IsPrintDialogFlagSet(dwPDFlag)) To bIsSet
76464>>>>>>>
76464>>>>>>>        Function_Return bIsSet
76465>>>>>>>     End_Function
76466>>>>>>>
76466>>>>>>>
76466>>>>>>>    //***
76466>>>>>>>     Procedure DFSetSpecPrintFlag Dword dwPDFlag
76468>>>>>>>        Boolean bOk
76468>>>>>>>
76468>>>>>>>        Move (WP_SetSpecificPrintDialogFlag(dwPDFlag)) To bOk
76469>>>>>>>
76469>>>>>>>        If not bOk Begin
76471>>>>>>>            Error DFERR_WINPRINT DFPrintError961
76472>>>>>>>>
76472>>>>>>>        End
76472>>>>>>>>
76472>>>>>>>     End_Procedure
76473>>>>>>>
76473>>>>>>>
76473>>>>>>>    //***
76473>>>>>>>     Function DFGetUserDefinedLength Returns Number
76475>>>>>>>        Integer iRetVal
76475>>>>>>>        Number  nRetVal
76475>>>>>>>
76475>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
76476>>>>>>>
76476>>>>>>>        If (iRetVal=0) Begin
76478>>>>>>>            Error DFERR_WINPRINT DFPrintError962
76479>>>>>>>>
76479>>>>>>>            Function_Return 0
76480>>>>>>>        End
76480>>>>>>>>
76480>>>>>>>
76480>>>>>>>        Move (Hi(iRetVal)) To nRetVal
76481>>>>>>>        move (nRetVal/100) To nRetVal //Returns CM
76482>>>>>>>
76482>>>>>>>        Function_Return nRetVal
76483>>>>>>>     End_Function
76484>>>>>>>
76484>>>>>>>
76484>>>>>>>    //***
76484>>>>>>>     Function DFGetUserDefinedWidth Returns Number
76486>>>>>>>        Integer iRetVal
76486>>>>>>>        Number  nRetVal
76486>>>>>>>
76486>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
76487>>>>>>>
76487>>>>>>>        If (iRetVal=0) Begin
76489>>>>>>>            Error DFERR_WINPRINT DFPrintError963
76490>>>>>>>>
76490>>>>>>>            Function_Return 0
76491>>>>>>>        End
76491>>>>>>>>
76491>>>>>>>
76491>>>>>>>        Move (Low(iRetVal)) To nRetVal
76492>>>>>>>        Move (nRetVal/100) To nRetVal //Returns CM
76493>>>>>>>
76493>>>>>>>        Function_Return nRetVal
76494>>>>>>>     End_Function
76495>>>>>>>
76495>>>>>>>
76495>>>>>>>    //*** To be set in CM
76495>>>>>>>     Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
76497>>>>>>>        Integer bOk
76497>>>>>>>        Integer iLength iWidth iSize
76497>>>>>>>
76497>>>>>>>        move (nLength*100) To iLength
76498>>>>>>>        move (nWidth*100)  To iWidth
76499>>>>>>>        move ((iLength*65536)+iWidth) To iSize
76500>>>>>>>
76500>>>>>>>        Move (WP_SetUserDefinedPapersize(iSize)) To bOk
76501>>>>>>>
76501>>>>>>>        If not bOk Begin
76503>>>>>>>            Error DFERR_WINPRINT DFPrintError964
76504>>>>>>>>
76504>>>>>>>        End
76504>>>>>>>>
76504>>>>>>>     End_Procedure
76505>>>>>>>
76505>>>>>>>     Procedure DFSetNumberOfCopies Integer iNrOfCopies
76507>>>>>>>        Boolean bOk
76507>>>>>>>
76507>>>>>>>        Move (WP_SetNumberOfPrintCopies(iNrOfCopies)) to bOk
76508>>>>>>>
76508>>>>>>>        If not bOk Begin
76510>>>>>>>            Error DFERR_WINPRINT DFPrintError965
76511>>>>>>>>
76511>>>>>>>        end
76511>>>>>>>>
76511>>>>>>>     End_Procedure
76512>>>>>>>
76512>>>>>>>
76512>>>>>>>
76512>>>>>>>
76512>>>>>>>    //*************************************************************
76512>>>>>>>    //*** This procedures and functions are used when building  ***
76512>>>>>>>    //*** complex graphics when you need to change value of the ***
76512>>>>>>>    //*** current diagram, so you can mix diagrams within each  ***
76512>>>>>>>    //*** other.                                                ***
76512>>>>>>>    //*************************************************************
76512>>>>>>>
76512>>>>>>>
76512>>>>>>>    Function DFGetCurrentDiagram Returns Integer
76514>>>>>>>        Integer iRetVal
76514>>>>>>>        Get DFCurrent_Diagram To iRetVal
76515>>>>>>>        Function_Return iRetVal
76516>>>>>>>    End_Function
76517>>>>>>>
76517>>>>>>>    Procedure DFSetCurrentDiagram Integer iDiagram
76519>>>>>>>        Set DFCurrent_Diagram To iDiagram
76520>>>>>>>    End_Procedure
76521>>>>>>>
76521>>>>>>>    Procedure DFSetDiagramList Integer iItem Integer iDiagram
76523>>>>>>>        Set Value of oDiagramArray iItem To iDiagram
76524>>>>>>>    End_Procedure
76525>>>>>>>
76525>>>>>>>    Function DFGetDiagramList Integer iItem Returns Integer
76527>>>>>>>        Integer iRetVal
76527>>>>>>>        Get Value of oDiagramArray iItem To iRetVal
76528>>>>>>>        Function_Return iRetVal
76529>>>>>>>    End_Function
76530>>>>>>>
76530>>>>>>>    Procedure DFClearDiagramList
76532>>>>>>>        Send Delete_Data To oDiagramArray
76533>>>>>>>    End_Procedure
76534>>>>>>>
76534>>>>>>>
76534>>>>>>>    Function DFGetColor Integer iColor Returns Dword
76536>>>>>>>        Dword   dwRetVal
76536>>>>>>>        Get Value of oDFColorArray iColor To dwRetVal
76537>>>>>>>        Function_Return dwRetVal
76538>>>>>>>    End_Function
76539>>>>>>>
76539>>>>>>>    Function DFGetCurrentColor Returns Dword
76541>>>>>>>        Dword   dwRetVal
76541>>>>>>>        Integer iCurrColor
76541>>>>>>>
76541>>>>>>>        Get DFCurrent_Color To iCurrColor
76542>>>>>>>        Get DFGetColor iCurrColor To dwRetVal
76543>>>>>>>
76543>>>>>>>        Function_Return dwRetVal
76544>>>>>>>    End_Function
76545>>>>>>>
76545>>>>>>>    Procedure DFEndDocument
76547>>>>>>>        integer iVoid
76547>>>>>>>        Move (WP_EndDocument()) To iVoid
76548>>>>>>>        Send DfSuspendGui False
76549>>>>>>>    End_procedure
76550>>>>>>>
76550>>>>>>>    Procedure DFClosePreview
76552>>>>>>>        integer iVoid
76552>>>>>>>        Move (WP_ClosePreview()) To iVoid
76553>>>>>>>        Send DfSuspendGui False
76554>>>>>>>    End_procedure
76555>>>>>>>
76555>>>>>>>    Procedure SetProgressCaption string sCaption
76557>>>>>>>        integer iVoid
76557>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
76558>>>>>>>        Move (WP_SetProgressCaption(sCaption)) To iVoid
76559>>>>>>>    End_procedure
76560>>>>>>>
76560>>>>>>>    Procedure SetReportTitle string sTitle
76562>>>>>>>        integer iVoid
76562>>>>>>>        Move (ToAnsi(sTitle)) to sTitle
76563>>>>>>>        Move (WP_SetReportTitle(sTitle)) To iVoid
76564>>>>>>>    End_procedure
76565>>>>>>>
76565>>>>>>>    Function PreviewYesNoBox string sCaption string sText returns integer
76567>>>>>>>        integer eResult
76567>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
76568>>>>>>>        Move (ToAnsi(sText))    to sText
76569>>>>>>>        Move (WP_DisplayMessageBox(sCaption, sText)) To eResult
76570>>>>>>>        Function_return eResult
76571>>>>>>>    end_function
76572>>>>>>>
76572>>>>>>>    // internal function, used to extract different printer flags ranges based on
76572>>>>>>>    // the print flag integer. These flags use a decimal style of packing information
76572>>>>>>>    // where different printer options (paper, bin, etc) use different ranges and
76572>>>>>>>    // different steps. Everything above iTopVal is removed and everything that is not
76572>>>>>>>    // within the iStep range is removed.
76572>>>>>>>    Function PrintFlagRange integer iTopVal integer iStep returns integer
76574>>>>>>>        integer iFgs iFg
76574>>>>>>>        Get DFGetPrintDialogFlags to iFg
76575>>>>>>>        Move (mod(iFg,iTopVal) / iStep * iStep ) to iFg
76576>>>>>>>        function_return iFg
76577>>>>>>>    end_Function
76578>>>>>>>
76578>>>>>>>    Procedure DFSetPrinterPaper integer ePaperType
76580>>>>>>>        Send DFSetSpecPrintFlag ePaperType
76581>>>>>>>    End_Procedure
76582>>>>>>>
76582>>>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
76584>>>>>>>        integer ePaperType
76584>>>>>>>        Get PrintFlagRange 500 10 to ePaperType // 10-490 in steps of 10
76585>>>>>>>        function_return ePaperType
76586>>>>>>>    End_Function
76587>>>>>>>
76587>>>>>>>
76587>>>>>>>    Procedure DFSetPrinterBin integer eBinType
76589>>>>>>>        Send DFSetSpecPrintFlag eBinType
76590>>>>>>>    End_Procedure
76591>>>>>>>
76591>>>>>>>    Function DFGetPrinterBin returns integer //eBinType
76593>>>>>>>        integer eBinType
76593>>>>>>>        Get PrintFlagRange 10000 500 to eBinType // 1000-9000 steps 500
76594>>>>>>>        function_return eBinType
76595>>>>>>>    End_Function
76596>>>>>>>
76596>>>>>>>
76596>>>>>>>    Procedure DFSetPrinterResolution integer eResType
76598>>>>>>>        Send DFSetSpecPrintFlag eResType
76599>>>>>>>    End_Procedure
76600>>>>>>>
76600>>>>>>>    Function DFGetPrinterResolution returns integer //eResType
76602>>>>>>>        integer eResType
76602>>>>>>>        Get PrintFlagRange 50000 10000 to eResType // 10000-500000 steps 10000
76603>>>>>>>        function_return eResType
76604>>>>>>>    End_Function
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>    Procedure DFSetLandscape boolean bIsLandscape
76607>>>>>>>        Send DFSetSpecPrintFlag (If(bIsLandscape,DF_Landscape,DF_Portrait))
76608>>>>>>>    End_Procedure
76609>>>>>>>
76609>>>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
76611>>>>>>>        boolean bIsLandscape
76611>>>>>>>        Get DFCheckPrintDialogFlag DF_Landscape to bIsLandscape
76612>>>>>>>        function_return bIsLandscape
76613>>>>>>>    End_Function
76614>>>>>>>
76614>>>>>>>    Function RGBToWPColor integer iRgb returns integer
76616>>>>>>>        integer iRed iGreen iBlue
76616>>>>>>>        integer iWPColor
76616>>>>>>>        Move (R_from_rgb(iRGB)) to iRed
76617>>>>>>>        Move (G_from_rgb(iRGB)) to iGreen
76618>>>>>>>        Move (B_from_rgb(iRGB)) to iBlue
76619>>>>>>>        Get DfGetDfColor iRed iGreen iBlue to iWPColor
76620>>>>>>>        function_Return iWPColor
76621>>>>>>>    end_function
76622>>>>>>>
76622>>>>>>>
76622>>>>>>>
76622>>>>>>>End_Class
76623>>>>>>>
76623>>>>>>>Global_Variable Integer ghoWinPrint2
76623>>>>>>>
76623>>>>>>>Get Create of desktop U_cWinPrint2 to ghoWinPrint2
76624>>>>>>>
76624>>>>>>>
76624>>>>>Use Winprint_Commands.pkg  // commands used by this class
76624>>>>>
76624>>>>>Class cWinReport2 is a BasicReport
76625>>>>>
76625>>>>>    Procedure Construct_Object
76627>>>>>        Forward send construct_object
76629>>>>>
76629>>>>>        Date Today
76629>>>>>        Sysdate Today
76630>>>>>
76630>>>>>        // should use built in DF function CurrentDateTime()
76630>>>>>        Property Date  RptToday    Today
76631>>>>>
76631>>>>>        Object RptTotal is an Array
76633>>>>>        End_Object
76634>>>>>
76634>>>>>        // If true, report is output upon completion. Either preview
76634>>>>>        // or printer depending on output_device_mode
76634>>>>>        Property Boolean AutoOutput_State True
76635>>>>>
76635>>>>>        // When a new page is created (DFNew_Page) and the number
76635>>>>>        // of columns is not passed, this is used.
76635>>>>>        Property Integer Print_Columns 0
76636>>>>>
76636>>>>>        // This determines if a DFNew_Page should be executed when the
76636>>>>>        // report starts. In some rare cases, you would not want this to
76636>>>>>        // occur until a subheader
76636>>>>>        Property Boolean AutoNew_Page_State True
76637>>>>>
76637>>>>>        // Output device (print or preview). Normally this is delegated to
76637>>>>>        // the report view.
76637>>>>>        //
76637>>>>>
76637>>>>>        Property Integer Private.Output_Device_Mode PRINT_TO_UNDEFINED
76638>>>>>
76638>>>>>        Property Handle phoWinPrint  ghoWinPrint2 // the report engine to use.
76639>>>>>
76639>>>>>        // JJT: For now this is for testing.
76639>>>>>        Property boolean pbModalViewer False
76640>>>>>
76640>>>>>        Property boolean pbMultiReports False
76641>>>>>
76641>>>>>        Property boolean pbFirstPagePrinted false
76642>>>>>
76642>>>>>    End_Procedure
76643>>>>>
76643>>>>>    // returns the current status of Winprint Document object. dsNotStarted, dsStarted, dsFinished
76643>>>>>    // note that the status can reflect a status from a different report. The winprint object is global.
76643>>>>>    Function DocumentStatus returns Boolean
76645>>>>>        integer iStatus
76645>>>>>        Get DocumentStatus of (phoWinprint(self)) to iStatus
76646>>>>>        function_return iStatus
76647>>>>>    End_function
76648>>>>>
76648>>>>>    Function IsViewerActive Returns Boolean
76650>>>>>        Boolean bIsActive
76650>>>>>        Get IsViewerActive of (phoWinPrint(Self)) to bIsActive
76651>>>>>        Function_Return bIsActive
76652>>>>>    End_Function
76653>>>>>
76653>>>>>    Function IsPrinterValid Returns Boolean
76655>>>>>        Function_Return (WP_IsPrinterValid()<>0)
76656>>>>>    End_Function
76657>>>>>
76657>>>>>    Function ArePrintersInstalled Returns Boolean
76659>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
76660>>>>>    End_Function
76661>>>>>
76661>>>>>
76661>>>>>    // All subtotal commands use the outer main report. This makes it easier to keep
76661>>>>>    // track of these numbers
76661>>>>>
76661>>>>>    Procedure Add_SubTotal Integer iCounter Number nData
76663>>>>>        Number nValue
76663>>>>>        Integer iObj
76663>>>>>        Move (RptTotal(Main_Report_Id(Self))) to iObj
76664>>>>>        Get Number_Value of iObj iCounter To nValue
76665>>>>>        Add nData To nValue
76666>>>>>        Set Array_Value of iObj iCounter To nValue
76667>>>>>    End_Procedure
76668>>>>>
76668>>>>>    Procedure Clr_SubTotal Integer iCounter
76670>>>>>        Set Array_Value of (RptTotal(Main_Report_Id(Self))) iCounter To 0
76671>>>>>    End_Procedure
76672>>>>>
76672>>>>>    Procedure Clr_AllSubTotals
76674>>>>>        Send Delete_Data of (RptTotal(Main_Report_Id(Self)))
76675>>>>>    End_Procedure
76676>>>>>
76676>>>>>    Function Sum_SubTotal Integer iTotal Returns Number
76678>>>>>        Number nRetVal
76678>>>>>        Get Number_Value of (RptTotal(Main_Report_Id(Self))) iTotal To nRetVal
76679>>>>>        Function_Return nRetVal
76680>>>>>    End_Function
76681>>>>>
76681>>>>>    //Return sub-total and clear accumulator
76681>>>>>    //
76681>>>>>    Function SubTotal Integer iTotal Returns Number
76683>>>>>        Number nRetVal
76683>>>>>        Get Sum_SubTotal  iTotal to nRetVal
76684>>>>>        Send Clr_SubTotal iTotal
76685>>>>>        Function_Return nRetVal
76686>>>>>    End_Function
76687>>>>>
76687>>>>>
76687>>>>>    // Note: Cols is optional. If no argument is passed it will use
76687>>>>>    //       the object's property Print_Columns (0 by default)
76687>>>>>    //
76687>>>>>    Procedure DFNew_Page Integer Cols
76689>>>>>        Integer PageNumber Columns
76689>>>>>        Boolean bFirstPagePrinted
76689>>>>>        // If no args passed used default setting
76689>>>>>        If (Num_Arguments=0) ;           Move (Print_Columns(Main_Report_id(Self))) to Columns
76692>>>>>        Else ;           Move Cols to Columns
76694>>>>>        Set Page_Feed   to -2   // No FormFeed
76695>>>>>        If (Child_Rpt_State(self)) ;            Send DFNew_Page of (Main_Report_Id(Self)) Columns
76698>>>>>        Else Begin
76699>>>>>            // we only want to print report_header once. When report starts
76699>>>>>            // this is set true, after the first print it is false. You can set
76699>>>>>            // this to true before and explicit dfNew_page to force a header
76699>>>>>            Get pbFirstPagePrinted to bFirstPagePrinted
76700>>>>>            Get  DFNewPage of (phoWinPrint(self)) Columns To PageNumber
76701>>>>>            If (PageNumber<>0) begin // if 0, it failed
76703>>>>>                Set No_PageCheck_State to True
76704>>>>>
76704>>>>>                //Top section
76704>>>>>                Send Page_Top
76705>>>>>                If Not bFirstPagePrinted Send Report_Header
76708>>>>>                Send Page_Header
76709>>>>>                Send Page_Title
76710>>>>>
76710>>>>>                Set New_Page_State to False
76711>>>>>                Set Page_End_State to False
76712>>>>>                Set No_PageCheck_State to False        // No longer Paging
76713>>>>>                Set pbFirstPagePrinted to True
76714>>>>>            End
76714>>>>>>
76714>>>>>        End
76714>>>>>>
76714>>>>>
76714>>>>>        // Footer section
76714>>>>>        //
76714>>>>>        // DO NOT CHANGE THE ORDER OF BOTTOM SECTIONS !!!!!
76714>>>>>        //
76714>>>>>
76714>>>>>        Send Page_Bottom
76715>>>>>
76715>>>>>        // in WinPrint it is not possible to replace Page_Footer
76715>>>>>        // with Report_Footer. If you use Report_Footer you will
76715>>>>>        // have both Page_Footer and Report_Footer
76715>>>>>        //
76715>>>>>        //If LastTime eq 0 Send Page_Footer
76715>>>>>        //else             Send Report_Footer
76715>>>>>
76715>>>>>        Send Page_Footer
76716>>>>>        Send Page_Total
76717>>>>>    End_Procedure
76718>>>>>
76718>>>>>    Procedure Ending_Main_Report
76720>>>>>        Boolean bCancel bMultiReports
76720>>>>>
76720>>>>>        Get Cancelled_state to bCancel
76721>>>>>        Get pbMultiReports to bMultiReports
76722>>>>>
76722>>>>>        Forward Send Ending_Main_Report
76724>>>>>
76724>>>>>        If bCancel Begin
76726>>>>>            Send DFEndDocument
76727>>>>>            Send DFClearDoc // this will also close the previewer
76728>>>>>        end
76728>>>>>>
76728>>>>>        Else Begin
76729>>>>>            Send Report_Footer
76730>>>>>
76730>>>>>            // if multi-reports, we don't do an end of report yet. The programmer must
76730>>>>>            // manually end the report by sending EndMultiReport
76730>>>>>            If (not(bMultiReports)) begin
76732>>>>>                Send EndWinPrintReport
76733>>>>>            end
76733>>>>>>
76733>>>>>
76733>>>>>        end
76733>>>>>>
76733>>>>>
76733>>>>>    End_Procedure
76734>>>>>
76734>>>>>    // This must get called when you are running multiple reports (pbMultiReport).
76734>>>>>    // Send this when the last report is complete.
76734>>>>>    Procedure EndMultiReport
76736>>>>>        Send EndWinPrintReport
76737>>>>>    End_procedure
76738>>>>>
76738>>>>>
76738>>>>>    Procedure EndWinPrintReport
76740>>>>>        Boolean bAutoOutput
76740>>>>>        integer iStatus eMode
76740>>>>>        Get DocumentStatus to iStatus
76741>>>>>        If (iStatus<>dsStarted) procedure_return
76744>>>>>
76744>>>>>        // this tells winprint that the report is complete
76744>>>>>        Send DFEndDocument
76745>>>>>        // if auto-output we print or display automatically.
76745>>>>>        // for winprint2, if in preview mode you must do this so the previewer can enter
76745>>>>>        // a modal state (which it may or may not need to do).
76745>>>>>        Get AutoOutput_state to bAutoOutput
76746>>>>>        Get Output_device_mode to eMode
76747>>>>>        If (bAutoOutput or eMode=PRINT_TO_WINDOW) begin
76749>>>>>            Send PrintReport
76750>>>>>            // if auto output, we assume that you are done when it is all over
76750>>>>>            // we only can do this with the modal viewer
76750>>>>>            If (bAutoOutput and pbModalViewer(self)) begin
76752>>>>>                Send DFClearDoc
76753>>>>>            end
76753>>>>>>
76753>>>>>        end
76753>>>>>>
76753>>>>>
76753>>>>>    End_Procedure
76754>>>>>
76754>>>>>
76754>>>>>    Function Setup_Report Returns Integer
76756>>>>>        Integer iErr iStatus eMode
76756>>>>>        Boolean bActiveViewer bChildReport bMultiReports bOk
76756>>>>>
76756>>>>>        Get Child_rpt_state to bChildReport
76757>>>>>
76757>>>>>        If not bChildReport Begin
76759>>>>>
76759>>>>>            // This makes sure that we are pointing to the new winprint2 engine object.
76759>>>>>            // normally this will be the new winprint, but it can be redirected
76759>>>>>            Get phoWinPrint to WinPrintID
76760>>>>>
76760>>>>>            // winprint must have installed printer. If not installed, generate error and stop the report
76760>>>>>            Get ArePrintersInstalled to bOk
76761>>>>>            If not bOk Begin
76763>>>>>                Error DFERR_WINPRINT C_$NoInstalledPrinters
76764>>>>>>
76764>>>>>                Function_Return 1
76765>>>>>            End
76765>>>>>>
76765>>>>>
76765>>>>>            // check if selected printer is valid. If not, generate error and stop the report
76765>>>>>            Get IsPrinterValid to bOk
76766>>>>>            If not bOk Begin
76768>>>>>                Error DFERR_WINPRINT DFPrintError936    // Could not select a valid printer
76769>>>>>>
76769>>>>>                Function_Return 1
76770>>>>>            End
76770>>>>>>
76770>>>>>
76770>>>>>            // make sure it is ok to start a new report but try to be smart about it.
76770>>>>>            // if a report is active (dsstarted or dsFinished) check to see if it is
76770>>>>>            // finished w/ no viewer. If so, assume the user closed the report and is done
76770>>>>>            // so just clear the report. If a viewer is present, declare an error.
76770>>>>>            Get DocumentStatus to iStatus
76771>>>>>            Get pbMultiReports to bMultiReports
76772>>>>>            // multi-report only in-progress is multi and it is started
76772>>>>>            Move (bMultiReports and iStatus=dsStarted) to bMultiReports
76773>>>>>            If not bMultiReports Begin
76775>>>>>                If (iStatus<>dsNotStarted) Begin
76777>>>>>                    Get IsViewerActive to bActiveViewer
76778>>>>>                    If (iStatus=dsFinished and not(bActiveViewer)) Begin
76780>>>>>                        Send DfClearDoc
76781>>>>>                    End
76781>>>>>>
76781>>>>>                    Else Begin
76782>>>>>                        Error DFERR_WINPRINT DFPrintError967
76783>>>>>>
76783>>>>>                        Function_Return 1
76784>>>>>                    End
76784>>>>>>
76784>>>>>                End
76784>>>>>>
76784>>>>>
76784>>>>>                // all new reports by default allow printing from viewer and they have the print job set up when you select print
76784>>>>>                // if you need to change these defaults, you can change these inside of Starting_main_report
76784>>>>>                // We only do this with non-multi-reports.
76784>>>>>                Send DFSetPrintDlgInPreview      True
76785>>>>>                Send DFSetEnablePrintFromPreview True
76786>>>>>
76786>>>>>            End
76786>>>>>>
76786>>>>>
76786>>>>>            // In the new winprint, this message is not needed and is a stub. For
76786>>>>>            // now it is in here for compatibility purposes
76786>>>>>            //You MUST always start a new report with this procedure
76786>>>>>            Send DFZeroCounters of (phoWinPrint(Self))
76787>>>>>            Send Clr_AllSubTotals
76788>>>>>
76788>>>>>        End
76788>>>>>>
76788>>>>>
76788>>>>>        Forward Get Setup_report to iErr
76790>>>>>
76790>>>>>        If (iErr=0) Begin
76792>>>>>            If not bChildReport Begin
76794>>>>>                // if part of a multi-report we don't do a new doc
76794>>>>>                If not bMultiReports Begin
76796>>>>>                    Get Output_Device_Mode to eMode
76797>>>>>                    Send DFNewDoc of (phoWinPrint(Self))  (eMode = PRINT_TO_WINDOW) // pass True of display while printing
76798>>>>>                End
76798>>>>>>
76798>>>>>                // Do new page if not part of a multi-report and we say don't do a new page
76798>>>>>                If (not(bMultiReports) or AutoNew_Page_State(Self)) Begin
76800>>>>>                    Set pbFirstPagePrinted to False // tells new page that this is the first time for this report
76801>>>>>                    Send DFNew_page
76802>>>>>                End
76802>>>>>>
76802>>>>>            End
76802>>>>>>
76802>>>>>        End
76802>>>>>>
76802>>>>>        Function_Return iErr
76803>>>>>    End_Function
76804>>>>>
76804>>>>>
76804>>>>>
76804>>>>>    // Cancel RO behavior - there is no device to close
76804>>>>>    //
76804>>>>>    Procedure Close_Output_Device
76806>>>>>    End_Procedure
76807>>>>>
76807>>>>>    // Cancel RO Behavior
76807>>>>>    //
76807>>>>>    Procedure Initialize_Output_Device
76809>>>>>    End_procedure
76810>>>>>
76810>>>>>
76810>>>>>    Function Output_Device_Mode Returns Integer
76812>>>>>        Integer hoId
76812>>>>>        String DevMode
76812>>>>>        Get Private.Output_Device_Mode to DevMode
76813>>>>>        If (DevMode=PRINT_TO_UNDEFINED) Begin
76815>>>>>            Get Report_View_Id to hoId
76816>>>>>            If hoID ;                Get OutPut_Device_Mode of hoID to DevMode
76819>>>>>            If (DevMode=PRINT_TO_UNDEFINED) ;                Move PRINT_TO_WINDOW to DevMode
76822>>>>>        End
76822>>>>>>
76822>>>>>        Function_Return DevMode
76823>>>>>    End_Function // Output_Destination
76824>>>>>
76824>>>>>    Procedure Set Output_Device_Mode Integer DevMode
76826>>>>>        Set Private.Output_Device_Mode to DevMode
76827>>>>>    End_Procedure // Set Output_Device
76828>>>>>
76828>>>>>    // displays a metric ruler in .5 increments. This can be
76828>>>>>    // sent to make it easy to see how fields and labels should
76828>>>>>    // be moved for alignment.
76828>>>>>    //
76828>>>>>    Procedure ShowRuler
76830>>>>>        integer i
76830>>>>>        number n
76830>>>>>        for i from 0 to 30
76836>>>>>>
76836>>>>>            Send DFWritePos of (phoWinPrint(self)) (String(i)) FONT_DEFAULT i -1 0
76837>>>>>            Move (i+.5) to n
76838>>>>>            Send DFWritePos of (phoWinPrint(self)) "." FONT_DEFAULT n -1 0
76839>>>>>        Loop
76840>>>>>>
76840>>>>>        Send DFWriteln of (phoWinPrint(self)) ''  FONT_DEFAULT FONT_DEFAULT -1
76841>>>>>    End_procedure
76842>>>>>
76842>>>>>      // status panel related agumentations to handle the auto-previewer
76842>>>>>
76842>>>>>      Procedure Update_Status string sVal
76844>>>>>         Integer eMode
76844>>>>>         Get Output_device_mode to eMode
76845>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
76847>>>>>            Send SetProgressCaption  of (phoWinPrint(self)) sVal
76848>>>>>         End
76848>>>>>>
76848>>>>>         Else Begin
76849>>>>>            forward Send Update_Status sVal
76851>>>>>         end
76851>>>>>>
76851>>>>>      End_Procedure
76852>>>>>
76852>>>>>      Procedure Start_Status
76854>>>>>         Integer eMode
76854>>>>>         string sTitle sCaption
76854>>>>>         Get Output_device_mode to eMode
76855>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
76857>>>>>            Get Report_Caption to sCaption
76858>>>>>            Get Report_Title to sTitle
76859>>>>>            If (sTitle<>"" and sCaption<>"") begin
76861>>>>>                Move ( sCaption- ":" * sTitle) to sTitle
76862>>>>>            end
76862>>>>>>
76862>>>>>            else begin
76863>>>>>                Move (sCaption - sTitle) to sTitle
76864>>>>>            end
76864>>>>>>
76864>>>>>            Send SetReportTitle of (phoWinPrint(self)) sTitle
76865>>>>>         End
76865>>>>>>
76865>>>>>         Else Begin
76866>>>>>            forward Send Start_status
76868>>>>>         end
76868>>>>>>
76868>>>>>      End_Procedure
76869>>>>>
76869>>>>>      Procedure Resume_Status
76871>>>>>         Integer eMode
76871>>>>>         Get Output_device_mode to eMode
76872>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
76874>>>>>            Send DfPreviewNoWait of (phoWinPrint(self))
76875>>>>>         End
76875>>>>>>
76875>>>>>         Else Begin
76876>>>>>            forward Send Resume_Status
76878>>>>>         end
76878>>>>>>
76878>>>>>      End_Procedure
76879>>>>>
76879>>>>>      Procedure End_Status
76881>>>>>         Integer eMode
76881>>>>>         Get Output_device_mode to eMode
76882>>>>>         If (error_processing_state(self)) Begin
76884>>>>>            Send DFClosePreview
76885>>>>>         end
76885>>>>>>
76885>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
76887>>>>>         End
76887>>>>>>
76887>>>>>         Else Begin
76888>>>>>            forward Send End_Status
76890>>>>>         end
76890>>>>>>
76890>>>>>      End_Procedure
76891>>>>>
76891>>>>>    Function Report_Interrupt Returns Integer
76893>>>>>         integer eStat
76893>>>>>         String sMess
76893>>>>>         Boolean bActiveViewer
76893>>>>>         Get IsViewerActive to bActiveViewer
76894>>>>>         If (Error_Check_State(self)) begin
76896>>>>>            Move C_$AnErrorWishToCancel to sMess
76897>>>>>         end
76897>>>>>>
76897>>>>>         Else begin
76898>>>>>            Move  C_$CancelThisReport to sMess
76899>>>>>         end
76899>>>>>>
76899>>>>>         If bActiveViewer Begin
76901>>>>>            Get PreviewYesNoBox of (phoWinPrint(self)) C_$ReportInterrupt sMess to eStat
76902>>>>>         end
76902>>>>>>
76902>>>>>         Else Begin
76903>>>>>            Get YesNo_Box sMess C_$ReportInterrupt to eStat
76904>>>>>         End
76904>>>>>>
76904>>>>>
76904>>>>>         Function_Return (eStat=MBR_YES)
76905>>>>>
76905>>>>>  End_Function
76906>>>>>
76906>>>>>  Function Test_KeyPressed Returns Integer
76908>>>>>     Boolean bStop bError bActiveViewer
76908>>>>>     integer eMode
76908>>>>>     // winreport will do this also, but this makes sure that this gets called
76908>>>>>     // for each body loop -- even if the body loop prints nothing
76908>>>>>     Send PumpMsgQueue of (phoWinPrint(self)) // permit painting
76909>>>>>     Get IsViewerActive to bActiveViewer
76910>>>>>     Get Output_device_mode to eMode
76911>>>>>     If bActiveViewer Begin
76913>>>>>        Get ViewerWantsToClose of (phoWinPrint(self)) to bStop
76914>>>>>        Get Error_Check_State to bError
76915>>>>>        if (bStop or bError) begin
76917>>>>>            Get Report_Interrupt to bStop
76918>>>>>        end
76918>>>>>>
76918>>>>>     end
76918>>>>>>
76918>>>>>     Else Begin
76919>>>>>        Forward Get Test_KeyPressed to bStop
76921>>>>>        If (eMode=PRINT_TO_WINDOW and not(bStop)) Begin
76923>>>>>            Send DfPreviewNoWait
76924>>>>>        end
76924>>>>>>
76924>>>>>     End
76924>>>>>>
76924>>>>>
76924>>>>>     Function_Return bStop
76925>>>>>  End_Function
76926>>>>>
76926>>>>>    Procedure OnClosingView
76928>>>>>        Send DFClearDoc
76929>>>>>    end_procedure
76930>>>>>
76930>>>>>
76930>>>>>    // Attempt to make this as intuitive as possible. You cannot invoke this when a
76930>>>>>    // report is active. If a report is not finished, you cannot do this.
76930>>>>>    // If a report is finsihed it may or may not have a viewer present.
76930>>>>>    // If a viewer is not present, we will clear the exising report (making the assumption
76930>>>>>    // that a modeless viewer was closed and the report will not be invoked again). If a viewer
76930>>>>>    // is active, we will pass this through to the winprint object which will show an error
76930>>>>>
76930>>>>>    Function DFPrintSetupDialog Returns Boolean// invoke printer setup dialog
76932>>>>>        Integer iStatus
76932>>>>>        Boolean bActiveViewer bOk
76932>>>>>        // we must have printers installed for this to work
76932>>>>>        Get ArePrintersInstalled to bOk
76933>>>>>        If not bOk Begin
76935>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
76936>>>>>>
76936>>>>>        End
76936>>>>>>
76936>>>>>        Else Begin
76937>>>>>            Get DocumentStatus to iStatus
76938>>>>>            If (iStatus=dsFinished) Begin
76940>>>>>                Get IsViewerActive to bActiveViewer
76941>>>>>                If not bActiveViewer Begin
76943>>>>>                    Send DfClearDoc
76944>>>>>                End
76944>>>>>>
76944>>>>>            End
76944>>>>>>
76944>>>>>            // the winprint object will generate an error if the status is not dsNotStarted.
76944>>>>>            // we want those errors
76944>>>>>            Get DFPrintSetupDialog of (phoWinPrint(Self)) to bOk
76945>>>>>        End
76945>>>>>>
76945>>>>>        Function_Return bOk
76946>>>>>    End_Procedure
76947>>>>>
76947>>>>>    // It is better to use DFPrintSetupDialog which tells you if the dialog was canceled
76947>>>>>    Procedure DFPrintSetup // invoke printer setup dialog
76949>>>>>        Boolean bOk
76949>>>>>        Get DFPrintSetupDialog to bOk
76950>>>>>    End_Procedure
76951>>>>>
76951>>>>>    Procedure DFClearDoc // clear document, remove viewer
76953>>>>>        Send DFClearDoc of (phoWinPrint(self))
76954>>>>>    end_procedure
76955>>>>>
76955>>>>>    Procedure DFEndDocument // tell winprint that the report is complete
76957>>>>>        Send DfEndDocument of (phoWinPrint(self))
76958>>>>>    end_procedure
76959>>>>>
76959>>>>>    Procedure DFClosePreview //close the previewer, does not clear the document
76961>>>>>        Send DfClosePreview of (phoWinPrint(self))
76962>>>>>    end_procedure
76963>>>>>
76963>>>>>    Procedure DFPrintDialog // popup print job dialog
76965>>>>>        Send DFPrintDialog of (phoWinPrint(self))
76966>>>>>    End_procedure
76967>>>>>
76967>>>>>    Procedure DFPrint // print with printer dialog
76969>>>>>        Send DFPrint of (phoWinPrint(self))
76970>>>>>    End_procedure
76971>>>>>
76971>>>>>    Procedure DFPrintDoc // print without printer dialog
76973>>>>>        Send DFPrintDoc of (phoWinPrint(self))
76974>>>>>    End_Procedure
76975>>>>>
76975>>>>>    Procedure DFPreviewWait // invoke previewer in modal mode
76977>>>>>       Send DFPreviewWait of (phoWinPrint(self))
76978>>>>>    End_Procedure
76979>>>>>
76979>>>>>    Procedure DFPreviewNoWait // invoke previwer in modeless mode
76981>>>>>       Send DFPreviewNoWait of (phoWinPrint(self))
76982>>>>>    End_Procedure
76983>>>>>
76983>>>>>    Procedure DFPreview // invokde previewer based on pbModalViewer property
76985>>>>>       Boolean bModalViewer
76985>>>>>       Get pbModalViewer to bModalViewer
76986>>>>>       If bModalViewer Begin
76988>>>>>           Send DFPreviewWait
76989>>>>>       end
76989>>>>>>
76989>>>>>       else Begin
76990>>>>>           Send DFPreviewNoWait
76991>>>>>       end
76991>>>>>>
76991>>>>>   End_Procedure
76992>>>>>
76992>>>>>    // Print report to appropriate device (printer, preview) based
76992>>>>>    // on output_device_mode
76992>>>>>    //
76992>>>>>    Procedure PrintReport
76994>>>>>        Integer eMode
76994>>>>>        Get OutPut_Device_Mode to eMode
76995>>>>>        If ((eMode=PRINT_TO_WINDOW) or (eMode=DEFERRED_PRINT_TO_WINDOW)) Begin
76997>>>>>           Send DFPreview
76998>>>>>        end
76998>>>>>>
76998>>>>>        Else If (eMode=PRINT_TO_PRINTER_NO_DIALOG) Begin
77001>>>>>           Send DFPrintDoc // print, no print job dialog
77002>>>>>        end
77002>>>>>>
77002>>>>>        Else Begin // (eMode=PRINT_TO_PRINTER)
77003>>>>>           Send DFPrint // print with print job dialog
77004>>>>>        end
77004>>>>>>
77004>>>>>    End_Procedure
77005>>>>>
77005>>>>>
77005>>>>>    Procedure DFSetPrinterPaper integer ePaperType
77007>>>>>        Send DFSetPrinterPaper of (phoWinPrint(self)) ePaperType
77008>>>>>    End_Procedure
77009>>>>>
77009>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
77011>>>>>        integer ePaperType
77011>>>>>        Get DFGetPrinterPaper of (phoWinPrint(self)) to ePaperType
77012>>>>>        Function_return ePaperType
77013>>>>>    end_function
77014>>>>>
77014>>>>>
77014>>>>>    Procedure DFSetPrinterBin integer eBinType
77016>>>>>        Send DFSetPrinterBin of (phoWinPrint(self)) eBinType
77017>>>>>    End_Procedure
77018>>>>>
77018>>>>>    Function DFGetPrinterBin returns integer //eBinType
77020>>>>>        integer eBinType
77020>>>>>        Get DFGetPrinterBin of (phoWinPrint(self)) to eBinType
77021>>>>>        Function_return eBinType
77022>>>>>    end_function
77023>>>>>
77023>>>>>
77023>>>>>    Procedure DFSetPrinterResolution integer eResType
77025>>>>>        Send DFSetPrinterResolution of (phoWinPrint(self)) eResType
77026>>>>>    End_Procedure
77027>>>>>
77027>>>>>    Function DFGetPrinterResolution returns integer //eResType
77029>>>>>        Boolean eResType
77029>>>>>        Get DFGetPrinterResolution of (phoWinPrint(self)) to eResType
77030>>>>>        Function_return eResType
77031>>>>>    end_function
77032>>>>>
77032>>>>>
77032>>>>>    Procedure DFSetLandscape boolean bIsLandscape
77034>>>>>        Send DFSetLandscape of (phoWinPrint(self)) bIsLandscape
77035>>>>>    End_Procedure
77036>>>>>
77036>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
77038>>>>>        Boolean bIsLandscape
77038>>>>>        Get DFGetLandscape of (phoWinPrint(self)) to bIsLandscape
77039>>>>>        Function_return bIsLandscape
77040>>>>>    end_function
77041>>>>>
77041>>>>>    Procedure DFSetMetrics integer eType
77043>>>>>        Send DFSetMetrics of (phoWinPrint(self)) eType
77044>>>>>    End_Procedure
77045>>>>>
77045>>>>>    Function DFGetMetrics returns integer
77047>>>>>        integer eType
77047>>>>>        Get DFGetMetrics of (phoWinPrint(self)) to eType
77048>>>>>        Function_return eType
77049>>>>>    end_function
77050>>>>>
77050>>>>>
77050>>>>>    Procedure DFSetPrintDlgInPreview boolean bShowDialog
77052>>>>>        Set PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
77053>>>>>    End_Procedure
77054>>>>>
77054>>>>>    Function DFGetPrintDlgInPreview returns boolean
77056>>>>>        boolean bShowDialog
77056>>>>>        Get PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
77057>>>>>        Function_return bShowDialog
77058>>>>>    end_function
77059>>>>>
77059>>>>>
77059>>>>>    Procedure DFSetEnablePrintFromPreview boolean bEnablePrint
77061>>>>>        Set EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
77062>>>>>    End_Procedure
77063>>>>>
77063>>>>>    Function DFGetEnablePrintFromPreview returns boolean
77065>>>>>        boolean bEnablePrint
77065>>>>>        Get EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
77066>>>>>        Function_return bEnablePrint
77067>>>>>    end_function
77068>>>>>
77068>>>>>
77068>>>>>
77068>>>>>    Procedure DFSetMargins number nLeft number nTop number nRight number nBottom
77070>>>>>        Send DFSetMargins of (phoWinPrint(self)) nLeft nTop nRight nBottom
77071>>>>>    End_Procedure
77072>>>>>
77072>>>>>    Procedure DFSetTopBottom number nTop number nBottom Boolean bAllPages
77074>>>>>        Send DFSetTopBottom of (phoWinPrint(self)) nTop nBottom bAllPages
77075>>>>>    End_Procedure
77076>>>>>
77076>>>>>
77076>>>>>    Procedure DFSetDevice string sPrinterName
77078>>>>>        Send DFSetDevice of (phoWinPrint(self)) sPrinterName
77079>>>>>    End_Procedure
77080>>>>>
77080>>>>>    Function DFGetCurrentDevice returns string // sPrinterName
77082>>>>>        String sPrinterName
77082>>>>>        Get DFGetCurrentDevice of (phoWinPrint(self)) to sPrinterName
77083>>>>>        Function_return sPrinterName
77084>>>>>    end_function
77085>>>>>
77085>>>>>
77085>>>>>    Procedure DFSetUserDefinedPapersize number nLength number nWidth
77087>>>>>        Send DFSetUserDefinedPapersize of (phoWinPrint(self)) nLength nWidth
77088>>>>>    End_Procedure
77089>>>>>
77089>>>>>    Function DFGetUserDefinedLength returns number
77091>>>>>        number nSize
77091>>>>>        Get DFGetUserDefinedLength of (phoWinPrint(self)) to nSize
77092>>>>>        Function_return nSize
77093>>>>>    end_function
77094>>>>>
77094>>>>>    Function DFGetUserDefinedWidth returns number
77096>>>>>        number nSize
77096>>>>>        Get DFGetUserDefinedWidth of (phoWinPrint(self)) to nSize
77097>>>>>        Function_return nSize
77098>>>>>    end_function
77099>>>>>
77099>>>>>
77099>>>>>    Procedure DFSetNumberOfCopies integer iCopies
77101>>>>>        Send DFSetNumberOfCopies of (phoWinPrint(self)) iCopies
77102>>>>>    End_Procedure
77103>>>>>
77103>>>>>    Procedure DFPrinterBinFirstPage integer eBinType
77105>>>>>        Send DFPrinterBinFirstPage of (phoWinPrint(self)) eBinType
77106>>>>>    End_Procedure
77107>>>>>
77107>>>>>    Procedure DFClearPrinter
77109>>>>>        Send DFClearPrinter of (phoWinPrint(self))
77110>>>>>    End_Procedure
77111>>>>>
77111>>>>>    Function DFGetDFColor integer iRed integer iGreen integer iBlue returns integer
77113>>>>>        integer iWPColor
77113>>>>>        Get DFGetDFColor of (phoWinPrint(self)) iRed iGreen iBlue to iWPColor
77114>>>>>        Function_return iWPColor
77115>>>>>    end_function
77116>>>>>
77116>>>>>    Function RGBToWPColor integer iRgb returns integer
77118>>>>>        integer iWPColor
77118>>>>>        Get RGBToWPColor of (phoWinPrint(self)) iRGB to iWPColor
77119>>>>>        Function_return iWPColor
77120>>>>>    end_function
77121>>>>>
77121>>>>>
77121>>>>>End_Class
77122>>>Use Windows.pkg
77122>>>
77122>>>Use cTermekDataDictionary.dd
77122>>>Use cSoforDataDictionary.dd
77122>>>Use cGepkocsiDataDictionary.dd
77122>>>Use cFuvarlevelDataDictionary.dd
77122>>>
77122>>>ACTIVATE_VIEW Activate_oHavi FOR oHavi
77132>>>>
77132>>>Object oHavi is a ReportView
77134>>>    Set Location to 6 6
77135>>>    Set Size to 60 202
77136>>>    Set Label To "Havi"
77137>>>
77137>>>
77137>>>    Object oTermek_DD is a cTermekDataDictionary
77139>>>    End_Object 
77140>>>
77140>>>    Object oSofor_DD is a cSoforDataDictionary
77142>>>    End_Object 
77143>>>
77143>>>    Object oGepkocsi_DD is a cGepkocsiDataDictionary
77145>>>    End_Object 
77146>>>
77146>>>    Object oFuvarlevel_DD is a cFuvarlevelDataDictionary
77148>>>        Set DDO_Server To oSofor_DD
77149>>>        Set DDO_Server To oTermek_DD
77150>>>        Set DDO_Server To oGepkocsi_DD
77151>>>    End_Object 
77152>>>
77152>>>    Set Main_DD To oFuvarlevel_DD
77153>>>
77153>>>
77153>>>
77153>>>
77153>>>    Object oPrintTo is a RadioGroup
77155>>>        Set Size to 38 118
77156>>>        Set Location to 10 12
77157>>>        Set Label to "Send Report to"
77158>>>
77158>>>        Object oRadio1 is a Radio
77160>>>            Set Label to "Report Viewer"
77161>>>            Set Size to 10 61
77162>>>            Set Location to 12 6
77163>>>            Set Status_Help to "Prints the report to screen"
77164>>>        End_Object 
77165>>>
77165>>>        Object oRadio2 is a Radio
77167>>>            Set Label to "Printer"
77168>>>            Set Size to 10 42
77169>>>            Set Location to 24 6
77170>>>            Set Status_Help to "Prints the report to printer"
77171>>>        End_Object 
77172>>>
77172>>>
77172>>>        Function IsToPrinter Returns boolean
77175>>>            integer iRadio
77175>>>            Get Current_radio to iRadio
77176>>>            Function_return (iRadio=1)
77177>>>        End_Function 
77178>>>
77178>>>    End_Object 
77179>>>
77179>>>    Object oBtnPrint is a Button
77181>>>        Set Label to "Print"
77182>>>        Set Location to 5 140
77183>>>        Set Status_Help to "Print the Selected report"
77184>>>        Set Default_State to TRUE
77185>>>        Procedure OnClick
77188>>>            Send StartReport
77189>>>        End_Procedure
77190>>>    End_Object 
77191>>>
77191>>>    Object oBtnPrinterSetup is a Button
77193>>>        Set Label to "Printer Setup"
77194>>>        Set Location to 22 140
77195>>>        Set Status_Help to "Set up printer for report"
77196>>>        Procedure OnClick
77199>>>            Send DFPrintSetup of oReport
77200>>>        End_Procedure
77201>>>    End_Object 
77202>>>
77202>>>    Object oBtnCancel is a Button
77204>>>        Set Label to "Cancel"
77205>>>        Set Location to 39 140
77206>>>        Set Status_Help to "Close this Panel"
77207>>>        Procedure OnClick
77210>>>            Send Close_Panel
77211>>>        End_Procedure
77212>>>    End_Object 
77213>>>
77213>>>
77213>>>
77213>>>    Object oReport is a cWinReport2
77215>>>
77215>>>        Set Report_Title to "Havi"
77216>>>
77216>>>        // Set DDO, Index and breaks for the report
77216>>>        Set Server to oFuvarlevel_DD
77217>>>        Set Ordering to 1
77218>>>        // Report_Breaks file.field // no breaks in this report
77218>>>
77218>>>        Function Starting_Main_Report Returns Integer
77221>>>            Boolean bErr
77221>>>            Send DFSetMetrics wpm_cm
77222>>>            Send DFSetmargins 1 1 1 1
77223>>>            //Send DFSetLandscape false // This can be used to force a page orientation
77223>>>            Forward Get Starting_Main_Report to bErr
77225>>>            Function_return bErr
77226>>>        End_Function 
77227>>>
77227>>>        // Page_Top is printed first at the top margin of each page
77227>>>        Procedure Page_Top 
77230>>>            string  sFont
77230>>>            integer iFontSize
77230>>>
77230>>>            Move "arial" to sFont
77231>>>            Move 10 to iFontSize
77232>>>
77232>>>            DFFont sFont
77233>>>            DFFontSize iFontSize
77234>>>            DFBeginHeader DFPageTop
77235>>>                DFHeaderFrame Hdr_NoFrame
77236>>>                DFHeaderPos   Hdr_Left
77237>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
77238>>>            DFEndHeader
77240>>>
77240>>>        End_Procedure 
77241>>>
77241>>>        // Report_Header is printed once in a report after Page_Top
77241>>>        //Procedure Report_Header
77241>>>        //    string  sFont
77241>>>        //    integer iFontSize
77241>>>        //    Move "arial" to sFont
77241>>>        //    Move 10 to iFontSize
77241>>>        //    DFFont sFont
77241>>>        //    DFFontSize iFontSize
77241>>>        //    DFBeginHeader  DFReportHeader
77241>>>        //        DFHeaderFrame  Hdr_Margins 0.01
77241>>>        //        DFHeaderPos    Hdr_Left
77241>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
77241>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
77241>>>        //    DFEndHeader
77241>>>        //End_Procedure
77241>>>
77241>>>        Procedure Page_Header 
77244>>>            integer iFill iBorder iStyle
77244>>>            string  sFont sReportTitle
77244>>>            integer iFontSize
77244>>>
77244>>>            Move "arial" to sFont
77245>>>            Move 16 to iFontSize
77246>>>            Move (Font_bold + rgb_White) to iStyle
77247>>>            Move (rgb_dGrey) to iFill
77248>>>            Move (rgb_dGrey) to iBorder
77249>>>            Get Report_Title to sReportTitle
77250>>>
77250>>>            DFFont sFont
77251>>>            DFFontSize iFontSize
77252>>>            DFBeginHeader DFPageHeader
77253>>>                DFHeaderPos   Hdr_Left
77254>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
77255>>>                DFWritelnPos sReportTitle 0.1 iStyle
77256>>>                DFHeaderMargin HM_BottomOuter 0.08
77257>>>            DFEndHeader
77259>>>
77259>>>        End_Procedure 
77260>>>
77260>>>        Procedure Page_Title 
77263>>>            string  sFont 
77263>>>            integer iFontSize iHeaderStyle iFill iBorder
77263>>>
77263>>>            Move "arial" to sFont
77264>>>            Move 10 to iFontSize
77265>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
77266>>>            Move (rgb_Grey) to iFill
77267>>>            Move (rgb_Grey) to iBorder
77268>>>
77268>>>            DFFont sFont
77269>>>            DFFontSize iFontSize
77270>>>            DFBeginHeader DFPageTitle
77271>>>                DFHeaderPos   Hdr_Left
77272>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
77273>>>                DFHeaderMargin HM_TopInner    0.04
77274>>>                DFHeaderMargin HM_BottomInner 0.04
77275>>>                DFHeaderMargin HM_BottomOuter 0.08
77276>>>
77276>>>                DFWritePos "Azonost"                    (0.08 + 2.3) (iHeaderStyle + Font_Right) -1 2.3
77277>>>                DFWritePos "Megnevezs"                   2.46 iHeaderStyle -1 6.39
77278>>>                DFWritePos "Egysgr"                     (8.93 + 2.04) (iHeaderStyle + Font_Right) -1 2.04
77279>>>                DFWritePos "Azonost"                    (11.05 + 2.3) (iHeaderStyle + Font_Right) -1 2.3
77280>>>                DFWritePos "Nv"                          13.43 iHeaderStyle -1 12.79
77281>>>                DFWritePos "Rendszm"                     26.3 iHeaderStyle -1 2.04
77282>>>                DFWritePos "Tpus"                        28.42 iHeaderStyle -1 6.39
77283>>>                DFWritePos "Fuvarszm"                    (34.89 + 2.3) (iHeaderStyle + Font_Right) -1 2.3
77284>>>                DFWritePos "Termk"                       (37.27 + 1.53) (iHeaderStyle + Font_Right) -1 1.53
77285>>>                DFWritePos "Rendszm"                     38.88 iHeaderStyle -1 2.04
77286>>>                DFWritePos "Sofor"                        (41 + 1.27) (iHeaderStyle + Font_Right) -1 1.27
77287>>>                DFWritePos "Dtum"                        42.35 iHeaderStyle -1 2.13
77288>>>                DFWritePos "Tv"                          (44.56 + 0.85) (iHeaderStyle + Font_Right) -1 0.85
77289>>>                DFWritePos "Munkaido"                     (45.49 + 2.04) (iHeaderStyle + Font_Right) -1 2.04
77290>>>                DFWritePos "zemanyagmennyisg"           (47.61 + 4.6) (iHeaderStyle + Font_Right) -1 4.6
77291>>>                DFWritePos "zemanyagr"                  (52.29 + 2.81) (iHeaderStyle + Font_Right) -1 2.81
77292>>>                DFWriteLn
77293>>>            DFEndHeader
77295>>>
77295>>>        End_Procedure 
77296>>>
77296>>>        Procedure Body 
77299>>>            string  sFont 
77299>>>            integer iFontSize iStyle
77299>>>
77299>>>            Move "arial" to sFont
77300>>>            Move 10 to iFontSize
77301>>>            Move (font_default) to iStyle
77302>>>
77302>>>            DFFont sFont
77303>>>            DFFontSize iFontSize
77304>>>
77304>>>            DFWritePos Termek.Azonosito               (0.08 + 2.3) (iStyle + Font_Right) 0 2.3
77305>>>            DFWritePos Termek.Megnevezes              2.46 iStyle -1 6.39
77306>>>            DFWritePos Termek.Egysegar                (8.93 + 2.04) (iStyle + Font_Right) 0 2.04
77307>>>            DFWritePos Sofor.Azonosito                (11.05 + 2.3) (iStyle + Font_Right) 0 2.3
77308>>>            DFWritePos Sofor.Nev                      13.43 iStyle -1 12.79
77309>>>            DFWritePos Gepkocsi.Rendszam              26.3 iStyle -1 2.04
77310>>>            DFWritePos Gepkocsi.Tipus                 28.42 iStyle -1 6.39
77311>>>            DFWritePos Fuvarlevel.Fuvarszam           (34.89 + 2.3) (iStyle + Font_Right) 0 2.3
77312>>>            DFWritePos Fuvarlevel.Termek              (37.27 + 1.53) (iStyle + Font_Right) 0 1.53
77313>>>            DFWritePos Fuvarlevel.Gepkocsi            38.88 iStyle -1 2.04
77314>>>            DFWritePos Fuvarlevel.Sofor               (41 + 1.27) (iStyle + Font_Right) 0 1.27
77315>>>            DFWritePos Fuvarlevel.Datum               42.35 iStyle -1 2.13
77316>>>            DFWritePos Fuvarlevel.Tav                 (44.56 + 0.85) (iStyle + Font_Right) 0 0.85
77317>>>            DFWritePos Fuvarlevel.Munkaido            (45.49 + 2.04) (iStyle + Font_Right) 0 2.04
77318>>>            DFWritePos Fuvarlevel.UAMennyiseg         (47.61 + 4.6) (iStyle + Font_Right) 0 4.6
77319>>>            DFWritePos Fuvarlevel.UAEgysegar          (52.29 + 2.81) (iStyle + Font_Right) 0 2.81
77320>>>            DFWriteLn
77321>>>
77321>>>        End_Procedure 
77322>>>
77322>>>        // Totals appear at the end of the report before Report_Footer
77322>>>        //Procedure Total
77322>>>        //    string  sFont
77322>>>        //    integer iFontSize
77322>>>        //    Move "arial" to sFont
77322>>>        //    Move 10 to iFontSize
77322>>>        //    DFFont sFont
77322>>>        //    DFFontSize iFontSize
77322>>>        //    DFBeginHeader  DFTotal
77322>>>        //        DFHeaderFrame  Hdr_Margins 0.01
77322>>>        //        DFHeaderPos    Hdr_Left
77322>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
77322>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
77322>>>        //    DFEndHeader
77322>>>        //End_Procedure
77322>>>
77322>>>        // Report_Footer is printed once on the last page before Page_Footer
77322>>>        //Procedure Report_Footer
77322>>>        //    string  sFont
77322>>>        //    integer iFontSize
77322>>>        //    Move "arial" to sFont
77322>>>        //    Move 10 to iFontSize
77322>>>        //    DFFont sFont
77322>>>        //    DFFontSize iFontSize
77322>>>        //    DFBeginHeader DFReportFooter
77322>>>        //        DFHeaderFrame  Hdr_Margins 0.01
77322>>>        //        DFHeaderPos    Hdr_Left
77322>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
77322>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
77322>>>        //    DFEndHeader
77322>>>        //End_Procedure
77322>>>
77322>>>        // // Page_Footer is printed on each page before Page_Bottom
77322>>>        //Procedure Page_Footer
77322>>>        //    string  sFont
77322>>>        //    integer iFontSize
77322>>>        //    Move "arial" to sFont
77322>>>        //    Move 10 to iFontSize
77322>>>        //    DFFont sFont
77322>>>        //    DFFontSize iFontSize
77322>>>        //    DFBeginHeader DFPageFooter
77322>>>        //        DFHeaderFrame  Hdr_Margins 0.01
77322>>>        //        DFHeaderPos    Hdr_Left
77322>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
77322>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
77322>>>        //    DFEndHeader
77322>>>        //End_Procedure
77322>>>
77322>>>
77322>>>        // Page_Bottom is printed last at the bottom margin of each page
77322>>>        Procedure Page_Bottom 
77325>>>            string sFont
77325>>>            integer iFontSize iBorder iStyle
77325>>>            DateTime dtDT
77325>>>
77325>>>            Move (CurrentDateTime()) to dtDT
77326>>>
77326>>>            Move "arial" to sFont
77327>>>            Move 10 to iFontSize
77328>>>            Move (font_default) to iStyle
77329>>>            Move (rgb_dGrey) to iBorder
77330>>>
77330>>>            DFFont sFont
77331>>>            DFFontSize iFontSize
77332>>>            DFBeginHeader DFPageBottom
77333>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
77334>>>                DFHeaderPos Hdr_Left
77335>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
77336>>>            DFEndHeader
77338>>>
77338>>>        End_Procedure 
77339>>>
77339>>>        // Returns string with description of selection ranges
77339>>>        // Pass: Selection title, start value and end value. Return: description
77339>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
77342>>>            string sText
77342>>>            If (sStart=""  AND sStop="")  function_return ""
77345>>>            If (sStart="0" AND sStop="0") function_return ""
77348>>>            If (sStart<>"" AND sStop<>"") begin
77350>>>                Move ("between" * sStart * "and" * sStop) to sText
77351>>>            end
77351>>>>
77351>>>            Else if (sStart > "") begin
77354>>>                Move ("starting at" * sStart) to sText
77355>>>            end
77355>>>>
77355>>>            Else if (sStop > "") begin
77358>>>                Move ("up to" * sStop) to sText
77359>>>            End
77359>>>>
77359>>>            function_return (sTitle * sText)
77360>>>        End_Function
77361>>>
77361>>>    End_Object 
77362>>>
77362>>>    Procedure StartReport 
77365>>>        Boolean bToPrinter
77365>>>
77365>>>        // determine if direct print
77365>>>        Get IsToPrinter of oPrintTo to bToPrinter
77366>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
77367>>>
77367>>>        // run the report
77367>>>        Send Run_Report of oReport
77368>>>
77368>>>    End_Procedure 
77369>>>
77369>>>End_Object 
77370>
77370>        Procedure Activate_About
77373>            Send DoAbout "" "" "" "" ""
77374>        End_Procedure
77375>
77375>    End_Object
77376>
77376>End_Object
77377>
77377>Start_UI
77378>
Summary
Memory Available: 2147483647
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 43846
Total Resources: 0
Total Commands : 77377
Total Windows  : 1
Total Pages    : 1
Static Data    : 474265
Message area   : 538254
Total Blocks   : 27743
